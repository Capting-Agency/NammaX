var x=(a,s,o)=>new Promise((m,_)=>{var t=n=>{try{i(o.next(n))}catch(e){_(e)}},r=n=>{try{i(o.throw(n))}catch(e){_(e)}},i=n=>n.done?m(n.value):Promise.resolve(n.value).then(t,r);i((o=o.apply(a,s)).next())});var T=["January","February","March","April","May","June","July","August","September","October","November","December"];function h(a,s="GET",o=!1,m=!1,_=!1,t=!0){try{let r={"Content-Type":"application/json"};_&&(r={}),m&&(r.Authorization=`Bearer ${m}`);let i={method:s,headers:r};return o&&(t?i.body=JSON.stringify(o):i.body=o),fetch(a,i).then(n=>n.ok?n.json():n.json().then(e=>(Promise.reject(e.message),{isFetchOk:!1,status:n.status,message:e.message,payload:e&&e.payload?e.payload:null}))).then(n=>n).catch(n=>(console.error("Error in fetch",n),n))}catch(r){return console.error("Error!: "+r),r}}function L(a=null,s="nammax_auth",o=60*60*24){a&&(document.cookie=`${s}=${a}; path=/; max-age=${o}`)}function g(a="nammax_auth"){let o=`; ${document.cookie}`.split(`; ${a}=`);return o.length===2?o.pop().split(";").shift():null}function E(a="/",s=2e3){setTimeout(()=>{window.location.href=a},s)}function y(a=1e3){setTimeout(()=>{window.location.reload()},a)}function N(a=null,s=!1,o=!1,m=!1){if(a==null)return"NaN";let _=new Date,t=new Date(a),r=t.getHours(),i="";if(m||(i=r>=12?"PM":"AM",r=r%12||12),s){let n=t.getMinutes();return n=n<10?`0${n}`:n,o?`${_.getDate()===t.getDate()?"Today":_.getDate()+1===t.getDate()?"Tomorrow":_.getDate()+2===t.getDate()?"Day After Tomorrow":""} ${r}:${n} ${i}`:`${r}:${n} ${i}`}else return o?`${_.getDate()===t.getDate()?"Today":_.getDate()+1===t.getDate()?"Tomorrow":_.getDate()+2===t.getDate()?"Day After Tomorrow":""} ${r} ${i}`:`${r} ${i}`}function S(a=null){if(a==null)return"NaN";a=a*60;let s=`${a/60^0}`.slice(-2),o=("0"+a%60).slice(-2);return s!="0"?o!="00"?`${s} HR ${o} M`:s+" HR":o+" Mins"}function k(a,s=null){if(a!=null){var o,m=a.options.length-1;for(o=m;o>=0;o--)o!==s&&a.remove(o)}}function w(a="/sign-in"){window.localStorage.removeItem("auth"),E(`${a}`)}function R(a=!0,s="current-time"){let o=document.getElementById(s);o&&a?(o.innerText=`${new Date().toLocaleDateString("en-us",{weekday:"short",month:"short",day:"numeric"})} | ${N(new Date,!0)}`,setTimeout(()=>R(a,s),2e4)):o&&!a&&(o.innerText=N(new Date,!0),setTimeout(()=>R(a,s),2e4))}function b(){let a=document.getElementById("loading-screen");a?a.remove():console.log("did not find loading screen")}function I({single:a=!0,baseElement:s="",TriggerBtn:o="jsModalOpen",_modalWindow:m="jsModal"},_){if(a){var t=s.querySelector("#"+o);t.onclick=function(){var n=document.getElementById(m);_&&_(),n.classList?n.classList.add("open"):n.className+=" open"}}else for(var r=document.getElementsByClassName(o),i=0;i<r.length;i++)r[i].onclick=function(){var n=this.getAttribute("href").substr(1),e=document.getElementById(n);e.classList?e.classList.add("open"):e.className+=" open"}}function D({TriggerBtn:a="jsModalClose",_modalWindow:s="jsModal"},o){var m=document.getElementById(a),_=document.getElementById(s);m.onclick=function(){_.classList?_.classList.remove("open"):_.className=_.className.replace(new RegExp("(^|\\b)"+"open".split(" ").join("|")+"(\\b|$)","gi")," ")},o&&o()}var C=Webflow||[];var O="/sign-in",B="/sign-up-2";var M="/user/dashboard";var v="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/user/dashboard",X="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/user/dashboard/book_session/",P="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/user/dashboard/cancel_session/",K="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/user/dashboard/filters";var F=[],H=[];function G(a){var s=new URL("https://x8ki-letl-twmt.n7.xano.io/api:ocRzyo-e/oauth/google/continue");s.searchParams.set("REDIRECT_URL","https://nammacrossfit.com/user/dashboard"),s.searchParams.set("code",a),s=s.toString();var o=new URL(document.location.href);o.searchParams.delete("code"),o.searchParams.delete("scope"),o.searchParams.delete("authuser"),o.searchParams.delete("hd"),o.searchParams.delete("prompt"),history.replaceState(null,"",o.toString()),fetch(s,{headers:F,method:"GET"}).then(m=>m.json()).then(m=>H=m).then(()=>L(H.token)).catch(m=>{console.error("Error:",m)})}(()=>{window.onload=function(){var t=new URL(document.location.href),r=t.searchParams.get("code");if(r)G(r);else{let i=g(),n=document.querySelector("#navbar-logout-btn");n&&(n.onclick=()=>{w()}),i?(R(),a(i),s(i)):E(`${O}?reason=NOT_SIGNED_IN`)}};function a(t){return x(this,null,function*(){var r=new URL(document.location.href),i=r.searchParams.get("session_name"),n=r.searchParams.get("time");let e=v;if(i&&i!=="Select Program"||n){e+="?",i&&(e+=`session_name=${i}&`),n&&(e+=`time=${n}`);let d=document.getElementById("on-a-filter-container");d.style.display="flex"}let l=yield h(e,"GET",!1,t);if(l.isFetchOk!==void 0&&!l.isFetchOk){console.error(l.message),E(`${O}?reason=NOT_SIGNED_IN`);return}let{users:c,sessions:p}=l;if(c.gym_id===0)E(`${B}?reason=UNSET_DETAILS`);else{o(c);let d=[],A=[];p.forEach(u=>{u.users.some(U=>U&&c&&U.user_id===c.id?(d.push(u),!0):!1)||A.push(u)}),m(c,d),_(c,A)}b()})}function s(t){let r=document.getElementById("filter-form-block"),i=r.querySelector("#filter-program"),n=r.querySelector("#datepicker-input");$(n).attr("autocomplete","off"),$(n).datepicker({startDate:new Date,format:"dd/mm/yyyy",language:"en",orientation:"bottom auto"});function e(){return x(this,null,function*(){let l=yield h(K,"GET",!1,t);if(l.isFetchOk!==void 0&&!l.isFetchOk){console.error(l.message),E(`${O}?reason=NOT_SIGNED_IN`);return}let{sessions:c}=l;k(i,0),c.forEach(p=>{var d=document.createElement("option");d.value=p.name,d.innerHTML=p.name,i.appendChild(d)}),i.removeEventListener("focus",e)})}i.addEventListener("focus",e)}function o(t){document.getElementById("user_name").innerText=t.name,document.getElementById("gym-location").innerText=t.location,t.profile_picture&&(document.getElementById("profile-avatar").style.backgroundImage=`url(${t.profile_picture.url})`)}function m(t,r){return x(this,null,function*(){let i=document.getElementById("booked-sessions-container"),n=i.querySelector("#booked-sessions-item");r.forEach(e=>{let l=n.cloneNode(!0);l.setAttribute("id",""),l.querySelector("#booked-session-name").innerText=e.session_name,l.querySelector("#booked-time").innerText=N(e.time,!0,!0),l.querySelector("#booked-duration").innerText=S(e.duration),l.querySelector("#booked-session-slot-bar").style.width=e.users.length/e.capacity*100+"%",l.querySelector("#booked-capacity").innerText=`${e.users.length}/${e.capacity}`,I({baseElement:l,TriggerBtn:"cancel-booked-session-btn",_modalWindow:"cancel-booked-session-popout"},()=>{let c=document.getElementById("cancel-booked-session-popout");c.querySelector("#session-name").innerText=e.session_name,c.querySelector("#date").innerText=new Date(e.time).toLocaleDateString("en-us",{weekday:"short",month:"short",day:"numeric"}),c.querySelector("#time").innerText=N(e.time),c.querySelector("#duration").innerText=S(e.duration),c.querySelector("#capacity").innerHTML=`${e.users.length}/${e.capacity}`;let p=c.querySelector("#confirm-cancel-booking-popout-btn");p.onclick=()=>x(this,null,function*(){p.disabled=!0;let d=g(),A={session_id:e.id},u=yield h(P+e.id,"POST",A,d);if(u.isFetchOk!==void 0&&!u.isFetchOk){let f=c.querySelector("#warning_block");f.innerText=u.message,f.style.display="flex",p.disabled=!1;return}y()})}),i.prepend(l)}),D({TriggerBtn:"close-cancel-booked-session-modal-btn",_modalWindow:"cancel-booked-session-popout"}),i.classList.remove("off"),n.remove()})}function _(t,r){return x(this,null,function*(){let i=document.getElementById("view-sessions-container"),n=i.querySelector("#view-sessions-item");r.forEach(e=>{let l=n.cloneNode(!0);l.setAttribute("id",""),l.querySelector("#session-name").innerText=e.session_name,l.querySelector("#time").innerText=N(e.time,!1,!0),l.querySelector("#duration").innerText=S(e.duration),l.querySelector("#session-slot-bar").style.width=e.users.length/e.capacity*100+"%",l.querySelector("#capacity").innerText=`${e.users.length}/${e.capacity}`,I({baseElement:l,TriggerBtn:"book-session-btn",_modalWindow:"book-session-popout"},()=>{let c=document.getElementById("book-session-popout");if(c.querySelector("#name").innerText=e.session_name,c.querySelector("#date").innerText=new Date(e.time).toLocaleDateString("en-us",{weekday:"short",month:"short",day:"numeric"}),c.querySelector("#time").innerText=N(e.time),c.querySelector("#duration").innerText=S(e.duration),c.querySelector("#capacity").innerText=`${e.users.length}/${e.capacity}`,t!=null&&t.membership_end_date){console.log(t==null?void 0:t.membership_end_date);let d=t==null?void 0:t.membership_end_date.split("-"),A=T[d[1]-1];c.querySelector("#remaining_sessions").innerText=`Your membership ends on ${d[2]}-${A}-${d[0]}`}else t!=null&&t.tokens&&(t==null?void 0:t.tokens)>0?c.querySelector("#remaining_sessions").innerText=t==null?void 0:t.tokens.toString().padStart(3,"0"):c.querySelector("#remaining_sessions").innerText="Please contact an admin for a membership";let p=c.querySelector("#confirm-booking-popout-btn");p.onclick=()=>x(this,null,function*(){p.disabled=!0;let d=g(),A={session_id:e.id},u=yield h(X+e.id,"POST",A,d);if(u.isFetchOk!==void 0&&!u.isFetchOk){let f=c.querySelector("#warning_block");f.innerText=u.message,f.style.display="flex",p.disabled=!1;return}y()})}),i.prepend(l)}),D({TriggerBtn:"close-cancel-booking-session-modal-btn",_modalWindow:"book-session-popout"}),i.classList.remove("off"),n.remove()})}})();var q=C||[];q.push(function(){$(document).off("submit"),$("form").submit(function(a){return x(this,null,function*(){a.preventDefault();let s=$(this);if(g()){let m=s[0][0].value,_=s[0][1].value,t=M;if((m&&m!=="Select Program"||_)&&(t+="?",m!=="Select Program"&&m!=="Loading..."&&(t+=`session_name=${m}&`),_)){let r=_.split("/"),i=new Date(+r[2],r[1]-1,+r[0]).toISOString(),n=new Date((typeof i=="string"?new Date(i):i).toLocaleString("en-US",{timeZone:"Asia/Kolkata"}));t+=`time=${n.getTime()+1e7}`}E(t)}})})});
