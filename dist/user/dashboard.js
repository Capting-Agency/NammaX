var A=(a,r,n)=>new Promise((s,_)=>{var t=o=>{try{i(n.next(o))}catch(e){_(e)}},l=o=>{try{i(n.throw(o))}catch(e){_(e)}},i=o=>o.done?s(o.value):Promise.resolve(o.value).then(t,l);i((n=n.apply(a,r)).next())});function f(a,r="GET",n=!1,s=!1,_=!1,t=!0){try{let l={"Content-Type":"application/json"};_&&(l={}),s&&(l.Authorization=`Bearer ${s}`);let i={method:r,headers:l};return n&&(t?i.body=JSON.stringify(n):i.body=n),fetch(a,i).then(o=>o.ok?o.json():o.json().then(e=>(Promise.reject(e.message),{isFetchOk:!1,status:o.status,message:e.message,payload:e&&e.payload?e.payload:null}))).then(o=>o).catch(o=>(console.error("Error in fetch",o),o))}catch(l){return console.error("Error!: "+l),l}}function D(a=null,r="nammax_auth",n=60*60*24){a&&(document.cookie=`${r}=${a}; path=/; max-age=${n}`)}function S(a="nammax_auth"){let n=`; ${document.cookie}`.split(`; ${a}=`);return n.length===2?n.pop().split(";").shift():null}function x(a="/",r=0){setTimeout(()=>{window.location.href=a},r)}function O(a=1e3){setTimeout(()=>{window.location.reload()},a)}function h(a=null,r=!1){if(a==null)return"NaN";var n=new Date(a),s=n.getHours(),_=s>=12?"PM":"AM";if(s=s%12||12,r){var t=n.getMinutes();return t=t<10?`0${t}`:t,`${s}:${t} ${_}`}else return`${s} ${_}`}function g(a=null){if(a==null)return"NaN";a=a*60;let r=`${a/60^0}`.slice(-2),n=("0"+a%60).slice(-2);return r!="0"?n!="00"?`${r} HR ${n} M`:r+" HR":n+" Mins"}function L(a,r=null){if(a!=null){var n,s=a.options.length-1;for(n=s;n>=0;n--)n!==r&&a.remove(n)}}function w(a="/sign-in"){window.localStorage.removeItem("auth"),x(`${a}`)}function y(a="current-time"){let r=document.getElementById(a);r&&(r.innerText=h(new Date,!0)),setTimeout(()=>y(a),3e4)}function I({single:a=!0,baseElement:r="",TriggerBtn:n="jsModalOpen",_modalWindow:s="jsModal"},_){if(a){var t=r.querySelector("#"+n);t.onclick=function(){var o=document.getElementById(s);_&&_(),o.classList?o.classList.add("open"):o.className+=" open"}}else for(var l=document.getElementsByClassName(n),i=0;i<l.length;i++)l[i].onclick=function(){var o=this.getAttribute("href").substr(1),e=document.getElementById(o);e.classList?e.classList.add("open"):e.className+=" open"}}function U({TriggerBtn:a="jsModalClose",_modalWindow:r="jsModal"},n){var s=document.getElementById(a),_=document.getElementById(r);s.onclick=function(){_.classList?_.classList.remove("open"):_.className=_.className.replace(new RegExp("(^|\\b)"+"open".split(" ").join("|")+"(\\b|$)","gi")," ")},n&&n()}var k=Webflow||[];var R="/sign-in",b="/sign-up-2";var B="/user/dashboard";var C="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/user/dashboard",M="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/user/dashboard/book_session/",v="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/user/dashboard/cancel_session/",X="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/user/dashboard/filters";var K=[],P=[];function H(a){var r=new URL("https://x8ki-letl-twmt.n7.xano.io/api:ocRzyo-e/oauth/google/continue");r.searchParams.set("REDIRECT_URL","https://nammax.webflow.io/user/dashboard"),r.searchParams.set("code",a),r=r.toString();var n=new URL(document.location.href);n.searchParams.delete("code"),n.searchParams.delete("scope"),n.searchParams.delete("authuser"),n.searchParams.delete("hd"),n.searchParams.delete("prompt"),history.replaceState(null,"",n.toString()),fetch(r,{headers:K,method:"GET"}).then(s=>s.json()).then(s=>P=s).then(()=>D(P.token)).catch(s=>{console.error("Error:",s)})}(()=>{window.onload=function(){var t=new URL(document.location.href),l=t.searchParams.get("code");if(l)H(l);else{let i=S(),o=document.querySelector("#navbar-logout-btn");o&&(o.onclick=()=>{w()}),i?(y(),a(i),r(i)):x(`${R}?reason=NOT_SIGNED_IN`)}};function a(t){return A(this,null,function*(){var l=new URL(document.location.href),i=l.searchParams.get("session_name"),o=l.searchParams.get("time");let e=C;if(i&&i!=="Select Program"||o){e+="?",i&&(e+=`session_name=${i}&`),o&&(e+=`time=${o}`);let p=document.getElementById("on-a-filter-container");p.style.display="flex"}let c=yield f(e,"GET",!1,t);if(c.isFetchOk!==void 0&&!c.isFetchOk){console.error(c.message),x(`${R}?reason=NOT_SIGNED_IN`);return}let{users:m,sessions:d}=c;if(m.gym_id===0)x(`${b}?reason=UNSET_DETAILS`);else{n(m);let p=[],N=[];d.forEach(u=>{u.users.some(T=>T&&m&&T.user_id===m.id?(p.push(u),!0):!1)||N.push(u)}),s(m,p),_(m,N)}})}function r(t){let l=document.getElementById("filter-form-block"),i=l.querySelector("#filter-program"),o=l.querySelector("#datepicker-input");$(o).attr("autocomplete","off"),$(o).datepicker({startDate:new Date,format:"dd/mm/yyyy",language:"en",orientation:"bottom auto"});function e(){return A(this,null,function*(){let c=yield f(X,"GET",!1,t);if(c.isFetchOk!==void 0&&!c.isFetchOk){console.error(c.message),x(`${R}?reason=NOT_SIGNED_IN`);return}let{sessions:m}=c;L(i,0),m.forEach(d=>{var p=document.createElement("option");p.value=d.name,p.innerHTML=d.name,i.appendChild(p)}),i.removeEventListener("focus",e)})}i.addEventListener("focus",e)}function n(t){document.getElementById("user_name").innerText=t.name,document.getElementById("gym-location").innerText=t.location,t.profile_picture&&(document.getElementById("profile-avatar").style.backgroundImage=`url(${t.profile_picture.url})`)}function s(t,l){return A(this,null,function*(){let i=document.getElementById("booked-sessions-container"),o=i.querySelector("#booked-sessions-item");l.forEach(e=>{let c=o.cloneNode(!0);c.setAttribute("id",""),c.querySelector("#booked-session-name").innerText=e.session_name,c.querySelector("#booked-time").innerText=h(e.time,!0),c.querySelector("#booked-duration").innerText=g(e.duration),c.querySelector("#booked-session-slot-bar").style.width=e.users.length/e.capacity*100+"%",c.querySelector("#booked-capacity").innerText=`${e.users.length}/${e.capacity}`,I({baseElement:c,TriggerBtn:"cancel-booked-session-btn",_modalWindow:"cancel-booked-session-popout"},()=>{let m=document.getElementById("cancel-booked-session-popout");m.querySelector("#session-name").innerText=e.session_name,m.querySelector("#date").innerText=new Date(e.time).toLocaleDateString("en-us",{weekday:"short",month:"short",day:"numeric"}),m.querySelector("#time").innerText=h(e.time),m.querySelector("#duration").innerText=g(e.duration),m.querySelector("#capacity").innerHTML=`${e.users.length}/${e.capacity}`;let d=m.querySelector("#confirm-cancel-booking-popout-btn");d.onclick=()=>A(this,null,function*(){d.disabled=!0;let p=S(),N={membership_end_date:(t==null?void 0:t.membership_end_date)||null},u=yield f(v+e.id,"POST",N,p);if(u.isFetchOk!==void 0&&!u.isFetchOk){let E=m.querySelector("#warning_block");E.innerText=u.message,E.style.display="flex",d.disabled=!1;return}O()})}),i.prepend(c)}),U({TriggerBtn:"close-cancel-booked-session-modal-btn",_modalWindow:"cancel-booked-session-popout"}),i.classList.remove("off"),o.remove()})}function _(t,l){return A(this,null,function*(){let i=document.getElementById("view-sessions-container"),o=i.querySelector("#view-sessions-item");l.forEach(e=>{let c=o.cloneNode(!0);c.setAttribute("id",""),c.querySelector("#session-name").innerText=e.session_name,c.querySelector("#time").innerText=h(e.time),c.querySelector("#duration").innerText=g(e.duration),c.querySelector("#session-slot-bar").style.width=e.users.length/e.capacity*100+"%",c.querySelector("#capacity").innerText=`${e.users.length}/${e.capacity}`,I({baseElement:c,TriggerBtn:"book-session-btn",_modalWindow:"book-session-popout"},()=>{let m=document.getElementById("book-session-popout");m.querySelector("#name").innerText=e.session_name,m.querySelector("#date").innerText=new Date(e.time).toLocaleDateString("en-us",{weekday:"short",month:"short",day:"numeric"}),m.querySelector("#time").innerText=h(e.time),m.querySelector("#duration").innerText=g(e.duration),m.querySelector("#capacity").innerText=`${e.users.length}/${e.capacity}`,t!=null&&t.membership_end_date?m.querySelector("#remaining_sessions").innerText="Your membership ends on "+(t==null?void 0:t.membership_end_date.toString()):t!=null&&t.tokens&&(t==null?void 0:t.tokens)>0?m.querySelector("#remaining_sessions").innerText=t==null?void 0:t.tokens.toString().padStart(3,"0"):m.querySelector("#remaining_sessions").innerText="Please contact an admin for a membership";let d=m.querySelector("#confirm-booking-popout-btn");d.onclick=()=>A(this,null,function*(){d.disabled=!0;let p=S(),N={session_id:e.id},u=yield f(M+e.id,"POST",N,p);if(u.isFetchOk!==void 0&&!u.isFetchOk){let E=m.querySelector("#warning_block");E.innerText=u.message,E.style.display="flex",d.disabled=!1;return}O()})}),i.prepend(c)}),U({TriggerBtn:"close-cancel-booking-session-modal-btn",_modalWindow:"book-session-popout"}),i.classList.remove("off"),o.remove()})}})();var F=k||[];F.push(function(){$(document).off("submit"),$("form").submit(function(a){return A(this,null,function*(){a.preventDefault();let r=$(this);if(S()){let s=r[0][0].value,_=r[0][1].value,t=B;if((s&&s!=="Select Program"||_)&&(t+="?",s!=="Select Program"&&s!=="Loading..."&&(t+=`session_name=${s}&`),_)){let l=_.split("/"),i=new Date(+l[2],l[1]-1,+l[0]).toISOString(),o=new Date((typeof i=="string"?new Date(i):i).toLocaleString("en-US",{timeZone:"Asia/Kolkata"}));t+=`time=${o.getTime()+1e7}`}x(t)}})})});
