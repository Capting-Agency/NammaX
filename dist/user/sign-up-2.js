var m=(o,e,t)=>new Promise((n,r)=>{var _=i=>{try{a(t.next(i))}catch(l){r(l)}},s=i=>{try{a(t.throw(i))}catch(l){r(l)}},a=i=>i.done?n(i.value):Promise.resolve(i.value).then(_,s);a((t=t.apply(o,e)).next())});var N=["Male","Female","Other","Prefer not to say"];function p(o,e="GET",t=!1,n=!1,r=!1,_=!0){try{let s={"Content-Type":"application/json"};r&&(s={}),n&&(s.Authorization=`Bearer ${n}`);let a={method:e,headers:s};return t&&(_?a.body=JSON.stringify(t):a.body=t),fetch(o,a).then(i=>i.ok?i.json():i.json().then(l=>(Promise.reject(l.message),{isFetchOk:!1,status:i.status,message:l.message,payload:l&&l.payload?l.payload:null}))).then(i=>i).catch(i=>(console.error("Error in fetch",i),i))}catch(s){return console.error("Error!: "+s),s}}function x(o=null,e="nammax_auth",t=60*60*24){o&&(document.cookie=`${e}=${o}; path=/; max-age=${t}`)}function d(o="nammax_auth"){let t=`; ${document.cookie}`.split(`; ${o}=`);return t.length===2?t.pop().split(";").shift():null}function c(o="/",e=0){setTimeout(()=>{window.location.href=o},e)}var u="/sign-in";var h="/user/dashboard";var A="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/user/preferences";var R,g=[],E=[];function S(o){var e=new URL("https://x8ki-letl-twmt.n7.xano.io/api:ocRzyo-e/oauth/google/continue");e.searchParams.set("REDIRECT_URL","https://nammax.webflow.io/sign-up-2"),e.searchParams.set("code",o),e=e.toString();var t=new URL(document.location.href);t.searchParams.delete("code"),t.searchParams.delete("scope"),t.searchParams.delete("authuser"),t.searchParams.delete("hd"),t.searchParams.delete("prompt"),history.replaceState(null,"",t.toString()),fetch(e,{headers:g,method:"GET"}).then(n=>n.json()).then(n=>E=n).then(()=>x(E.token)).catch(n=>{console.error("Error:",n)})}window.onload=function(){var o=new URL(document.location.href),e=o.searchParams.get("reason"),t=o.searchParams.get("code");if(e){let n=document.getElementById("warning_block");n.style.display="block",n.innerText="Please fill these required details in order to use the app"}if(t)S(t);else{let n=d();n?I(n):c(`${u}?reason=NOT_SIGNED_IN`)}};function I(o){return m(this,null,function*(){let e=yield p(A,"GET",!1,o);if(e.isFetchOk!==void 0&&!e.isFetchOk){console.error(e.message);return}let{user:t,gyms:n}=e;R=t.id,t.weight&&(document.getElementById("weight").value=t.weight),t.height&&(document.getElementById("height").value=t.height),t.date_of_birth&&(document.getElementById("date_of_birth").value=t.date_of_birth);let r=document.getElementById("gym_select");n.forEach(s=>{var a=document.createElement("option");a.value=s.id,a.text=s.location,s.id===t.gym_id&&(a.selected=!0),r.appendChild(a)});let _=document.getElementById("gender_select");N.forEach(s=>{var a=document.createElement("option");a.value=s,a.text=s,s===e.gender&&(a.selected=!0),_.appendChild(a)})})}var f=f||[];f.push(function(){$(document).off("submit"),$("form").submit(function(o){return m(this,null,function*(){o.preventDefault();let e=$(this),t=d();if(t){$("next-btn").attr("disabled",!0);let n={date_of_birth:document.getElementById("date_of_birth").value,gender:document.getElementById("gender_select").value,height:document.getElementById("height").value,weight:document.getElementById("weight").value,gym_id:parseInt(document.getElementById("gym_select").value)},r=yield p(`${A}/${R}`,"POST",n,t);if(r.isFetchOk!==void 0&&!r.isFetchOk){console.error(r.message),e.siblings(".w-form-done").hide().siblings(".w-form-fail").show(),$("next-btn").attr("disabled",!1);return}else e.hide().siblings(".w-form-done").show().siblings(".w-form-fail").hide(),c(h)}else c(`${u}?reason=NOT_SIGNED_IN`)})})});
