var l=(a,t,e)=>new Promise((o,i)=>{var c=r=>{try{s(e.next(r))}catch(_){i(_)}},n=r=>{try{s(e.throw(r))}catch(_){i(_)}},s=r=>r.done?o(r.value):Promise.resolve(r.value).then(c,n);s((e=e.apply(a,t)).next())});var A=["Male","Female","Other","Prefer not to say"];function d(a,t="GET",e=!1,o=!1,i=!1,c=!0){try{let n={"Content-Type":"application/json"};i&&(n={}),o&&(n.Authorization=`Bearer ${o}`);let s={method:t,headers:n};return e&&(c?s.body=JSON.stringify(e):s.body=e),fetch(a,s).then(r=>r.ok?r.json():r.json().then(_=>(Promise.reject(_.message),{isFetchOk:!1,status:r.status,message:_.message,payload:_&&_.payload?_.payload:null}))).then(r=>r).catch(r=>(console.error("Error in fetch",r),r))}catch(n){return console.error("Error!: "+n),n}}function N(a=null,t="nammax_auth",e=60*60*24){a&&(document.cookie=`${t}=${a}; path=/; max-age=${e}`)}function x(a="nammax_auth"){let e=`; ${document.cookie}`.split(`; ${a}=`);return e.length===2?e.pop().split(";").shift():null}function m(a="/",t=2e3){setTimeout(()=>{window.location.href=a},t)}var E=Webflow||[];var g="https://www.nammacrossfit.com",f=g,p="/sign-in";var h=`${f}/sign-up-2`,R="/user/dashboard",b=`${f}/user/dashboard`;var O="https://xoxo-jnzf-s0on.m2.xano.io/api:U0aE1wpF/oauth/google/continue";var u="https://xoxo-jnzf-s0on.m2.xano.io/api:Kml2N_BA/user/preferences";var S=[];function I(a){return l(this,null,function*(){var t=new URL(O);t.searchParams.set("redirect_uri",`${h}/`),t.searchParams.set("code",a),t=t.toString();var e=new URL(document.location.href);e.searchParams.delete("code"),e.searchParams.delete("scope"),e.searchParams.delete("authuser"),e.searchParams.delete("hd"),e.searchParams.delete("prompt"),history.replaceState(null,"",e.toString());try{let o=yield fetch(t,{headers:S,method:"GET"});return o=yield o.json(),N(o.token),o.token}catch(o){return console.error("Error:",o),null}})}window.onload=function(){return l(this,null,function*(){var a=new URL(document.location.href),t=a.searchParams.get("reason"),e=a.searchParams.get("code");if(t){let i=document.getElementById("warning_block");i.style.display="block",i.innerText="Please fill these required details in order to use the app"}let o;if(e&&(o=yield I(e)),o||(o=x()),o){let i=document.querySelector("#date_of_birth");$(i).attr("autocomplete","off"),$(i).datepicker({format:"dd/mm/yyyy",language:"en",orientation:"bottom auto"}),D(o)}else m(`${p}?reason=NOT_SIGNED_IN`)})};function D(a){return l(this,null,function*(){let t=yield d(u,"GET",!1,a);if(t.isFetchOk!==void 0&&!t.isFetchOk){console.error(t.message),m(`${p}?reason=NOT_SIGNED_IN`,1e3);return}let{user:e,gyms:o}=t;e.weight&&(document.getElementById("weight").value=e.weight),e.height&&(document.getElementById("height").value=e.height),e.date_of_birth&&(document.getElementById("date_of_birth").value=e.date_of_birth);let i=document.getElementById("gym_select");o.forEach(n=>{var s=document.createElement("option");s.value=n.id,s.text=n.location,n.id===e.gym_id&&(s.selected=!0),i.appendChild(s)});let c=document.getElementById("gender_select");A.forEach(n=>{var s=document.createElement("option");s.value=n,s.text=n,n===t.gender&&(s.selected=!0),c.appendChild(s)})})}var U=E||[];U.push(function(){$(document).off("submit"),$("form").submit(function(a){return l(this,null,function*(){a.preventDefault();let t=document.getElementById("next-btn"),e;t&&(t.disabled=!0,e=t.value,t.value="Confirming...");let o=$(this),i=x();if(i){let c={date_of_birth:document.getElementById("date_of_birth").value,gender:document.getElementById("gender_select").value,height:document.getElementById("height").value,weight:document.getElementById("weight").value,gym_id:parseInt(document.getElementById("gym_select").value)},n=yield d(u,"POST",c,i);if(n.isFetchOk!==void 0&&!n.isFetchOk){console.error(n.message),o.siblings(".w-form-done").hide().siblings(".w-form-fail").show(),t&&(t.disabled=!1,t.value=e);return}else o.hide().siblings(".w-form-done").show().siblings(".w-form-fail").hide(),m(R)}else m(`${p}?reason=NOT_SIGNED_IN`)})})});
