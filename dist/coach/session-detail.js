var A=(n,s,a)=>new Promise((m,_)=>{var l=t=>{try{e(a.next(t))}catch(o){_(o)}},r=t=>{try{e(a.throw(t))}catch(o){_(o)}},e=t=>t.done?m(t.value):Promise.resolve(t.value).then(l,r);e((a=a.apply(n,s)).next())});function h(n,s="GET",a=!1,m=!1,_=!1,l=!0){try{let r={"Content-Type":"application/json"};_&&(r={}),m&&(r.Authorization=`Bearer ${m}`);let e={method:s,headers:r};return a&&(l?e.body=JSON.stringify(a):e.body=a),fetch(n,e).then(t=>t.ok?t.json():t.json().then(o=>(Promise.reject(o.message),{isFetchOk:!1,status:t.status,message:o.message,payload:o&&o.payload?o.payload:null}))).then(t=>t).catch(t=>(console.error("Error in fetch",t),t))}catch(r){return console.error("Error!: "+r),r}}function R(n="nammax_auth"){let a=`; ${document.cookie}`.split(`; ${n}=`);return a.length===2?a.pop().split(";").shift():null}function d(n="/",s=2e3){setTimeout(()=>{window.location.href=n},s)}function O(n=null,s=!1,a=!1,m=!1){if(n==null)return"NaN";let _=new Date,l=new Date(n),r=l.getHours(),e="";if(m||(e=r>=12?"PM":"AM",r=r%12||12),s){let t=l.getMinutes();return t=t<10?`0${t}`:t,a?`${_.getDate()===l.getDate()?"Today":_.getDate()+1===l.getDate()?"Tomorrow":_.getDate()+2===l.getDate()?"Day After Tomorrow":""} ${r}:${t} ${e}`:`${r}:${t} ${e}`}else return a?`${_.getDate()===l.getDate()?"Today":_.getDate()+1===l.getDate()?"Tomorrow":_.getDate()+2===l.getDate()?"Day After Tomorrow":""} ${r} ${e}`:`${r} ${e}`}function f(n=null){if(n==null)return"NaN";n=n*60;let s=`${n/60^0}`.slice(-2),a=("0"+n%60).slice(-2);return s!="0"?a!="00"?`${s} HR ${a} M`:s+" HR":a+" Mins"}function I(){let n=document.getElementById("loading-screen");n?n.remove():console.log("did not find loading screen")}var D=Webflow||[];var N="/coach/sign-in",g="/coach/dashboard";var U="/coach/session-summary/";var S="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/coach/sessions/attendence/";(()=>{let n={},s,a;window.onload=function(){let e=R();e?(m(e),I()):d(`${N}?reason=NOT_SIGNED_IN`)};function m(e){return A(this,null,function*(){var t=new URL(document.location.href);s=t.searchParams.get("session"),s||d(g),document.getElementById("submit-attendence-btn").disabled=!0;let o=yield h(S+s,"GET",!1,e);if(o.isFetchOk!==void 0&&!o.isFetchOk){console.error(o.message),d(`${N}?reason=NOT_SIGNED_IN`);return}o&&o.length>0&&(a=o[0].gym_id),o.some(i=>i.status==="COMPLETED"?(console.error("Session is already completed"),d(`/coach/session-summary?session=${i.id}`),!1):i.status==="IN PROGRESS"?(_(i),l(i,e),r(i,e),!0):(console.error("Session either unknown or not in progress"),d(`/coach/session-summary?session=${i.id}`),!1))})}function _(e){let t=document.getElementById("header-container");t.querySelector("#session-name").innerText=e.session_name,t.querySelector("#time").innerText=O(e.time,!0),t.querySelector("#date").innerText=new Date(e.time).toLocaleDateString("en-us",{weekday:"short",month:"short",day:"numeric"}),t.querySelector("#gym-location").innerText=e.location,t.querySelector("#duration").innerText=f(e.duration)}function l(e){let t=document.getElementById("attendence-container"),o=t.querySelector("#attendence-item");e.users.forEach((i,x)=>{let c=o.cloneNode(!0);c.setAttribute("id",""),c.querySelector("#index").innerText=x+1,i.profile_picture&&c.querySelector("#profile-pic").setAttribute("src",i.profile_picture.url),c.querySelector("#user-name").innerText=i.name,c.querySelector("#user-level").innerText=i.level,c.querySelector("#user-injury").innerText=i.injury;let p=c.querySelector("#attendence-checkmarks"),E=p.querySelector("#did-attend"),u=p.querySelector("#did-not-attend");u.classList.add("is-true"),E.onclick=()=>{E.classList.add("is-true"),u.classList.remove("is-true"),n[i.user_id]={attended:!0}},u.onclick=()=>{u.classList.add("is-true"),E.classList.remove("is-true"),n[i.user_id]={attended:!1}},n[i.user_id]={attended:!1},t.append(c)}),o.remove()}function r(e,t){let o=document.getElementById("submit-attendence-btn");o.disabled=!1,o.onclick=()=>A(this,null,function*(){o.disabled=!0;let i=[];Object.keys(n).forEach(p=>i.push({user_id:parseInt(p),attended:n[p].attended}));let x={allUsersAttendence:i,gym_id:a,session_id:parseInt(e.id)||e.id||""},c=yield h(S+e.id,"POST",x,t);if(c.isFetchOk!==void 0&&!c.isFetchOk){console.error(c.message),d(`${N}?reason=NOT_SIGNED_IN`),o.disabled=!1;return}d(`${U}?session=${e.id}`)})}})();var T=D||[];T.push(function(){$(document).off("submit"),$("form").on("submit",function(n){return A(this,null,function*(){n.preventDefault()})})});
