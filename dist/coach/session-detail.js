var A=(o,s,a)=>new Promise((r,m)=>{var _=t=>{try{e(a.next(t))}catch(n){m(n)}},c=t=>{try{e(a.throw(t))}catch(n){m(n)}},e=t=>t.done?r(t.value):Promise.resolve(t.value).then(_,c);e((a=a.apply(o,s)).next())});function h(o,s="GET",a=!1,r=!1,m=!1,_=!0){try{let c={"Content-Type":"application/json"};m&&(c={}),r&&(c.Authorization=`Bearer ${r}`);let e={method:s,headers:c};return a&&(_?e.body=JSON.stringify(a):e.body=a),fetch(o,e).then(t=>t.ok?t.json():t.json().then(n=>(Promise.reject(n.message),{isFetchOk:!1,status:t.status,message:n.message,payload:n&&n.payload?n.payload:null}))).then(t=>t).catch(t=>(console.error("Error in fetch",t),t))}catch(c){return console.error("Error!: "+c),c}}function R(o="nammax_auth"){let a=`; ${document.cookie}`.split(`; ${o}=`);return a.length===2?a.pop().split(";").shift():null}function d(o="/",s=0){setTimeout(()=>{window.location.href=o},s)}function O(o=null,s=!1){if(o==null)return"NaN";var a=new Date(o),r=a.getHours(),m=r>=12?"PM":"AM";if(r=r%12||12,s){var _=a.getMinutes();return _=_<10?`0${_}`:_,`${r}:${_} ${m}`}else return`${r} ${m}`}function f(o=null){if(o==null)return"NaN";o=o*60;let s=`${o/60^0}`.slice(-2),a=("0"+o%60).slice(-2);return s!="0"?a!="00"?`${s} HR ${a} M`:s+" HR":a+" Mins"}var I=Webflow||[];var N="/coach/sign-in",g="/coach/dashboard";var U="/coach/session-summary/";var S="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/coach/sessions/attendence/";(()=>{let o={},s,a;window.onload=function(){let e=R();e?r(e):d(`${N}?reason=NOT_SIGNED_IN`)};function r(e){return A(this,null,function*(){var t=new URL(document.location.href);s=t.searchParams.get("session"),s||d(g),document.getElementById("submit-attendence-btn").disabled=!0;let n=yield h(S+s,"GET",!1,e);if(n.isFetchOk!==void 0&&!n.isFetchOk){console.error(n.message),d(`${N}?reason=NOT_SIGNED_IN`);return}n&&n.length>0&&(a=n[0].gym_id),n.some(i=>i.status==="COMPLETED"?(console.error("Session is already completed"),d(`/coach/session-summary?session=${i.id}`),!1):i.status==="IN PROGRESS"?(m(i),_(i,e),c(i,e),!0):(console.error("Session either unknown or not in progress"),d(`/coach/session-summary?session=${i.id}`),!1))})}function m(e){let t=document.getElementById("header-container");t.querySelector("#session-name").innerText=e.session_name,t.querySelector("#time").innerText=O(e.time,!0),t.querySelector("#date").innerText=new Date(e.time).toLocaleDateString("en-us",{weekday:"short",month:"short",day:"numeric"}),t.querySelector("#gym-location").innerText=e.location,t.querySelector("#duration").innerText=f(e.duration)}function _(e){let t=document.getElementById("attendence-container"),n=t.querySelector("#attendence-item");e.users.forEach((i,x)=>{let l=n.cloneNode(!0);l.setAttribute("id",""),l.querySelector("#index").innerText=x+1,i.profile_picture&&l.querySelector("#profile-pic").setAttribute("src",i.profile_picture.url),l.querySelector("#user-name").innerText=i.name,l.querySelector("#user-level").innerText=i.level,l.querySelector("#user-injury").innerText=i.injury;let p=l.querySelector("#attendence-checkmarks"),E=p.querySelector("#did-attend"),u=p.querySelector("#did-not-attend");u.classList.add("is-true"),E.onclick=()=>{E.classList.add("is-true"),u.classList.remove("is-true"),o[i.user_id]={attended:!0}},u.onclick=()=>{u.classList.add("is-true"),E.classList.remove("is-true"),o[i.user_id]={attended:!1}},o[i.user_id]={attended:!1},t.append(l)}),n.remove()}function c(e,t){let n=document.getElementById("submit-attendence-btn");n.disabled=!1,n.onclick=()=>A(this,null,function*(){n.disabled=!0;let i=[];Object.keys(o).forEach(p=>i.push({user_id:parseInt(p),attended:o[p].attended}));let x={allUsersAttendence:i,gym_id:a,session_id:parseInt(e.id)||e.id||""},l=yield h(S+e.id,"POST",x,t);if(l.isFetchOk!==void 0&&!l.isFetchOk){console.error(l.message),d(`${N}?reason=NOT_SIGNED_IN`),n.disabled=!1;return}d(`${U}?session=${e.id}`)})}})();var D=I||[];D.push(function(){$(document).off("submit"),$("form").on("submit",function(o){return A(this,null,function*(){o.preventDefault()})})});
