var x=(e,n,r)=>new Promise((m,l)=>{var c=t=>{try{o(r.next(t))}catch(s){l(s)}},i=t=>{try{o(r.throw(t))}catch(s){l(s)}},o=t=>t.done?m(t.value):Promise.resolve(t.value).then(c,i);o((r=r.apply(e,n)).next())});function h(e,n="GET",r=!1,m=!1,l=!1,c=!0){try{let i={"Content-Type":"application/json"};l&&(i={}),m&&(i.Authorization=`Bearer ${m}`);let o={method:n,headers:i};return r&&(c?o.body=JSON.stringify(r):o.body=r),fetch(e,o).then(t=>t.ok?t.json():t.json().then(s=>(Promise.reject(s.message),{isFetchOk:!1,status:t.status,message:s.message,payload:s&&s.payload?s.payload:null}))).then(t=>t).catch(t=>(console.error("Error in fetch",t),t))}catch(i){return console.error("Error!: "+i),i}}function I(e="nammax_auth"){let r=`; ${document.cookie}`.split(`; ${e}=`);return r.length===2?r.pop().split(";").shift():null}function d(e="/",n=2e3){setTimeout(()=>{window.location.href=e},n)}function U(e=null,n=!1,r=!1,m=!1){if(e==null)return"NaN";let l=new Date,c=new Date(e),i=c.getHours(),o="";if(m||(o=i>=12?"PM":"AM",i=i%12||12),n){let t=c.getMinutes();return t=t<10?`0${t}`:t,r?`${l.getDate()===c.getDate()?"Today At":l.getDate()+1===c.getDate()?"Tomorrow At":l.getDate()+2===c.getDate()?"Day After Tomorrow At":E(e)} ${i}:${t} ${o}`:`${i}:${t} ${o}`}else return r?`${l.getDate()===c.getDate()?"Today At":l.getDate()+1===c.getDate()?"Tomorrow At":l.getDate()+2===c.getDate()?"Day After Tomorrow At":E(e)} ${i} ${o}`:`${E(e)} ${i} ${o}`}function E(e=null){if(e==null)return"NaN";let n=new Date(e);return`${n.getDate()}/${n.getMonth()+1}/${n.getFullYear()}`}function T(e=null){if(e==null)return"NaN";e=e*60;let n=`${e/60^0}`.slice(-2),r=("0"+e%60).slice(-2);return n!="0"?r!="00"?`${n} HR ${r} M`:n+" HR":r+" Mins"}function y(){let e=document.getElementById("loading-screen");e?e.remove():console.log("did not find loading screen")}function g(e){let n=new Date(e);return n.setMinutes(n.getMinutes()-n.getTimezoneOffset()),n}function S(e,n,r=!1){let m=864e5;return Math.round((g(n)-g(e))/m)}var L=Webflow||[];var A="/coach/sign-in",C="/coach/dashboard";var M="/coach/session-summary/";var R="https://xoxo-jnzf-s0on.m2.xano.io/api:Kml2N_BA/coach/sessions/attendence/";(()=>{let e={},n,r;window.onload=function(){let o=I();o?(m(o),y()):d(`${A}?reason=NOT_SIGNED_IN`)};function m(o){return x(this,null,function*(){var t=new URL(document.location.href);n=t.searchParams.get("session"),n||d(C),document.getElementById("submit-attendence-btn").disabled=!0;let s=yield h(R+n,"GET",!1,o);if(s.isFetchOk!==void 0&&!s.isFetchOk){console.error(s.message),d(`${A}?reason=NOT_SIGNED_IN`);return}s&&s.length>0&&(r=s[0].gym_id),s.some(a=>a.status==="COMPLETED"?(console.error("Session is already completed"),d(`/coach/session-summary?session=${a.id}`),!1):a.status==="IN PROGRESS"?(l(a),c(a,o),i(a,o),!0):(console.error("Session either unknown or not in progress"),d(`/coach/session-summary?session=${a.id}`),!1))})}function l(o){let t=document.getElementById("header-container");t.querySelector("#session-name").innerText=o.session_name,t.querySelector("#time").innerText=U(o.time,!0),t.querySelector("#date").innerText=new Date(o.time).toLocaleDateString("en-us",{weekday:"short",month:"short",day:"numeric"}),t.querySelector("#gym-location").innerText=o.location,t.querySelector("#duration").innerText=T(o.duration)}function c(o){let t=document.getElementById("attendence-container"),s=t.querySelector("#attendence-item");o.users.forEach((a,N)=>{let _=s.cloneNode(!0);if(_.setAttribute("id",""),_.querySelector("#index").innerText=N+1,a.profile_picture&&_.querySelector("#profile-pic").setAttribute("src",a.profile_picture.url),a.membership_end_date){let O=new Date(a.membership_end_date),D=new Date;(a==null?void 0:a.session_ledger)!==void 0&&a.session_ledger.length<=3?_.querySelector("#profile-pic").style.border="3px solid #009ca1":S(D,O,!0)<=3?_.querySelector("#profile-pic").style.border="3px solid red":S(D,O,!0)<=7&&(_.querySelector("#profile-pic").style.border="3px solid orange")}_.querySelector("#user-name").innerText=a.name,_.querySelector("#user-level").innerText=a.level,_.querySelector("#user-injury").innerText=a.injury;let p=_.querySelector("#attendence-checkmarks"),f=p.querySelector("#did-attend"),u=p.querySelector("#did-not-attend");u.classList.add("is-true"),f.onclick=()=>{f.classList.add("is-true"),u.classList.remove("is-true"),e[a.user_id]={attended:!0}},u.onclick=()=>{u.classList.add("is-true"),f.classList.remove("is-true"),e[a.user_id]={attended:!1}},e[a.user_id]={attended:!1},t.append(_)}),s.remove()}function i(o,t){let s=document.getElementById("submit-attendence-btn");s.disabled=!1,s.onclick=()=>x(this,null,function*(){s.disabled=!0;let a=[];Object.keys(e).forEach(p=>a.push({user_id:parseInt(p),attended:e[p].attended}));let N={allUsersAttendence:a,gym_id:r,session_id:parseInt(o.id)||o.id||""},_=yield h(R+o.id,"POST",N,t);if(_.isFetchOk!==void 0&&!_.isFetchOk){console.error(_.message),d(`${A}?reason=NOT_SIGNED_IN`),s.disabled=!1;return}d(`${M}?session=${o.id}`)})}})();var B=L||[];B.push(function(){$(document).off("submit"),$("form").on("submit",function(e){return x(this,null,function*(){e.preventDefault()})})});
