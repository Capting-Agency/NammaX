var p=(t,o,e)=>new Promise((n,s)=>{var a=i=>{try{l(e.next(i))}catch(_){s(_)}},r=i=>{try{l(e.throw(i))}catch(_){s(_)}},l=i=>i.done?n(i.value):Promise.resolve(i.value).then(a,r);l((e=e.apply(t,o)).next())});function u(t,o="GET",e=!1,n=!1,s=!1,a=!0){try{let r={"Content-Type":"application/json"};s&&(r={}),n&&(r.Authorization=`Bearer ${n}`);let l={method:o,headers:r};return e&&(a?l.body=JSON.stringify(e):l.body=e),fetch(t,l).then(i=>i.ok?i.json():i.json().then(_=>(Promise.reject(_.message),{isFetchOk:!1,status:i.status,message:_.message,payload:_&&_.payload?_.payload:null}))).then(i=>i).catch(i=>(console.error("Error in fetch",i),i))}catch(r){return console.error("Error!: "+r),r}}function x(t="nammax_auth"){let e=`; ${document.cookie}`.split(`; ${t}=`);return e.length===2?e.pop().split(";").shift():null}function c(t="/",o=0){setTimeout(()=>{window.location.href=t},o)}function E(t=null,o=!1){if(t==null)return"NaN";var e=new Date(t),n=e.getHours(),s=n>=12?"PM":"AM";if(n=n%12||12,o){var a=e.getMinutes();return a=a<10?`0${a}`:a,`${n}:${a} ${s}`}else return`${n} ${s}`}function h(t=null){if(t==null)return"NaN";t=t*60;let o=`${t/60^0}`.slice(-2),e=("0"+t%60).slice(-2);return o!="0"?e!="00"?`${o} HR ${e} M`:o+" HR":e+" Mins"}var d="/coach/sign-in",S="/coach/dashboard";var R="/coach/session-summary/";var A="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/coach/sessions/attendence/";var m={},N,O;window.onload=function(){let t=x();t?I(t):c(`${d}?reason=NOT_SIGNED_IN`)};function I(t){return p(this,null,function*(){var o=new URL(document.location.href);N=o.searchParams.get("session"),N||c(S),document.getElementById("submit-attendence-btn").disabled=!0;let e=yield u(A+N,"GET",!1,t);if(e.isFetchOk!==void 0&&!e.isFetchOk){console.error(e.message),c(`${d}?reason=NOT_SIGNED_IN`);return}e&&e.length>0&&(O=e[0].gym_id),e.some(n=>n.status==="COMPLETED"?(console.error("Session is already completed"),c(`/coach/session-summary?session=${n.id}`),!1):n.status==="IN PROGRESS"?(f(n),g(n,t),U(n,t),!0):(console.error("Session either unknown or not in progress"),c(`/coach/session-summary?session=${n.id}`),!1))})}function f(t){let o=document.getElementById("header-container");o.querySelector("#session-name").innerText=t.session_name,o.querySelector("#time").innerText=E(t.time,!0),o.querySelector("#date").innerText=new Date(t.time).toLocaleDateString("en-us",{weekday:"short",month:"short",day:"numeric"}),o.querySelector("#gym-location").innerText=t.location,o.querySelector("#duration").innerText=h(t.duration)}function g(t){let o=document.getElementById("attendence-container"),e=o.querySelector("#attendence-item");t.users.forEach((n,s)=>{let a=e.cloneNode(!0);a.setAttribute("id",""),a.querySelector("#index").innerText=s+1,n.profile_picture&&a.querySelector("#profile-pic").setAttribute("src",n.profile_picture.url),a.querySelector("#user-name").innerText=n.name,a.querySelector("#user-level").innerText=n.level,a.querySelector("#user-injury").innerText=n.injury;let r=a.querySelector("#attendence-checkmarks"),l=r.querySelector("#did-attend"),i=r.querySelector("#did-not-attend");i.classList.add("is-true"),l.onclick=()=>{l.classList.add("is-true"),i.classList.remove("is-true"),m[n.user_id]={attended:!0}},i.onclick=()=>{i.classList.add("is-true"),l.classList.remove("is-true"),m[n.user_id]={attended:!1}},m[n.user_id]={attended:!1},o.append(a)}),e.remove()}function U(t,o){let e=document.getElementById("submit-attendence-btn");e.disabled=!1,e.onclick=()=>p(this,null,function*(){e.disabled=!0;let n=[];Object.keys(m).forEach(r=>n.push({user_id:parseInt(r),attended:m[r].attended}));let s={allUsersAttendence:n,gym_id:O,session_id:parseInt(t.id)||t.id||""},a=yield u(A+t.id,"POST",s,o);if(a.isFetchOk!==void 0&&!a.isFetchOk){console.error(a.message),c(`${d}?reason=NOT_SIGNED_IN`);return}c(`${R}?session=${t.id}`)})}
//# sourceMappingURL=session-detail.js.map
