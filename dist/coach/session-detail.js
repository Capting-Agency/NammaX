var A=(n,i,r)=>new Promise((m,c)=>{var _=t=>{try{e(r.next(t))}catch(o){c(o)}},s=t=>{try{e(r.throw(t))}catch(o){c(o)}},e=t=>t.done?m(t.value):Promise.resolve(t.value).then(_,s);e((r=r.apply(n,i)).next())});function h(n,i="GET",r=!1,m=!1,c=!1,_=!0){try{let s={"Content-Type":"application/json"};c&&(s={}),m&&(s.Authorization=`Bearer ${m}`);let e={method:i,headers:s};return r&&(_?e.body=JSON.stringify(r):e.body=r),fetch(n,e).then(t=>t.ok?t.json():t.json().then(o=>(Promise.reject(o.message),{isFetchOk:!1,status:t.status,message:o.message,payload:o&&o.payload?o.payload:null}))).then(t=>t).catch(t=>(console.error("Error in fetch",t),t))}catch(s){return console.error("Error!: "+s),s}}function I(n="nammax_auth"){let r=`; ${document.cookie}`.split(`; ${n}=`);return r.length===2?r.pop().split(";").shift():null}function d(n="/",i=2e3){setTimeout(()=>{window.location.href=n},i)}function g(n=null,i=!1,r=!1,m=!1){if(n==null)return"NaN";let c=new Date,_=new Date(n),s=_.getHours(),e="";if(m||(e=s>=12?"PM":"AM",s=s%12||12),i){let t=_.getMinutes();return t=t<10?`0${t}`:t,r?`${c.getDate()===_.getDate()?"Today":c.getDate()+1===_.getDate()?"Tomorrow":c.getDate()+2===_.getDate()?"Day After Tomorrow":""} ${s}:${t} ${e}`:`${s}:${t} ${e}`}else return r?`${c.getDate()===_.getDate()?"Today":c.getDate()+1===_.getDate()?"Tomorrow":c.getDate()+2===_.getDate()?"Day After Tomorrow":""} ${s} ${e}`:`${s} ${e}`}function U(n=null){if(n==null)return"NaN";n=n*60;let i=`${n/60^0}`.slice(-2),r=("0"+n%60).slice(-2);return i!="0"?r!="00"?`${i} HR ${r} M`:i+" HR":r+" Mins"}function y(){let n=document.getElementById("loading-screen");n?n.remove():console.log("did not find loading screen")}function D(n){let i=new Date(n);return i.setMinutes(i.getMinutes()-i.getTimezoneOffset()),i}function f(n,i,r=!1){let m=864e5;return Math.round((D(i)-D(n))/m)}var T=Webflow||[];var N="/coach/sign-in",L="/coach/dashboard";var C="/coach/session-summary/";var S="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/coach/sessions/attendence/";(()=>{let n={},i,r;window.onload=function(){let e=I();e?(m(e),y()):d(`${N}?reason=NOT_SIGNED_IN`)};function m(e){return A(this,null,function*(){var t=new URL(document.location.href);i=t.searchParams.get("session"),i||d(L),document.getElementById("submit-attendence-btn").disabled=!0;let o=yield h(S+i,"GET",!1,e);if(o.isFetchOk!==void 0&&!o.isFetchOk){console.error(o.message),d(`${N}?reason=NOT_SIGNED_IN`);return}o&&o.length>0&&(r=o[0].gym_id),o.some(a=>a.status==="COMPLETED"?(console.error("Session is already completed"),d(`/coach/session-summary?session=${a.id}`),!1):a.status==="IN PROGRESS"?(c(a),_(a,e),s(a,e),!0):(console.error("Session either unknown or not in progress"),d(`/coach/session-summary?session=${a.id}`),!1))})}function c(e){let t=document.getElementById("header-container");t.querySelector("#session-name").innerText=e.session_name,t.querySelector("#time").innerText=g(e.time,!0),t.querySelector("#date").innerText=new Date(e.time).toLocaleDateString("en-us",{weekday:"short",month:"short",day:"numeric"}),t.querySelector("#gym-location").innerText=e.location,t.querySelector("#duration").innerText=U(e.duration)}function _(e){let t=document.getElementById("attendence-container"),o=t.querySelector("#attendence-item");e.users.forEach((a,x)=>{let l=o.cloneNode(!0);if(l.setAttribute("id",""),l.querySelector("#index").innerText=x+1,a.profile_picture&&l.querySelector("#profile-pic").setAttribute("src",a.profile_picture.url),a.membership_end_date){let R=new Date(a.membership_end_date),O=new Date;(a==null?void 0:a.session_ledger)!==void 0&&a.session_ledger.length<=3?l.querySelector("#profile-pic").style.border="3px solid #009ca1":f(O,R,!0)<=3?l.querySelector("#profile-pic").style.border="3px solid red":f(O,R,!0)<=7&&(l.querySelector("#profile-pic").style.border="3px solid orange")}l.querySelector("#user-name").innerText=a.name,l.querySelector("#user-level").innerText=a.level,l.querySelector("#user-injury").innerText=a.injury;let p=l.querySelector("#attendence-checkmarks"),E=p.querySelector("#did-attend"),u=p.querySelector("#did-not-attend");u.classList.add("is-true"),E.onclick=()=>{E.classList.add("is-true"),u.classList.remove("is-true"),n[a.user_id]={attended:!0}},u.onclick=()=>{u.classList.add("is-true"),E.classList.remove("is-true"),n[a.user_id]={attended:!1}},n[a.user_id]={attended:!1},t.append(l)}),o.remove()}function s(e,t){let o=document.getElementById("submit-attendence-btn");o.disabled=!1,o.onclick=()=>A(this,null,function*(){o.disabled=!0;let a=[];Object.keys(n).forEach(p=>a.push({user_id:parseInt(p),attended:n[p].attended}));let x={allUsersAttendence:a,gym_id:r,session_id:parseInt(e.id)||e.id||""},l=yield h(S+e.id,"POST",x,t);if(l.isFetchOk!==void 0&&!l.isFetchOk){console.error(l.message),d(`${N}?reason=NOT_SIGNED_IN`),o.disabled=!1;return}d(`${C}?session=${e.id}`)})}})();var w=T||[];w.push(function(){$(document).off("submit"),$("form").on("submit",function(n){return A(this,null,function*(){n.preventDefault()})})});
