var x=(e,o,r)=>new Promise((m,l)=>{var c=t=>{try{n(r.next(t))}catch(s){l(s)}},i=t=>{try{n(r.throw(t))}catch(s){l(s)}},n=t=>t.done?m(t.value):Promise.resolve(t.value).then(c,i);n((r=r.apply(e,o)).next())});function h(e,o="GET",r=!1,m=!1,l=!1,c=!0){try{let i={"Content-Type":"application/json"};l&&(i={}),m&&(i.Authorization=`Bearer ${m}`);let n={method:o,headers:i};return r&&(c?n.body=JSON.stringify(r):n.body=r),fetch(e,n).then(t=>t.ok?t.json():t.json().then(s=>(Promise.reject(s.message),{isFetchOk:!1,status:t.status,message:s.message,payload:s&&s.payload?s.payload:null}))).then(t=>t).catch(t=>(console.error("Error in fetch",t),t))}catch(i){return console.error("Error!: "+i),i}}function I(e="nammax_auth"){let r=`; ${document.cookie}`.split(`; ${e}=`);return r.length===2?r.pop().split(";").shift():null}function d(e="/",o=2e3){setTimeout(()=>{window.location.href=e},o)}function U(e=null,o=!1,r=!1,m=!1){if(e==null)return"NaN";let l=new Date,c=new Date(e),i=c.getHours(),n="";if(m||(n=i>=12?"PM":"AM",i=i%12||12),o){let t=c.getMinutes();return t=t<10?`0${t}`:t,r?`${l.getDate()===c.getDate()?"Today":l.getDate()+1===c.getDate()?"Tomorrow":l.getDate()+2===c.getDate()?"Day After Tomorrow":E(e)} ${i}:${t} ${n}`:`${i}:${t} ${n}`}else return r?`${l.getDate()===c.getDate()?"Today":l.getDate()+1===c.getDate()?"Tomorrow":l.getDate()+2===c.getDate()?"Day After Tomorrow":E(e)} ${i} ${n}`:`${E(e)} ${i} ${n}`}function E(e=null){if(e==null)return"NaN";let o=new Date(e);return`${o.getDate()}/${o.getMonth()+1}/${o.getFullYear()}`}function T(e=null){if(e==null)return"NaN";e=e*60;let o=`${e/60^0}`.slice(-2),r=("0"+e%60).slice(-2);return o!="0"?r!="00"?`${o} HR ${r} M`:o+" HR":r+" Mins"}function y(){let e=document.getElementById("loading-screen");e?e.remove():console.log("did not find loading screen")}function g(e){let o=new Date(e);return o.setMinutes(o.getMinutes()-o.getTimezoneOffset()),o}function S(e,o,r=!1){let m=864e5;return Math.round((g(o)-g(e))/m)}var L=Webflow||[];var A="/coach/sign-in",C="/coach/dashboard";var M="/coach/session-summary/";var R="https://xoxo-jnzf-s0on.m2.xano.io/api:Kml2N_BA/coach/sessions/attendence/";(()=>{let e={},o,r;window.onload=function(){let n=I();n?(m(n),y()):d(`${A}?reason=NOT_SIGNED_IN`)};function m(n){return x(this,null,function*(){var t=new URL(document.location.href);o=t.searchParams.get("session"),o||d(C),document.getElementById("submit-attendence-btn").disabled=!0;let s=yield h(R+o,"GET",!1,n);if(s.isFetchOk!==void 0&&!s.isFetchOk){console.error(s.message),d(`${A}?reason=NOT_SIGNED_IN`);return}s&&s.length>0&&(r=s[0].gym_id),s.some(a=>a.status==="COMPLETED"?(console.error("Session is already completed"),d(`/coach/session-summary?session=${a.id}`),!1):a.status==="IN PROGRESS"?(l(a),c(a,n),i(a,n),!0):(console.error("Session either unknown or not in progress"),d(`/coach/session-summary?session=${a.id}`),!1))})}function l(n){let t=document.getElementById("header-container");t.querySelector("#session-name").innerText=n.session_name,t.querySelector("#time").innerText=U(n.time,!0),t.querySelector("#date").innerText=new Date(n.time).toLocaleDateString("en-us",{weekday:"short",month:"short",day:"numeric"}),t.querySelector("#gym-location").innerText=n.location,t.querySelector("#duration").innerText=T(n.duration)}function c(n){let t=document.getElementById("attendence-container"),s=t.querySelector("#attendence-item");n.users.forEach((a,N)=>{let _=s.cloneNode(!0);if(_.setAttribute("id",""),_.querySelector("#index").innerText=N+1,a.profile_picture&&_.querySelector("#profile-pic").setAttribute("src",a.profile_picture.url),a.membership_end_date){let O=new Date(a.membership_end_date),D=new Date;(a==null?void 0:a.session_ledger)!==void 0&&a.session_ledger.length<=3?_.querySelector("#profile-pic").style.border="3px solid #009ca1":S(D,O,!0)<=3?_.querySelector("#profile-pic").style.border="3px solid red":S(D,O,!0)<=7&&(_.querySelector("#profile-pic").style.border="3px solid orange")}_.querySelector("#user-name").innerText=a.name,_.querySelector("#user-level").innerText=a.level,_.querySelector("#user-injury").innerText=a.injury;let p=_.querySelector("#attendence-checkmarks"),f=p.querySelector("#did-attend"),u=p.querySelector("#did-not-attend");u.classList.add("is-true"),f.onclick=()=>{f.classList.add("is-true"),u.classList.remove("is-true"),e[a.user_id]={attended:!0}},u.onclick=()=>{u.classList.add("is-true"),f.classList.remove("is-true"),e[a.user_id]={attended:!1}},e[a.user_id]={attended:!1},t.append(_)}),s.remove()}function i(n,t){let s=document.getElementById("submit-attendence-btn");s.disabled=!1,s.onclick=()=>x(this,null,function*(){s.disabled=!0;let a=[];Object.keys(e).forEach(p=>a.push({user_id:parseInt(p),attended:e[p].attended}));let N={allUsersAttendence:a,gym_id:r,session_id:parseInt(n.id)||n.id||""},_=yield h(R+n.id,"POST",N,t);if(_.isFetchOk!==void 0&&!_.isFetchOk){console.error(_.message),d(`${A}?reason=NOT_SIGNED_IN`),s.disabled=!1;return}d(`${M}?session=${n.id}`)})}})();var B=L||[];B.push(function(){$(document).off("submit"),$("form").on("submit",function(e){return x(this,null,function*(){e.preventDefault()})})});
