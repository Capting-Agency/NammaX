var E=(t,o,e)=>new Promise((r,m)=>{var s=n=>{try{i(e.next(n))}catch(l){m(l)}},a=n=>{try{i(e.throw(n))}catch(l){m(l)}},i=n=>n.done?r(n.value):Promise.resolve(n.value).then(s,a);i((e=e.apply(t,o)).next())});function R(t,o="GET",e=!1,r=!1,m=!1,s=!0){try{let a={"Content-Type":"application/json"};m&&(a={}),r&&(a.Authorization=`Bearer ${r}`);let i={method:o,headers:a};return e&&(s?i.body=JSON.stringify(e):i.body=e),fetch(t,i).then(n=>n.ok?n.json():n.json().then(l=>(Promise.reject(l.message),{isFetchOk:!1,status:n.status,message:l.message,payload:l&&l.payload?l.payload:null}))).then(n=>n).catch(n=>(console.error("Error in fetch",n),n))}catch(a){return console.error("Error!: "+a),a}}function b(t=null,o="nammax_auth",e=60*60*24){t&&(document.cookie=`${o}=${t}; path=/; max-age=${e}`)}function y(t="nammax_auth"){let e=`; ${document.cookie}`.split(`; ${t}=`);return e.length===2?e.pop().split(";").shift():null}function S(t="/",o=2e3){setTimeout(()=>{window.location.href=t},o)}function f(t=null,o=!1,e=!1,r=!1){if(t==null)return"NaN";let m=new Date,s=new Date(t),a=s.getHours(),i="";if(r||(i=a>=12?"PM":"AM",a=a%12||12),o){let n=s.getMinutes();return n=n<10?`0${n}`:n,e?`${m.getDate()===s.getDate()?"Today":m.getDate()+1===s.getDate()?"Tomorrow":m.getDate()+2===s.getDate()?"Day After Tomorrow":I(t)} ${a}:${n} ${i}`:`${a}:${n} ${i}`}else return e?`${m.getDate()===s.getDate()?"Today":m.getDate()+1===s.getDate()?"Tomorrow":m.getDate()+2===s.getDate()?"Day After Tomorrow":I(t)} ${a} ${i}`:`${I(t)} ${a} ${i}`}function I(t=null){if(t==null)return"NaN";let o=new Date(t);return`${o.getDate()}/${o.getMonth()+1}/${o.getFullYear()}`}function D(t=null){if(t==null)return"NaN";t=t*60;let o=`${t/60^0}`.slice(-2),e=("0"+t%60).slice(-2);return o!="0"?e!="00"?`${o} HR ${e} M`:o+" HR":e+" Mins"}function k(t,o=null){if(t!=null){var e,r=t.options.length-1;for(e=r;e>=0;e--)e!==o&&t.remove(e)}}function X(t="/sign-in"){window.localStorage.removeItem("auth"),S(`${t}`)}function O(t=!1,o=!0,e="current-time"){let r=document.getElementById(e);r&&o?(r.innerText=`${new Date().toLocaleDateString("en-us",{weekday:"short",month:"short",day:"numeric"})} | ${f(new Date().getTime(),!0,!1,t)}`,setTimeout(()=>O(t,o,e),2e4)):r&&!o&&(r.innerText=f(new Date().getTime(),!0,!1,t),setTimeout(()=>O(t,o,e),2e4))}function v(){let t=document.getElementById("loading-screen");t?t.remove():console.log("did not find loading screen")}function T({single:t=!0,baseElement:o="",TriggerBtn:e="jsModalOpen",_modalWindow:r="jsModal"},m){if(t){var s=o.querySelector("#"+e);s.onclick=function(){var n=document.getElementById(r);m&&m(),n.classList?n.classList.add("open"):n.className+=" open"}}else for(var a=document.getElementsByClassName(e),i=0;i<a.length;i++)a[i].onclick=function(){var n=this.getAttribute("href").substr(1),l=document.getElementById(n);l.classList?l.classList.add("open"):l.className+=" open"}}function U({TriggerBtn:t="jsModalClose",_modalWindow:o="jsModal"},e){var r=document.getElementById(t),m=document.getElementById(o);r.onclick=function(){m.classList?m.classList.remove("open"):m.className=m.className.replace(new RegExp("(^|\\b)"+"open".split(" ").join("|")+"(\\b|$)","gi")," ")},e&&e()}function H({_modalWindow:t="jsModal"},o){var e=document.getElementById(t);function r(){e.classList?e.classList.add("open"):e.className+=" open",o&&o()}r()}function w({_modalWindow:t},o){var e=document.getElementById(t);function r(){e.classList?e.classList.remove("open"):e.className=e.className.replace(new RegExp("(^|\\b)"+"open".split(" ").join("|")+"(\\b|$)","gi")," "),o&&o()}r()}var K=Webflow||[];var L="/coach/sign-in";var C="/coach/session-details/";var P="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/coach/sessions/start_session/",G="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/coach/dashboard/",W="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/coach/all_gyms";(()=>{let t=[];window.onload=function(){let s=document.getElementById("navbar-logout-btn");s&&(s.onclick=()=>{X("/coach/sign-in")});let a=y();a?(O(!0),o(a),v()):S(`${L}?reason=NOT_SIGNED_IN`)};function o(s,a=!1){return E(this,null,function*(){let i=y("nammaxCoachSelectedGym");if(!i||a){H({_modalWindow:"gym-select-popout"});let n;if(t.length===0?n=yield R(W,"GET",!1,s):n=t,n.isFetchOk!==void 0&&!n.isFetchOk){console.error(n.message),S(`${L}?reason=NOT_SIGNED_IN`);return}t=n;let l=document.getElementById("gym-select-popout"),p=l.querySelector("#coach-gym-select"),N=l.querySelector("#confirm-gym-select-btn");if(a){let u=l.querySelector("#cancel-gym-select-btn");u.onclick=()=>{w({_modalWindow:"gym-select-popout"})},u.classList.remove("hide")}k(p),n.forEach((u,c)=>{var _=document.createElement("option");_.value=u.id,_.innerText=u.location,c===0&&(_.selected=!0),i==u.id&&(_.selected=!0),p.appendChild(_)}),N.onclick=()=>{let u=p.value;e(u,s),w({_modalWindow:"gym-select-popout"},()=>{b(u,"nammaxCoachSelectedGym")})}}else e(i,s)})}function e(s,a){return E(this,null,function*(){let i=yield R(G+s,"GET",!1,a);if(i.isFetchOk!==void 0&&!i.isFetchOk){console.error(i.message);return}let{coach:n,sessions:l}=i;n.profile_picture.url&&(document.getElementById("profile-avatar").style.backgroundImage=`url(${n.profile_picture.url})`),document.getElementById("user-name").innerText="Coach "+n.name,document.getElementById("location-map-name").innerText=n.location,l.forEach(p=>{if(p.status==="IN PROGRESS"&&p.coach.status==="IN SESSION"&&p.team_id===n.id){S(`${C}?session=${p.id}`);return}}),r(a),m(a,l)})}function r(s){T({_modalWindow:"gym-select-popout",TriggerBtn:"location-map-change-btn",baseElement:document.getElementById("location-map-container")},()=>{o(s,!0)}),U({_modalWindow:"gym-select-popout",TriggerBtn:"cancel-gym-select-btn"})}function m(s,a){return E(this,null,function*(){let i=document.getElementById("view-coach-sessions-container"),n=i.querySelector("#view-coach-sessions-item");function l(p){let N=i.querySelectorAll(".session-details-w.card-item");N.forEach((c,_)=>{_!==N.length-1&&c.remove()});let u=i.querySelector("#no-sessions-found");p.length===0?u.style.display="flex":u.style.display="none",p.forEach(c=>{let _=n.cloneNode(!0);_.setAttribute("id",""),_.querySelector("#session-name").innerText=c.session_name,_.querySelector("#time").innerText=f(c.time,!0,!0,!0),_.querySelector("#duration").innerText=D(c.duration),_.querySelector("#session-slot-bar").style.width=c.users.length/c.capacity*100+"%",_.querySelector("#session-capacity").innerText=`${c.users.length}/${c.capacity}`;let F=_.querySelector("#start-session-btn"),g=_.querySelector("#start-session-btn").querySelector("span");function M(){let d=new Date().getDate()-new Date(c.time).getDate(),h=new Date().getHours()-new Date(c.time).getHours(),x=new Date().getMinutes()-new Date(c.time).getMinutes(),A=Math.abs(x);x<-15&&d===0?(F.innerText="MISSED SESSION!",g.innerText=""):h===0&&A<=15?x>0?g.innerText=`OVERDUE BY ${A} MINUTE(S)`:x===0?g.innerText="NOW":g.innerText=`STARTS IN ${A} MINUTE(S)`:g.innerText="",setTimeout(()=>{M()},2e4)}M(),T({baseElement:_,TriggerBtn:"start-session-btn",_modalWindow:"confirm-session-popout"},()=>{let d=document.getElementById("confirm-session-popout");d.querySelector("#session-name").innerText=c.session_name,d.querySelector("#time").innerText=f(c.time,!0,!0,!0),d.querySelector("#duration").innerText=D(c.duration),d.querySelector("#gym_location").innerText=c.location,d.querySelector("#session-capacity").innerText=`${c.users.length}/${c.capacity}`,d.querySelector("#current-time").innerText=f(new Date().getTime(),!0);let h=d.querySelector("#confirm-start-session-popout-btn");h.onclick=()=>E(this,null,function*(){h.disabled=!0;let x={},A=yield R(P+c.id,"POST",x,s);if(A.isFetchOk!==void 0&&!A.isFetchOk){let B=d.querySelector("#warning_block");B.innerText=A.message,B.style.display="flex",h.disabled=!1;return}S(`${C}?session=${c.id}`)})}),_.style.display="flex",i.prepend(_)})}l(a),U({TriggerBtn:"close-cancel-session-modal-btn",_modalWindow:"confirm-session-popout"},()=>{let N=document.getElementById("confirm-session-popout").querySelector("#warning_block");N.style.display="none"}),n.style.display="none"})}})();var q=K||[];q.push(function(){$(document).off("submit"),$("form").on("submit",function(t){return E(this,null,function*(){t.preventDefault()})})});
