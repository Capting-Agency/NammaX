var E=(e,o,t)=>new Promise((_,l)=>{var s=n=>{try{a(t.next(n))}catch(r){l(r)}},i=n=>{try{a(t.throw(n))}catch(r){l(r)}},a=n=>n.done?_(n.value):Promise.resolve(n.value).then(s,i);a((t=t.apply(e,o)).next())});function R(e,o="GET",t=!1,_=!1,l=!1,s=!0){try{let i={"Content-Type":"application/json"};l&&(i={}),_&&(i.Authorization=`Bearer ${_}`);let a={method:o,headers:i};return t&&(s?a.body=JSON.stringify(t):a.body=t),fetch(e,a).then(n=>n.ok?n.json():n.json().then(r=>(Promise.reject(r.message),{isFetchOk:!1,status:n.status,message:r.message,payload:r&&r.payload?r.payload:null}))).then(n=>n).catch(n=>(console.error("Error in fetch",n),n))}catch(i){return console.error("Error!: "+i),i}}function M(e=null,o="nammax_auth",t=60*60*24){e&&(document.cookie=`${o}=${e}; path=/; max-age=${t}`)}function I(e="nammax_auth"){let t=`; ${document.cookie}`.split(`; ${e}=`);return t.length===2?t.pop().split(";").shift():null}function f(e="/",o=2e3){setTimeout(()=>{window.location.href=e},o)}function S(e=null,o=!1,t=!1,_=!1){if(e==null)return"NaN";let l=new Date,s=new Date(e),i=s.getHours(),a="";if(_||(a=i>=12?"PM":"AM",i=i%12||12),o){let n=s.getMinutes();return n=n<10?`0${n}`:n,t?`${l.getDate()===s.getDate()?"Today":l.getDate()+1===s.getDate()?"Tomorrow":l.getDate()+2===s.getDate()?"Day After Tomorrow":""} ${i}:${n} ${a}`:`${i}:${n} ${a}`}else return t?`${l.getDate()===s.getDate()?"Today":l.getDate()+1===s.getDate()?"Tomorrow":l.getDate()+2===s.getDate()?"Day After Tomorrow":""} ${i} ${a}`:`${i} ${a}`}function y(e=null){if(e==null)return"NaN";e=e*60;let o=`${e/60^0}`.slice(-2),t=("0"+e%60).slice(-2);return o!="0"?t!="00"?`${o} HR ${t} M`:o+" HR":t+" Mins"}function b(e,o=null){if(e!=null){var t,_=e.options.length-1;for(t=_;t>=0;t--)t!==o&&e.remove(t)}}function k(e="/sign-in"){window.localStorage.removeItem("auth"),f(`${e}`)}function g(e=!0,o="current-time"){let t=document.getElementById(o);t&&e?(t.innerText=`${new Date().toLocaleDateString("en-us",{weekday:"short",month:"short",day:"numeric"})} | ${S(new Date,!0)}`,setTimeout(()=>g(e,o),2e4)):t&&!e&&(t.innerText=S(new Date,!0),setTimeout(()=>g(e,o),2e4))}function X(){let e=document.getElementById("loading-screen");e?e.remove():console.log("did not find loading screen")}function D({single:e=!0,baseElement:o="",TriggerBtn:t="jsModalOpen",_modalWindow:_="jsModal"},l){if(e){var s=o.querySelector("#"+t);s.onclick=function(){var n=document.getElementById(_);l&&l(),n.classList?n.classList.add("open"):n.className+=" open"}}else for(var i=document.getElementsByClassName(t),a=0;a<i.length;a++)i[a].onclick=function(){var n=this.getAttribute("href").substr(1),r=document.getElementById(n);r.classList?r.classList.add("open"):r.className+=" open"}}function T({TriggerBtn:e="jsModalClose",_modalWindow:o="jsModal"},t){var _=document.getElementById(e),l=document.getElementById(o);_.onclick=function(){l.classList?l.classList.remove("open"):l.className=l.className.replace(new RegExp("(^|\\b)"+"open".split(" ").join("|")+"(\\b|$)","gi")," ")},t&&t()}function v({_modalWindow:e="jsModal"},o){var t=document.getElementById(e);function _(){t.classList?t.classList.add("open"):t.className+=" open",o&&o()}_()}function U({_modalWindow:e},o){var t=document.getElementById(e);function _(){t.classList?t.classList.remove("open"):t.className=t.className.replace(new RegExp("(^|\\b)"+"open".split(" ").join("|")+"(\\b|$)","gi")," "),o&&o()}_()}var H=Webflow||[];var L="/coach/sign-in";var w="/coach/session-details/";var K="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/coach/sessions/start_session/",P="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/coach/dashboard/",G="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/coach/all_gyms";(()=>{let e=[];window.onload=function(){let s=document.getElementById("navbar-logout-btn");s&&(s.onclick=()=>{k("/coach/sign-in")});let i=I();i?(g(),o(i),X()):f(`${L}?reason=NOT_SIGNED_IN`)};function o(s,i=!1){return E(this,null,function*(){let a=I("nammaxCoachSelectedGym");if(!a||i){v({_modalWindow:"gym-select-popout"});let n;if(e.length===0?n=yield R(G,"GET",!1,s):n=e,n.isFetchOk!==void 0&&!n.isFetchOk){console.error(n.message),f(`${L}?reason=NOT_SIGNED_IN`);return}e=n;let r=document.getElementById("gym-select-popout"),p=r.querySelector("#coach-gym-select"),N=r.querySelector("#confirm-gym-select-btn");if(i){let u=r.querySelector("#cancel-gym-select-btn");u.onclick=()=>{U({_modalWindow:"gym-select-popout"})},u.classList.remove("hide")}b(p),n.forEach((u,c)=>{var m=document.createElement("option");m.value=u.id,m.innerText=u.location,c===0&&(m.selected=!0),a==u.id&&(m.selected=!0),p.appendChild(m)}),N.onclick=()=>{let u=p.value;t(u,s),U({_modalWindow:"gym-select-popout"},()=>{M(u,"nammaxCoachSelectedGym")})}}else t(a,s)})}function t(s,i){return E(this,null,function*(){let a=yield R(P+s,"GET",!1,i);if(a.isFetchOk!==void 0&&!a.isFetchOk){console.error(a.message);return}let{coach:n,sessions:r}=a;document.getElementById("user-name").innerText="Coach "+n.name,document.getElementById("location-map-name").innerText=n.location,r.forEach(p=>{if(p.status==="IN PROGRESS"&&p.coach.status==="IN SESSION"&&p.team_id===n.id){f(`${w}?session=${p.id}`);return}}),_(i),l(i,r)})}function _(s){D({_modalWindow:"gym-select-popout",TriggerBtn:"location-map-change-btn",baseElement:document.getElementById("location-map-container")},()=>{o(s,!0)}),T({_modalWindow:"gym-select-popout",TriggerBtn:"cancel-gym-select-btn"})}function l(s,i){return E(this,null,function*(){let a=document.getElementById("view-coach-sessions-container"),n=a.querySelector("#view-coach-sessions-item");function r(p){let N=a.querySelectorAll(".session-details-w.card-item");N.forEach((c,m)=>{m!==N.length-1&&c.remove()});let u=a.querySelector("#no-sessions-found");p.length===0?u.style.display="flex":u.style.display="none",p.forEach(c=>{let m=n.cloneNode(!0);m.setAttribute("id",""),m.querySelector("#session-name").innerText=c.session_name,m.querySelector("#time").innerText=S(c.time,!0,!0,!0),m.querySelector("#duration").innerText=y(c.duration),m.querySelector("#session-slot-bar").style.width=c.users.length/c.capacity*100+"%",m.querySelector("#session-capacity").innerText=`${c.users.length}/${c.capacity}`;let W=m.querySelector("#start-session-btn"),h=m.querySelector("#start-session-btn").querySelector("span");function C(){let d=new Date().getHours()-new Date(c.time).getHours(),A=new Date().getMinutes()-new Date(c.time).getMinutes(),x=Math.abs(A);x>15?(W.innerText="MISSED SESSION!",h.innerText=""):d<=0&&x<=15?A>0?h.innerText=`OVERDUE BY ${x} MINUTE(S)`:A===0?h.innerText="NOW":h.innerText=`STARTS IN ${x} MINUTE(S)`:h.innerText="",setTimeout(()=>{C()},2e4)}C(),D({baseElement:m,TriggerBtn:"start-session-btn",_modalWindow:"confirm-session-popout"},()=>{let d=document.getElementById("confirm-session-popout");d.querySelector("#session-name").innerText=c.session_name,d.querySelector("#time").innerText=S(c.time,!0,!0,!0),d.querySelector("#duration").innerText=y(c.duration),d.querySelector("#gym_location").innerText=c.location,d.querySelector("#session-capacity").innerText=`${c.users.length}/${c.capacity}`,d.querySelector("#current-time").innerText=S(new Date,!0);let A=d.querySelector("#confirm-start-session-popout-btn");A.onclick=()=>E(this,null,function*(){A.disabled=!0;let x={},O=yield R(K+c.id,"POST",x,s);if(O.isFetchOk!==void 0&&!O.isFetchOk){let B=d.querySelector("#warning_block");B.innerText=O.message,B.style.display="flex",A.disabled=!1;return}f(`${w}?session=${c.id}`)})}),m.style.display="flex",a.prepend(m)})}r(i),T({TriggerBtn:"close-cancel-session-modal-btn",_modalWindow:"confirm-session-popout"},()=>{let N=document.getElementById("confirm-session-popout").querySelector("#warning_block");N.style.display="none"}),n.style.display="none"})}})();var F=H||[];F.push(function(){$(document).off("submit"),$("form").on("submit",function(e){return E(this,null,function*(){e.preventDefault()})})});
