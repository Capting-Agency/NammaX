var E=(e,o,t)=>new Promise((r,m)=>{var s=n=>{try{i(t.next(n))}catch(l){m(l)}},a=n=>{try{i(t.throw(n))}catch(l){m(l)}},i=n=>n.done?r(n.value):Promise.resolve(n.value).then(s,a);i((t=t.apply(e,o)).next())});function O(e,o="GET",t=!1,r=!1,m=!1,s=!0){try{let a={"Content-Type":"application/json"};m&&(a={}),r&&(a.Authorization=`Bearer ${r}`);let i={method:o,headers:a};return t&&(s?i.body=JSON.stringify(t):i.body=t),fetch(e,i).then(n=>n.ok?n.json():n.json().then(l=>(Promise.reject(l.message),{isFetchOk:!1,status:n.status,message:l.message,payload:l&&l.payload?l.payload:null}))).then(n=>n).catch(n=>(console.error("Error in fetch",n),n))}catch(a){return console.error("Error!: "+a),a}}function M(e=null,o="nammax_auth",t=60*60*24){e&&(document.cookie=`${o}=${e}; path=/; max-age=${t}`)}function I(e="nammax_auth"){let t=`; ${document.cookie}`.split(`; ${e}=`);return t.length===2?t.pop().split(";").shift():null}function S(e="/",o=2e3){setTimeout(()=>{window.location.href=e},o)}function f(e=null,o=!1,t=!1,r=!1){if(e==null)return"NaN";let m=new Date,s=new Date(e),a=s.getHours(),i="";if(r||(i=a>=12?"PM":"AM",a=a%12||12),o){let n=s.getMinutes();return n=n<10?`0${n}`:n,t?`${m.getDate()===s.getDate()?"Today":m.getDate()+1===s.getDate()?"Tomorrow":m.getDate()+2===s.getDate()?"Day After Tomorrow":""} ${a}:${n} ${i}`:`${a}:${n} ${i}`}else return t?`${m.getDate()===s.getDate()?"Today":m.getDate()+1===s.getDate()?"Tomorrow":m.getDate()+2===s.getDate()?"Day After Tomorrow":""} ${a} ${i}`:`${a} ${i}`}function y(e=null){if(e==null)return"NaN";e=e*60;let o=`${e/60^0}`.slice(-2),t=("0"+e%60).slice(-2);return o!="0"?t!="00"?`${o} HR ${t} M`:o+" HR":t+" Mins"}function b(e,o=null){if(e!=null){var t,r=e.options.length-1;for(t=r;t>=0;t--)t!==o&&e.remove(t)}}function k(e="/sign-in"){window.localStorage.removeItem("auth"),S(`${e}`)}function R(e=!1,o=!0,t="current-time"){let r=document.getElementById(t);r&&o?(r.innerText=`${new Date().toLocaleDateString("en-us",{weekday:"short",month:"short",day:"numeric"})} | ${f(new Date,!0,!1,e)}`,setTimeout(()=>R(e,o,t),2e4)):r&&!o&&(r.innerText=f(new Date,!0,!1,e),setTimeout(()=>R(e,o,t),2e4))}function X(){let e=document.getElementById("loading-screen");e?e.remove():console.log("did not find loading screen")}function D({single:e=!0,baseElement:o="",TriggerBtn:t="jsModalOpen",_modalWindow:r="jsModal"},m){if(e){var s=o.querySelector("#"+t);s.onclick=function(){var n=document.getElementById(r);m&&m(),n.classList?n.classList.add("open"):n.className+=" open"}}else for(var a=document.getElementsByClassName(t),i=0;i<a.length;i++)a[i].onclick=function(){var n=this.getAttribute("href").substr(1),l=document.getElementById(n);l.classList?l.classList.add("open"):l.className+=" open"}}function T({TriggerBtn:e="jsModalClose",_modalWindow:o="jsModal"},t){var r=document.getElementById(e),m=document.getElementById(o);r.onclick=function(){m.classList?m.classList.remove("open"):m.className=m.className.replace(new RegExp("(^|\\b)"+"open".split(" ").join("|")+"(\\b|$)","gi")," ")},t&&t()}function v({_modalWindow:e="jsModal"},o){var t=document.getElementById(e);function r(){t.classList?t.classList.add("open"):t.className+=" open",o&&o()}r()}function U({_modalWindow:e},o){var t=document.getElementById(e);function r(){t.classList?t.classList.remove("open"):t.className=t.className.replace(new RegExp("(^|\\b)"+"open".split(" ").join("|")+"(\\b|$)","gi")," "),o&&o()}r()}var H=Webflow||[];var w="/coach/sign-in";var L="/coach/session-details/";var K="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/coach/sessions/start_session/",P="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/coach/dashboard/",G="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/coach/all_gyms";(()=>{let e=[];window.onload=function(){let s=document.getElementById("navbar-logout-btn");s&&(s.onclick=()=>{k("/coach/sign-in")});let a=I();a?(R(!0),o(a),X()):S(`${w}?reason=NOT_SIGNED_IN`)};function o(s,a=!1){return E(this,null,function*(){let i=I("nammaxCoachSelectedGym");if(!i||a){v({_modalWindow:"gym-select-popout"});let n;if(e.length===0?n=yield O(G,"GET",!1,s):n=e,n.isFetchOk!==void 0&&!n.isFetchOk){console.error(n.message),S(`${w}?reason=NOT_SIGNED_IN`);return}e=n;let l=document.getElementById("gym-select-popout"),p=l.querySelector("#coach-gym-select"),x=l.querySelector("#confirm-gym-select-btn");if(a){let u=l.querySelector("#cancel-gym-select-btn");u.onclick=()=>{U({_modalWindow:"gym-select-popout"})},u.classList.remove("hide")}b(p),n.forEach((u,c)=>{var _=document.createElement("option");_.value=u.id,_.innerText=u.location,c===0&&(_.selected=!0),i==u.id&&(_.selected=!0),p.appendChild(_)}),x.onclick=()=>{let u=p.value;t(u,s),U({_modalWindow:"gym-select-popout"},()=>{M(u,"nammaxCoachSelectedGym")})}}else t(i,s)})}function t(s,a){return E(this,null,function*(){let i=yield O(P+s,"GET",!1,a);if(i.isFetchOk!==void 0&&!i.isFetchOk){console.error(i.message);return}let{coach:n,sessions:l}=i;n.profile_picture.url&&(document.getElementById("profile-avatar").style.backgroundImage=`url(${n.profile_picture.url})`),document.getElementById("user-name").innerText="Coach "+n.name,document.getElementById("location-map-name").innerText=n.location,l.forEach(p=>{if(p.status==="IN PROGRESS"&&p.coach.status==="IN SESSION"&&p.team_id===n.id){S(`${L}?session=${p.id}`);return}}),r(a),m(a,l)})}function r(s){D({_modalWindow:"gym-select-popout",TriggerBtn:"location-map-change-btn",baseElement:document.getElementById("location-map-container")},()=>{o(s,!0)}),T({_modalWindow:"gym-select-popout",TriggerBtn:"cancel-gym-select-btn"})}function m(s,a){return E(this,null,function*(){let i=document.getElementById("view-coach-sessions-container"),n=i.querySelector("#view-coach-sessions-item");function l(p){let x=i.querySelectorAll(".session-details-w.card-item");x.forEach((c,_)=>{_!==x.length-1&&c.remove()});let u=i.querySelector("#no-sessions-found");p.length===0?u.style.display="flex":u.style.display="none",p.forEach(c=>{let _=n.cloneNode(!0);_.setAttribute("id",""),_.querySelector("#session-name").innerText=c.session_name,_.querySelector("#time").innerText=f(c.time,!0,!0,!0),_.querySelector("#duration").innerText=y(c.duration),_.querySelector("#session-slot-bar").style.width=c.users.length/c.capacity*100+"%",_.querySelector("#session-capacity").innerText=`${c.users.length}/${c.capacity}`;let W=_.querySelector("#start-session-btn"),g=_.querySelector("#start-session-btn").querySelector("span");function C(){let d=new Date().getDate()-new Date(c.time).getDate(),h=new Date().getHours()-new Date(c.time).getHours(),N=new Date().getMinutes()-new Date(c.time).getMinutes(),A=Math.abs(N);N<-15&&d===0?(W.innerText="MISSED SESSION!",g.innerText=""):h===0&&A<=15?N>0?g.innerText=`OVERDUE BY ${A} MINUTE(S)`:N===0?g.innerText="NOW":g.innerText=`STARTS IN ${A} MINUTE(S)`:g.innerText="",setTimeout(()=>{C()},2e4)}C(),D({baseElement:_,TriggerBtn:"start-session-btn",_modalWindow:"confirm-session-popout"},()=>{let d=document.getElementById("confirm-session-popout");d.querySelector("#session-name").innerText=c.session_name,d.querySelector("#time").innerText=f(c.time,!0,!0,!0),d.querySelector("#duration").innerText=y(c.duration),d.querySelector("#gym_location").innerText=c.location,d.querySelector("#session-capacity").innerText=`${c.users.length}/${c.capacity}`,d.querySelector("#current-time").innerText=f(new Date,!0);let h=d.querySelector("#confirm-start-session-popout-btn");h.onclick=()=>E(this,null,function*(){h.disabled=!0;let N={},A=yield O(K+c.id,"POST",N,s);if(A.isFetchOk!==void 0&&!A.isFetchOk){let B=d.querySelector("#warning_block");B.innerText=A.message,B.style.display="flex",h.disabled=!1;return}S(`${L}?session=${c.id}`)})}),_.style.display="flex",i.prepend(_)})}l(a),T({TriggerBtn:"close-cancel-session-modal-btn",_modalWindow:"confirm-session-popout"},()=>{let x=document.getElementById("confirm-session-popout").querySelector("#warning_block");x.style.display="none"}),n.style.display="none"})}})();var F=H||[];F.push(function(){$(document).off("submit"),$("form").on("submit",function(e){return E(this,null,function*(){e.preventDefault()})})});
