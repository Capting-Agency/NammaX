var N=(e,o,t)=>new Promise((r,_)=>{var i=n=>{try{a(t.next(n))}catch(l){_(l)}},s=n=>{try{a(t.throw(n))}catch(l){_(l)}},a=n=>n.done?r(n.value):Promise.resolve(n.value).then(i,s);a((t=t.apply(e,o)).next())});function h(e,o="GET",t=!1,r=!1,_=!1,i=!0){try{let s={"Content-Type":"application/json"};_&&(s={}),r&&(s.Authorization=`Bearer ${r}`);let a={method:o,headers:s};return t&&(i?a.body=JSON.stringify(t):a.body=t),fetch(e,a).then(n=>n.ok?n.json():n.json().then(l=>(Promise.reject(l.message),{isFetchOk:!1,status:n.status,message:l.message,payload:l&&l.payload?l.payload:null}))).then(n=>n).catch(n=>(console.error("Error in fetch",n),n))}catch(s){return console.error("Error!: "+s),s}}function D(e=null,o="nammax_auth",t=60*60*24){e&&(document.cookie=`${o}=${e}; path=/; max-age=${t}`)}function R(e="nammax_auth"){let t=`; ${document.cookie}`.split(`; ${e}=`);return t.length===2?t.pop().split(";").shift():null}function x(e="/",o=0){setTimeout(()=>{window.location.href=e},o)}function E(e=null,o=!1){if(e==null)return"NaN";var t=new Date(e),r=t.getHours(),_=r>=12?"PM":"AM";if(r=r%12||12,o){var i=t.getMinutes();return i=i<10?`0${i}`:i,`${r}:${i} ${_}`}else return`${r} ${_}`}function g(e=null){if(e==null)return"NaN";e=e*60;let o=`${e/60^0}`.slice(-2),t=("0"+e%60).slice(-2);return o!="0"?t!="00"?`${o} HR ${t} M`:o+" HR":t+" Mins"}function C(e,o=null){if(e!=null){var t,r=e.options.length-1;for(t=r;t>=0;t--)t!==o&&e.remove(t)}}function B(e="/sign-in"){window.localStorage.removeItem("auth"),x(`${e}`)}function O(e="current-time"){let o=document.getElementById(e);o&&(o.innerText=E(new Date,!0)),setTimeout(()=>O(e),3e4)}function I({single:e=!0,baseElement:o="",TriggerBtn:t="jsModalOpen",_modalWindow:r="jsModal"},_){if(e){var i=o.querySelector("#"+t);i.onclick=function(){var n=document.getElementById(r);_&&_(),n.classList?n.classList.add("open"):n.className+=" open"}}else for(var s=document.getElementsByClassName(t),a=0;a<s.length;a++)s[a].onclick=function(){var n=this.getAttribute("href").substr(1),l=document.getElementById(n);l.classList?l.classList.add("open"):l.className+=" open"}}function y({TriggerBtn:e="jsModalClose",_modalWindow:o="jsModal"},t){var r=document.getElementById(e),_=document.getElementById(o);r.onclick=function(){_.classList?_.classList.remove("open"):_.className=_.className.replace(new RegExp("(^|\\b)"+"open".split(" ").join("|")+"(\\b|$)","gi")," ")},t&&t()}function M({_modalWindow:e="jsModal"},o){var t=document.getElementById(e);function r(){t.classList?t.classList.add("open"):t.className+=" open",o&&o()}r()}function U({_modalWindow:e},o){var t=document.getElementById(e);function r(){t.classList?t.classList.remove("open"):t.className=t.className.replace(new RegExp("(^|\\b)"+"open".split(" ").join("|")+"(\\b|$)","gi")," "),o&&o()}r()}var b=Webflow||[];var L="/coach/sign-in";var T="/coach/session-details/";var k="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/coach/sessions/start_session/",X="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/coach/dashboard/",v="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/coach/all_gyms";(()=>{let e=[];window.onload=function(){let i=document.getElementById("navbar-logout-btn");i&&(i.onclick=()=>{B("/coach/sign-in")});let s=R();s?(O(),o(s)):x(`${L}?reason=NOT_SIGNED_IN`)};function o(i,s=!1){return N(this,null,function*(){let a=R("nammaxCoachSelectedGym");if(!a||s){M({_modalWindow:"gym-select-popout"});let n;if(e.length===0?n=yield h(v,"GET",!1,i):n=e,n.isFetchOk!==void 0&&!n.isFetchOk){console.error(n.message),x(`${L}?reason=NOT_SIGNED_IN`);return}e=n;let l=document.getElementById("gym-select-popout"),p=l.querySelector("#coach-gym-select"),A=l.querySelector("#confirm-gym-select-btn");if(s){let d=l.querySelector("#cancel-gym-select-btn");d.onclick=()=>{U({_modalWindow:"gym-select-popout"})},d.classList.remove("hide")}C(p),n.forEach((d,c)=>{var m=document.createElement("option");m.value=d.id,m.innerText=d.location,c===0&&(m.selected=!0),a==d.id&&(m.selected=!0),p.appendChild(m)}),A.onclick=()=>{let d=p.value;t(d,i),U({_modalWindow:"gym-select-popout"},()=>{D(d,"nammaxCoachSelectedGym")})}}else t(a,i)})}function t(i,s){return N(this,null,function*(){let a=yield h(X+i,"GET",!1,s);if(a.isFetchOk!==void 0&&!a.isFetchOk){console.error(a.message);return}let{coach:n,sessions:l}=a;document.getElementById("user-name").innerText="Coach "+n.name,document.getElementById("location-map-name").innerText=n.location,l.forEach(p=>{if(p.status==="IN PROGRESS"&&p.coach.status==="IN SESSION"&&p.team_id===n.id){x(`${T}?session=${p.id}`);return}}),r(s),_(s,l)})}function r(i){I({_modalWindow:"gym-select-popout",TriggerBtn:"location-map-change-btn",baseElement:document.getElementById("location-map-container")},()=>{o(i,!0)}),y({_modalWindow:"gym-select-popout",TriggerBtn:"cancel-gym-select-btn"})}function _(i,s){return N(this,null,function*(){let a=document.getElementById("view-coach-sessions-container"),n=a.querySelector("#view-coach-sessions-item");function l(p){let A=a.querySelectorAll(".session-details-w.card-item");A.forEach((c,m)=>{m!==A.length-1&&c.remove()});let d=a.querySelector("#no-sessions-found");p.length===0?d.style.display="flex":d.style.display="none",p.forEach(c=>{let m=n.cloneNode(!0);m.setAttribute("id",""),m.querySelector("#session-name").innerText=c.session_name,m.querySelector("#time").innerText=E(c.time,!0),m.querySelector("#duration").innerText=g(c.duration),m.querySelector("#session-slot-bar").style.width=c.users.length/c.capacity*100+"%",m.querySelector("#session-capacity").innerText=`${c.users.length}/${c.capacity}`,I({baseElement:m,TriggerBtn:"start-session-btn",_modalWindow:"confirm-session-popout"},()=>{let u=document.getElementById("confirm-session-popout");u.querySelector("#session-name").innerText=c.session_name,u.querySelector("#time").innerText=E(c.time,!0),u.querySelector("#duration").innerText=g(c.duration),u.querySelector("#gym_location").innerText=c.location,u.querySelector("#session-capacity").innerText=`${c.users.length}/${c.capacity}`,u.querySelector("#current-time").innerText=E(new Date,!0);let S=u.querySelector("#confirm-start-session-popout-btn");S.onclick=()=>N(this,null,function*(){S.disabled=!0;let H={},f=yield h(k+c.id,"POST",H,i);if(f.isFetchOk!==void 0&&!f.isFetchOk){let w=u.querySelector("#warning_block");w.innerText=f.message,w.style.display="flex",S.disabled=!1;return}x(`${T}?session=${c.id}`)})}),m.style.display="flex",a.prepend(m)})}l(s),y({TriggerBtn:"close-cancel-session-modal-btn",_modalWindow:"confirm-session-popout"},()=>{let A=document.getElementById("confirm-session-popout").querySelector("#warning_block");A.style.display="none"}),n.style.display="none"})}})();var K=b||[];K.push(function(){$(document).off("submit"),$("form").on("submit",function(e){return N(this,null,function*(){e.preventDefault()})})});
