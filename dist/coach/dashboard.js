var m=(e,o,t)=>new Promise((a,s)=>{var r=n=>{try{l(t.next(n))}catch(i){s(i)}},c=n=>{try{l(t.throw(n))}catch(i){s(i)}},l=n=>n.done?a(n.value):Promise.resolve(n.value).then(r,c);l((t=t.apply(e,o)).next())});function u(e,o="GET",t=!1,a=!1,s=!1,r=!0){try{let c={"Content-Type":"application/json"};s&&(c={}),a&&(c.Authorization=`Bearer ${a}`);let l={method:o,headers:c};return t&&(r?l.body=JSON.stringify(t):l.body=t),fetch(e,l).then(n=>n.ok?n.json():n.json().then(i=>(Promise.reject(i.message),{isFetchOk:!1,status:n.status,message:i.message,payload:i&&i.payload?i.payload:null}))).then(n=>n).catch(n=>(console.error("Error in fetch",n),n))}catch(c){return console.error("Error!: "+c),c}}function y(e=null,o="nammax_auth",t=60*60*24){e&&(document.cookie=`${o}=${e}; path=/; max-age=${t}`)}function N(e="nammax_auth"){let t=`; ${document.cookie}`.split(`; ${e}=`);return t.length===2?t.pop().split(";").shift():null}function p(e="/",o=0){setTimeout(()=>{window.location.href=e},o)}function d(e=null,o=!1){if(e==null)return"NaN";var t=new Date(e),a=t.getHours(),s=a>=12?"PM":"AM";if(a=a%12||12,o){var r=t.getMinutes();return r=r<10?`0${r}`:r,`${a}:${r} ${s}`}else return`${a} ${s}`}function x(e=null){if(e==null)return"NaN";e=e*60;let o=`${e/60^0}`.slice(-2),t=("0"+e%60).slice(-2);return o!="0"?t!="00"?`${o} HR ${t} M`:o+" HR":t+" Mins"}function U(e,o=null){if(e!=null){var t,a=e.options.length-1;for(t=a;t>=0;t--)t!==o&&e.remove(t)}}function L(e="/sign-in"){window.localStorage.removeItem("auth"),p(`${e}`)}function E(e="current-time"){let o=document.getElementById(e);o&&(o.innerText=d(new Date,!0)),setTimeout(()=>E(e),3e4)}function h({single:e=!0,baseElement:o="",TriggerBtn:t="jsModalOpen",_modalWindow:a="jsModal"},s){if(e){var r=o.querySelector("#"+t);r.onclick=function(){var n=document.getElementById(a);s&&s(),n.classList?n.classList.add("open"):n.className+=" open"}}else for(var c=document.getElementsByClassName(t),l=0;l<c.length;l++)c[l].onclick=function(){var n=this.getAttribute("href").substr(1),i=document.getElementById(n);i.classList?i.classList.add("open"):i.className+=" open"}}function S({TriggerBtn:e="jsModalClose",_modalWindow:o="jsModal"},t){var a=document.getElementById(e),s=document.getElementById(o);a.onclick=function(){s.classList?s.classList.remove("open"):s.className=s.className.replace(new RegExp("(^|\\b)"+"open".split(" ").join("|")+"(\\b|$)","gi")," ")},t&&t()}function T({_modalWindow:e="jsModal"},o){var t=document.getElementById(e);function a(){t.classList?t.classList.add("open"):t.className+=" open",o&&o()}a()}function f({_modalWindow:e},o){var t=document.getElementById(e);function a(){t.classList?t.classList.remove("open"):t.className=t.className.replace(new RegExp("(^|\\b)"+"open".split(" ").join("|")+"(\\b|$)","gi")," "),o&&o()}a()}var R="/coach/sign-in";var g="/coach/session-details/";var w="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/coach/sessions/start_session/",D="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/coach/dashboard/",C="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/coach/all_gyms";var O=[];window.onload=function(){let e=document.getElementById("navbar-logout-btn");e&&(e.onclick=()=>{L("/coach/sign-in")});let o=N();o?(E(),M(o)):p(`${R}?reason=NOT_SIGNED_IN`)};function M(e,o=!1){return m(this,null,function*(){let t=N("nammaxCoachSelectedGym");if(!t||o){T({_modalWindow:"gym-select-popout"});let a;if(O.length===0?a=yield u(C,"GET",!1,e):a=O,a.isFetchOk!==void 0&&!a.isFetchOk){console.error(a.message),p(`${R}?reason=NOT_SIGNED_IN`);return}O=a;let s=document.getElementById("gym-select-popout"),r=s.querySelector("#coach-gym-select"),c=s.querySelector("#confirm-gym-select-btn");if(o){let l=s.querySelector("#cancel-gym-select-btn");l.onclick=()=>{f({_modalWindow:"gym-select-popout"})},l.classList.remove("hide")}U(r),a.forEach((l,n)=>{var i=document.createElement("option");i.value=l.id,i.innerText=l.location,n===0&&(i.selected=!0),t==l.id&&(i.selected=!0),r.appendChild(i)}),c.onclick=()=>{let l=r.value;B(l,e),f({_modalWindow:"gym-select-popout"},()=>{y(l,"nammaxCoachSelectedGym")})}}else B(t,e)})}function B(e,o){return m(this,null,function*(){let t=yield u(D+e,"GET",!1,o);if(t.isFetchOk!==void 0&&!t.isFetchOk){console.error(t.message);return}let{coach:a,sessions:s}=t;document.getElementById("user-name").innerText="Coach "+a.name,document.getElementById("location-map-name").innerText=a.location,s.forEach(r=>{if(r.status==="IN PROGRESS"&&r.coach.status==="IN SESSION"&&r.team_id===a.id){p(`${g}?session=${r.id}`);return}}),v(o),H(o,s)})}function v(e){h({_modalWindow:"gym-select-popout",TriggerBtn:"location-map-change-btn",baseElement:document.getElementById("location-map-container")},()=>{M(e,!0)}),S({_modalWindow:"gym-select-popout",TriggerBtn:"cancel-gym-select-btn"})}function H(e,o){return m(this,null,function*(){let t=document.getElementById("view-coach-sessions-container"),a=t.querySelector("#view-coach-sessions-item");function s(r){let c=t.querySelectorAll(".session-details-w.card-item");c.forEach((n,i)=>{i!==c.length-1&&n.remove()});let l=t.querySelector("#no-sessions-found");r.length===0?l.style.display="flex":l.style.display="none",r.forEach(n=>{let i=a.cloneNode(!0);i.setAttribute("id",""),i.querySelector("#session-name").innerText=n.session_name,i.querySelector("#time").innerText=d(n.time,!0),i.querySelector("#duration").innerText=x(n.duration),i.querySelector("#session-slot-bar").style.width=n.users.length/n.capacity*100+"%",i.querySelector("#session-capacity").innerText=`${n.users.length}/${n.capacity}`,h({baseElement:i,TriggerBtn:"start-session-btn",_modalWindow:"confirm-session-popout"},()=>{let _=document.getElementById("confirm-session-popout");_.querySelector("#session-name").innerText=n.session_name,_.querySelector("#time").innerText=d(n.time,!0),_.querySelector("#duration").innerText=x(n.duration),_.querySelector("#gym_location").innerText=n.location,_.querySelector("#session-capacity").innerText=`${n.users.length}/${n.capacity}`,_.querySelector("#current-time").innerText=d(new Date,!0);let k=_.querySelector("#confirm-start-session-popout-btn");k.onclick=()=>m(this,null,function*(){let X={},A=yield u(w+n.id,"POST",X,e);if(A.isFetchOk!==void 0&&!A.isFetchOk){let I=_.querySelector("#warning_block");I.innerText=A.message,I.style.display="flex";return}p(`${g}?session=${n.id}`)})}),i.style.display="flex",t.prepend(i)})}s(o),S({TriggerBtn:"close-cancel-session-modal-btn",_modalWindow:"confirm-session-popout"},()=>{let c=document.getElementById("confirm-session-popout").querySelector("#warning_block");c.style.display="none"}),a.style.display="none"})}var b=b||[];b.push(function(){$(document).off("submit"),$("form").on("submit",function(e){return m(this,null,function*(){e.preventDefault()})})});
