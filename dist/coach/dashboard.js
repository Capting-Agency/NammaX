var f=(e,n,t)=>new Promise((r,m)=>{var i=o=>{try{a(t.next(o))}catch(c){m(c)}},s=o=>{try{a(t.throw(o))}catch(c){m(c)}},a=o=>o.done?r(o.value):Promise.resolve(o.value).then(i,s);a((t=t.apply(e,n)).next())});function R(e,n="GET",t=!1,r=!1,m=!1,i=!0){try{let s={"Content-Type":"application/json"};m&&(s={}),r&&(s.Authorization=`Bearer ${r}`);let a={method:n,headers:s};return t&&(i?a.body=JSON.stringify(t):a.body=t),fetch(e,a).then(o=>o.ok?o.json():o.json().then(c=>(Promise.reject(c.message),{isFetchOk:!1,status:o.status,message:c.message,payload:c&&c.payload?c.payload:null}))).then(o=>o).catch(o=>(console.error("Error in fetch",o),o))}catch(s){return console.error("Error!: "+s),s}}function w(e=null,n="nammax_auth",t=60*60*24){e&&(document.cookie=`${n}=${e}; path=/; max-age=${t}`)}function y(e="nammax_auth"){let t=`; ${document.cookie}`.split(`; ${e}=`);return t.length===2?t.pop().split(";").shift():null}function S(e="/",n=2e3){setTimeout(()=>{window.location.href=e},n)}function E(e=null,n=!1,t=!1,r=!1){if(e==null)return"NaN";let m=new Date,i=new Date(e),s=i.getHours(),a="";if(r||(a=s>=12?"PM":"AM",s=s%12||12),n){let o=i.getMinutes();return o=o<10?`0${o}`:o,t?`${m.getDate()===i.getDate()?"Today":m.getDate()+1===i.getDate()?"Tomorrow":m.getDate()+2===i.getDate()?"Day After Tomorrow":I(e)} ${s}:${o} ${a}`:`${s}:${o} ${a}`}else return t?`${m.getDate()===i.getDate()?"Today":m.getDate()+1===i.getDate()?"Tomorrow":m.getDate()+2===i.getDate()?"Day After Tomorrow":I(e)} ${s} ${a}`:`${I(e)} ${s} ${a}`}function I(e=null){if(e==null)return"NaN";let n=new Date(e);return`${n.getDate()}/${n.getMonth()+1}/${n.getFullYear()}`}function D(e=null){if(e==null)return"NaN";e=e*60;let n=`${e/60^0}`.slice(-2),t=("0"+e%60).slice(-2);return n!="0"?t!="00"?`${n} HR ${t} M`:n+" HR":t+" Mins"}function X(e,n=null){if(e!=null){var t,r=e.options.length-1;for(t=r;t>=0;t--)t!==n&&e.remove(t)}}function j(e="/sign-in"){window.localStorage.removeItem("auth"),S(`${e}`)}function O(e=!1,n=!0,t="current-time"){let r=document.getElementById(t);r&&n?(r.innerText=`${new Date().toLocaleDateString("en-us",{weekday:"short",month:"short",day:"numeric"})} | ${E(new Date().getTime(),!0,!1,e)}`,setTimeout(()=>O(e,n,t),2e4)):r&&!n&&(r.innerText=E(new Date().getTime(),!0,!1,e),setTimeout(()=>O(e,n,t),2e4))}function v(){let e=document.getElementById("loading-screen");e?e.remove():console.log("did not find loading screen")}function T({single:e=!0,baseElement:n="",TriggerBtn:t="jsModalOpen",_modalWindow:r="jsModal"},m){if(e){var i=n.querySelector("#"+t);i.onclick=function(){var o=document.getElementById(r);m&&m(),o.classList?o.classList.add("open"):o.className+=" open"}}else for(var s=document.getElementsByClassName(t),a=0;a<s.length;a++)s[a].onclick=function(){var o=this.getAttribute("href").substr(1),c=document.getElementById(o);c.classList?c.classList.add("open"):c.className+=" open"}}function U({TriggerBtn:e="jsModalClose",_modalWindow:n="jsModal"},t){var r=document.getElementById(e),m=document.getElementById(n);r.onclick=function(){m.classList?m.classList.remove("open"):m.className=m.className.replace(new RegExp("(^|\\b)"+"open".split(" ").join("|")+"(\\b|$)","gi")," ")},t&&t()}function H({_modalWindow:e="jsModal"},n){var t=document.getElementById(e);function r(){t.classList?t.classList.add("open"):t.className+=" open",n&&n()}r()}function L({_modalWindow:e},n){var t=document.getElementById(e);function r(){t.classList?t.classList.remove("open"):t.className=t.className.replace(new RegExp("(^|\\b)"+"open".split(" ").join("|")+"(\\b|$)","gi")," "),n&&n()}r()}var z=Webflow||[];var C="/coach/sign-in";var M="/coach/session-details/";var K="https://xoxo-jnzf-s0on.m2.xano.io/api:Kml2N_BA/coach/sessions/start_session/",P="https://xoxo-jnzf-s0on.m2.xano.io/api:Kml2N_BA/coach/dashboard/",G="https://xoxo-jnzf-s0on.m2.xano.io/api:Kml2N_BA/coach/all_gyms";(()=>{let e=[];window.onload=function(){let i=document.getElementById("navbar-logout-btn");i&&(i.onclick=()=>{j("/coach/sign-in")});let s=y();s?(O(!0),n(s),v()):S(`${C}?reason=NOT_SIGNED_IN`)};function n(i,s=!1){return f(this,null,function*(){let a=y("nammaxCoachSelectedGym");if(!a||s){H({_modalWindow:"gym-select-popout"});let o;if(e.length===0?o=yield R(G,"GET",!1,i):o=e,o.isFetchOk!==void 0&&!o.isFetchOk){console.error(o.message),S(`${C}?reason=NOT_SIGNED_IN`);return}e=o;let c=document.getElementById("gym-select-popout"),p=c.querySelector("#coach-gym-select"),A=c.querySelector("#confirm-gym-select-btn");if(s){let u=c.querySelector("#cancel-gym-select-btn");u.onclick=()=>{L({_modalWindow:"gym-select-popout"})},u.classList.remove("hide")}X(p),o.forEach((u,l)=>{var _=document.createElement("option");_.value=u.id,_.innerText=u.location,l===0&&(_.selected=!0),a==u.id&&(_.selected=!0),p.appendChild(_)}),A.onclick=()=>{let u=p.value;t(u,i),L({_modalWindow:"gym-select-popout"},()=>{w(u,"nammaxCoachSelectedGym")})}}else t(a,i)})}function t(i,s){return f(this,null,function*(){let a=yield R(P+i,"GET",!1,s);if(a.isFetchOk!==void 0&&!a.isFetchOk){console.error(a.message);return}let{coach:o,sessions:c}=a;o.profile_picture.url&&(document.getElementById("profile-avatar").style.backgroundImage=`url(${o.profile_picture.url})`),document.getElementById("user-name").innerText="Coach "+o.name,document.getElementById("location-map-name").innerText=o.location,c.forEach(p=>{if(p.status==="IN PROGRESS"&&p.coach.status==="IN SESSION"&&p.team_id===o.id){S(`${M}?session=${p.id}`);return}}),r(s),m(s,c)})}function r(i){T({_modalWindow:"gym-select-popout",TriggerBtn:"location-map-change-btn",baseElement:document.getElementById("location-map-container")},()=>{n(i,!0)}),U({_modalWindow:"gym-select-popout",TriggerBtn:"cancel-gym-select-btn"})}function m(i,s){return f(this,null,function*(){let a=document.getElementById("view-coach-sessions-container"),o=a.querySelector("#view-coach-sessions-item");function c(p){let A=a.querySelectorAll(".session-details-w.card-item");A.forEach((l,_)=>{_!==A.length-1&&l.remove()});let u=a.querySelector("#no-sessions-found");p.length===0?u.style.display="flex":u.style.display="none",p.forEach(l=>{let _=o.cloneNode(!0);_.setAttribute("id",""),_.querySelector("#session-name").innerText=l.session_name,_.querySelector("#time").innerText=E(l.time,!0,!0,!0),_.querySelector("#duration").innerText=D(l.duration),_.querySelector("#session-slot-bar").style.width=l.users.length/l.capacity*100+"%",_.querySelector("#session-capacity").innerText=`${l.users.length}/${l.capacity}`;let W=_.querySelector("#start-session-btn"),g=_.querySelector("#start-session-btn").querySelector("span");function B(){let d=new Date().getDate()-new Date(l.time).getDate(),h=new Date().getHours()-new Date(l.time).getHours(),N=new Date().getMinutes()-new Date(l.time).getMinutes(),x=Math.abs(N);N<-15&&d===0?(W.innerText="MISSED SESSION!",g.innerText=""):h===0&&x<=15?N>0?g.innerText=`OVERDUE BY ${x} MINUTE(S)`:N===0?g.innerText="NOW":g.innerText=`STARTS IN ${x} MINUTE(S)`:g.innerText="",setTimeout(()=>{B()},2e4)}B(),T({baseElement:_,TriggerBtn:"start-session-btn",_modalWindow:"confirm-session-popout"},()=>{let d=document.getElementById("confirm-session-popout");d.querySelector("#session-name").innerText=l.session_name,d.querySelector("#time").innerText=E(l.time,!0,!0,!0),d.querySelector("#duration").innerText=D(l.duration),d.querySelector("#gym_location").innerText=l.location,d.querySelector("#session-capacity").innerText=`${l.users.length}/${l.capacity}`,d.querySelector("#current-time").innerText=E(new Date().getTime(),!0);let h=d.querySelector("#confirm-start-session-popout-btn");h.onclick=()=>f(this,null,function*(){h.disabled=!0;let N={},x=yield R(K+l.id,"POST",N,i);if(x.isFetchOk!==void 0&&!x.isFetchOk){let b=d.querySelector("#warning_block");b.innerText=x.message,b.style.display="flex",h.disabled=!1;return}S(`${M}?session=${l.id}`)})}),_.style.display="flex",a.prepend(_)})}c(s),U({TriggerBtn:"close-cancel-session-modal-btn",_modalWindow:"confirm-session-popout"},()=>{let A=document.getElementById("confirm-session-popout").querySelector("#warning_block");A.style.display="none"}),o.style.display="none"})}})();var k=z||[];k.push(function(){$(document).off("submit"),$("form").on("submit",function(e){return f(this,null,function*(){e.preventDefault()})})});
