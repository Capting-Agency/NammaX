var N=(t,o,e)=>new Promise((r,_)=>{var i=n=>{try{a(e.next(n))}catch(l){_(l)}},s=n=>{try{a(e.throw(n))}catch(l){_(l)}},a=n=>n.done?r(n.value):Promise.resolve(n.value).then(i,s);a((e=e.apply(t,o)).next())});function h(t,o="GET",e=!1,r=!1,_=!1,i=!0){try{let s={"Content-Type":"application/json"};_&&(s={}),r&&(s.Authorization=`Bearer ${r}`);let a={method:o,headers:s};return e&&(i?a.body=JSON.stringify(e):a.body=e),fetch(t,a).then(n=>n.ok?n.json():n.json().then(l=>(Promise.reject(l.message),{isFetchOk:!1,status:n.status,message:l.message,payload:l&&l.payload?l.payload:null}))).then(n=>n).catch(n=>(console.error("Error in fetch",n),n))}catch(s){return console.error("Error!: "+s),s}}function D(t=null,o="nammax_auth",e=60*60*24){t&&(document.cookie=`${o}=${t}; path=/; max-age=${e}`)}function g(t="nammax_auth"){let e=`; ${document.cookie}`.split(`; ${t}=`);return e.length===2?e.pop().split(";").shift():null}function x(t="/",o=0){setTimeout(()=>{window.location.href=t},o)}function E(t=null,o=!1){if(t==null)return"NaN";var e=new Date(t),r=e.getHours(),_=r>=12?"PM":"AM";if(r=r%12||12,o){var i=e.getMinutes();return i=i<10?`0${i}`:i,`${r}:${i} ${_}`}else return`${r} ${_}`}function R(t=null){if(t==null)return"NaN";t=t*60;let o=`${t/60^0}`.slice(-2),e=("0"+t%60).slice(-2);return o!="0"?e!="00"?`${o} HR ${e} M`:o+" HR":e+" Mins"}function C(t,o=null){if(t!=null){var e,r=t.options.length-1;for(e=r;e>=0;e--)e!==o&&t.remove(e)}}function B(t="/sign-in"){window.localStorage.removeItem("auth"),x(`${t}`)}function O(t="current-time"){let o=document.getElementById(t);o&&(o.innerText=E(new Date,!0)),setTimeout(()=>O(t),3e4)}function M(){let t=document.getElementById("loading-screen");t&&(t.style.display="none")}function I({single:t=!0,baseElement:o="",TriggerBtn:e="jsModalOpen",_modalWindow:r="jsModal"},_){if(t){var i=o.querySelector("#"+e);i.onclick=function(){var n=document.getElementById(r);_&&_(),n.classList?n.classList.add("open"):n.className+=" open"}}else for(var s=document.getElementsByClassName(e),a=0;a<s.length;a++)s[a].onclick=function(){var n=this.getAttribute("href").substr(1),l=document.getElementById(n);l.classList?l.classList.add("open"):l.className+=" open"}}function y({TriggerBtn:t="jsModalClose",_modalWindow:o="jsModal"},e){var r=document.getElementById(t),_=document.getElementById(o);r.onclick=function(){_.classList?_.classList.remove("open"):_.className=_.className.replace(new RegExp("(^|\\b)"+"open".split(" ").join("|")+"(\\b|$)","gi")," ")},e&&e()}function b({_modalWindow:t="jsModal"},o){var e=document.getElementById(t);function r(){e.classList?e.classList.add("open"):e.className+=" open",o&&o()}r()}function L({_modalWindow:t},o){var e=document.getElementById(t);function r(){e.classList?e.classList.remove("open"):e.className=e.className.replace(new RegExp("(^|\\b)"+"open".split(" ").join("|")+"(\\b|$)","gi")," "),o&&o()}r()}var k=Webflow||[];var U="/coach/sign-in";var T="/coach/session-details/";var X="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/coach/sessions/start_session/",v="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/coach/dashboard/",H="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/coach/all_gyms";(()=>{let t=[];window.onload=function(){let i=document.getElementById("navbar-logout-btn");i&&(i.onclick=()=>{B("/coach/sign-in")});let s=g();s?(O(),o(s),M()):x(`${U}?reason=NOT_SIGNED_IN`)};function o(i,s=!1){return N(this,null,function*(){let a=g("nammaxCoachSelectedGym");if(!a||s){b({_modalWindow:"gym-select-popout"});let n;if(t.length===0?n=yield h(H,"GET",!1,i):n=t,n.isFetchOk!==void 0&&!n.isFetchOk){console.error(n.message),x(`${U}?reason=NOT_SIGNED_IN`);return}t=n;let l=document.getElementById("gym-select-popout"),p=l.querySelector("#coach-gym-select"),A=l.querySelector("#confirm-gym-select-btn");if(s){let d=l.querySelector("#cancel-gym-select-btn");d.onclick=()=>{L({_modalWindow:"gym-select-popout"})},d.classList.remove("hide")}C(p),n.forEach((d,c)=>{var m=document.createElement("option");m.value=d.id,m.innerText=d.location,c===0&&(m.selected=!0),a==d.id&&(m.selected=!0),p.appendChild(m)}),A.onclick=()=>{let d=p.value;e(d,i),L({_modalWindow:"gym-select-popout"},()=>{D(d,"nammaxCoachSelectedGym")})}}else e(a,i)})}function e(i,s){return N(this,null,function*(){let a=yield h(v+i,"GET",!1,s);if(a.isFetchOk!==void 0&&!a.isFetchOk){console.error(a.message);return}let{coach:n,sessions:l}=a;document.getElementById("user-name").innerText="Coach "+n.name,document.getElementById("location-map-name").innerText=n.location,l.forEach(p=>{if(p.status==="IN PROGRESS"&&p.coach.status==="IN SESSION"&&p.team_id===n.id){x(`${T}?session=${p.id}`);return}}),r(s),_(s,l)})}function r(i){I({_modalWindow:"gym-select-popout",TriggerBtn:"location-map-change-btn",baseElement:document.getElementById("location-map-container")},()=>{o(i,!0)}),y({_modalWindow:"gym-select-popout",TriggerBtn:"cancel-gym-select-btn"})}function _(i,s){return N(this,null,function*(){let a=document.getElementById("view-coach-sessions-container"),n=a.querySelector("#view-coach-sessions-item");function l(p){let A=a.querySelectorAll(".session-details-w.card-item");A.forEach((c,m)=>{m!==A.length-1&&c.remove()});let d=a.querySelector("#no-sessions-found");p.length===0?d.style.display="flex":d.style.display="none",p.forEach(c=>{let m=n.cloneNode(!0);m.setAttribute("id",""),m.querySelector("#session-name").innerText=c.session_name,m.querySelector("#time").innerText=E(c.time,!0),m.querySelector("#duration").innerText=R(c.duration),m.querySelector("#session-slot-bar").style.width=c.users.length/c.capacity*100+"%",m.querySelector("#session-capacity").innerText=`${c.users.length}/${c.capacity}`,I({baseElement:m,TriggerBtn:"start-session-btn",_modalWindow:"confirm-session-popout"},()=>{let u=document.getElementById("confirm-session-popout");u.querySelector("#session-name").innerText=c.session_name,u.querySelector("#time").innerText=E(c.time,!0),u.querySelector("#duration").innerText=R(c.duration),u.querySelector("#gym_location").innerText=c.location,u.querySelector("#session-capacity").innerText=`${c.users.length}/${c.capacity}`,u.querySelector("#current-time").innerText=E(new Date,!0);let S=u.querySelector("#confirm-start-session-popout-btn");S.onclick=()=>N(this,null,function*(){S.disabled=!0;let K={},f=yield h(X+c.id,"POST",K,i);if(f.isFetchOk!==void 0&&!f.isFetchOk){let w=u.querySelector("#warning_block");w.innerText=f.message,w.style.display="flex",S.disabled=!1;return}x(`${T}?session=${c.id}`)})}),m.style.display="flex",a.prepend(m)})}l(s),y({TriggerBtn:"close-cancel-session-modal-btn",_modalWindow:"confirm-session-popout"},()=>{let A=document.getElementById("confirm-session-popout").querySelector("#warning_block");A.style.display="none"}),n.style.display="none"})}})();var P=k||[];P.push(function(){$(document).off("submit"),$("form").on("submit",function(t){return N(this,null,function*(){t.preventDefault()})})});
