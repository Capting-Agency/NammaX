var z=Object.defineProperty,w=Object.defineProperties;var K=Object.getOwnPropertyDescriptors;var y=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var U=(e,n,a)=>n in e?z(e,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[n]=a,g=(e,n)=>{for(var a in n||={})P.call(n,a)&&U(e,a,n[a]);if(y)for(var a of y(n))H.call(n,a)&&U(e,a,n[a]);return e},R=(e,n)=>w(e,K(n));var O=(e,n,a)=>new Promise((u,p)=>{var N=o=>{try{i(a.next(o))}catch(r){p(r)}},_=o=>{try{i(a.throw(o))}catch(r){p(r)}},i=o=>o.done?u(o.value):Promise.resolve(o.value).then(N,_);i((a=a.apply(e,n)).next())});var L=["January","February","March","April","May","June","July","August","September","October","November","December"],x={ADMIN:"ADMIN",SUPER_ADMIN:"SUPER_ADMIN",COACH:"COACH"};function I(e,n="GET",a=!1,u=!1,p=!1,N=!0){try{let _={"Content-Type":"application/json"};p&&(_={}),u&&(_.Authorization=`Bearer ${u}`);let i={method:n,headers:_};return a&&(N?i.body=JSON.stringify(a):i.body=a),fetch(e,i).then(o=>o.ok?o.json():o.json().then(r=>(Promise.reject(r.message),{isFetchOk:!1,status:o.status,message:r.message,payload:r&&r.payload?r.payload:null}))).then(o=>o).catch(o=>(console.error("Error in fetch",o),o))}catch(_){return console.error("Error!: "+_),_}}function D(e="nammax_auth"){let a=`; ${document.cookie}`.split(`; ${e}=`);return a.length===2?a.pop().split(";").shift():null}function f(e="/",n=2e3){setTimeout(()=>{window.location.href=e},n)}function T(e=1e3){setTimeout(()=>{window.location.reload()},e)}function b(e=null){if(e==null)return"NaN";let n=new Date(e);return`${n.getDate()}/${n.getMonth()+1}/${n.getFullYear()}`}function C(e="/admin/sign-in",n="sidebar-logout-btn"){let a=document.getElementById(n);a?a.onclick=()=>k(e):console.error("Logout button not found")}function k(e="/sign-in"){window.localStorage.removeItem("auth"),f(`${e}`)}function A(e=0){return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(Number(e)).replace(/^(\D+)/,"$1 ")}function B(e=x.ADMIN){if(e===x.ADMIN){let n=document.getElementById("admin-nav"),a=document.getElementById("super-admin-nav");n&&(n.style.display="flex"),a&&a.remove()}else if(e===x.SUPER_ADMIN){let n=document.getElementById("admin-nav"),a=document.getElementById("super-admin-nav");a&&(a.style.display="flex"),n&&n.remove()}}function M(){let e=document.getElementById("loading-screen");e?e.remove():console.log("did not find loading screen")}var v=Webflow||[];var S="/admin/sign-in";var X="https://xoxo-jnzf-s0on.m2.xano.io/api:Kml2N_BA/super_admin/all_finance_detail",j="https://xoxo-jnzf-s0on.m2.xano.io/api:Kml2N_BA/super_admin/all_finance_detail/new_entry";(()=>{let e,n;window.onload=function(){return O(this,null,function*(){C("/admin/sign-in","sidebar-logout-btn");var i=new URL(document.location.href);if(e=i.searchParams.get("month")||null,n=i.searchParams.get("year")||null,!e||!n){console.error("No month or year found");return}let o=D();if(o){let l=yield I(X,"POST",{month:e,year:n},o);if(l.isFetchOk!==void 0&&!l.isFetchOk){console.error(l.message),l.payload&&l.payload.role===x.ADMIN&&l.payload.gyms&&l.payload.gyms.length>0?f(`/admin/gym/g?gymCode=${l.payload.gyms[0].gym_id}`):f(`${S}?reason=UNAUTHORIZED_USER`);return}B(x.SUPER_ADMIN),a(l,o)}else f(`${S}?reason=NOT_SIGNED_IN`)})};function a(i){let{finance:o,external_finance:r,payment_ledger:l}=i,c={};o.map(t=>c[t.month+","+t.year]!==void 0?c[t.month+","+t.year]=R(g({},c[t.month+","+t.year]),{additional_revenue:t.additional_revenue+c[t.month+","+t.year].additional_revenue,additional_expenses:0,gross_revenue:t.gross_revenue+c[t.month+","+t.year].gross_revenue,member_revenue:t.member_revenue+c[t.month+","+t.year].member_revenue,fixed_expense:t.fixed_expense+c[t.month+","+t.year].fixed_expense}):c[t.month+","+t.year]=t);let m=c;r.map(t=>m[t.month+","+t.year]!==void 0?m[t.month+","+t.year]=R(g({},m[t.month+","+t.year]),{additional_revenue:t.credit+m[t.month+","+t.year].additional_revenue,additional_expenses:t.debit+m[t.month+","+t.year].additional_expenses}):t),N(),u(m),p(l,r),M()}function u(i){let{month:o,year:r,member_revenue:l,fixed_expense:c,gross_revenue:m,additional_revenue:t,additional_expenses:s}=i[e+","+n],d=Number(m)+Number(t)-Number(s);document.getElementById("finance-month").innerText=L[o-1],document.getElementById("finance-year").innerText=r,document.getElementById("financial-member-revenue").innerText=A(l||"0")||"0",document.getElementById("financial-fixed-expense").innerText=A(c||"0")||"0",document.getElementById("financial-gross-revenue").innerText=A(m||"0")||"0",document.getElementById("financial-additional-revenue").innerText=A(t||"0")||"0",document.getElementById("financial-additional-expenses").innerText=A(s||"0")||"0",document.getElementById("financial-net-profit").innerText=A(d||"0")||"0"}function p(i=[],o=[]){let r=document.getElementById("account-table-container"),l=r.querySelector("#account-table-item"),c={};i.map(s=>c[s.code]!==void 0?c[s.code]=R(g({},c[s.code]),{credit:Number(s.amount)+Number(c[s.code].credit)}):c[s.code]={time:null,description:`${s.code}`,debit:null,credit:Number(s.amount),user:!0});let m=[...o.map(s=>({time:s.created_at,description:s.description,debit:s.debit,credit:s.credit}))],t=Object.values(c);t=t.concat(m),t.sort((s,d)=>d.time-s.time),t==null||t.forEach((s,d)=>{let E=l.cloneNode(!0);E.setAttribute("id","");let h=E.querySelectorAll(".colcontent");d%2===0&&(E.style.backgroundColor="#00edf4"),h[0].innerText=s&&s.user?"":b(s.time),h[1].innerText=s.description||"",h[2].innerText=s.debit||"",h[3].innerText=s.credit||"",r.append(E)}),l.remove()}function N(){let o=document.getElementById("entry-form-block").querySelector("#entry-btn"),r=new Date,l=new Date(r.getFullYear(),r.getMonth(),1),c=new Date(r.getFullYear(),r.getMonth(),31),m=document.getElementById("datepicker-input");$(m).datepicker({startDate:l,endDate:c,format:"dd/mm/yyyy",language:"en",multidate:!1,orientation:"bottom auto"}).datepicker("setDate","now"),o.onclick=()=>{o.disabled||(o.disabled=!0,o.value="Submitting...",o.classList.contains("disabled")||o.classList.add("disabled"),_())}}function _(){return O(this,null,function*(){let i=$("#entry-form-block");if(i.attr("id")==="entry-form-block"){let o=document.getElementById("entry-btn");o&&(o.disabled=!0);let r=D();if(r){let l=i[0][0].value||"",c=i[0][1].value||"",m=i[0][2].value||"",t=i[0][3].value||"";if(l!==""&&c!==""&&(m!==""||t!=="")){let s={time:new Date(l).getTime(),month:e,year:n,description:c,debit:m,credit:t},d=yield I(j,"POST",s,r);if(d.isFetchOk!==void 0&&!d.isFetchOk){console.error(d.message),i.hide().siblings(".w-form-done").hide().siblings(".w-form-fail").show().text("Failed to add new entry. Please try again - Error: "+d.message),o&&(o.disabled=!1);return}i.hide().siblings(".w-form-fail").hide().siblings(".w-form-done").show().text("Successfully added new entry!"),T()}}}})}})();var F=v||[];F.push(function(){$(document).off("submit"),$("form").on("change",function(){let e=$(this);if(e.attr("id")==="entry-form-block"){let n=e[0][0].value||"",a=e[0][1].value||"",u=e[0][2].value||"",p=e[0][3].value||"",_=document.getElementById("entry-form-block").querySelector("#entry-btn");n!==""&&a!==""&&(u!==""||p!=="")?(_.disabled=!1,_.classList.remove("disabled")):(_.disabled=!0,_.classList.contains("disabled")||_.classList.addClass("disabled"))}}),$("form").on("submit",function(e){return O(this,null,function*(){e.preventDefault()})})});
