var E=Object.getOwnPropertySymbols;var b=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable;var f=(t,o)=>{var e={};for(var n in t)b.call(t,n)&&o.indexOf(n)<0&&(e[n]=t[n]);if(t!=null&&E)for(var n of E(t))o.indexOf(n)<0&&w.call(t,n)&&(e[n]=t[n]);return e};var p=(t,o,e)=>new Promise((n,a)=>{var r=i=>{try{l(e.next(i))}catch(_){a(_)}},s=i=>{try{l(e.throw(i))}catch(_){a(_)}},l=i=>i.done?n(i.value):Promise.resolve(i.value).then(r,s);l((e=e.apply(t,o)).next())});var m={ADMIN:"ADMIN",SUPER_ADMIN:"SUPER_ADMIN",COACH:"COACH"};function N(t,o="GET",e=!1,n=!1,a=!1,r=!0){try{let s={"Content-Type":"application/json"};a&&(s={}),n&&(s.Authorization=`Bearer ${n}`);let l={method:o,headers:s};return e&&(r?l.body=JSON.stringify(e):l.body=e),fetch(t,l).then(i=>i.ok?i.json():i.json().then(_=>(Promise.reject(_.message),{isFetchOk:!1,status:i.status,message:_.message,payload:_&&_.payload?_.payload:null}))).then(i=>i).catch(i=>(console.error("Error in fetch",i),i))}catch(s){return console.error("Error!: "+s),s}}function x(t="nammax_auth"){let e=`; ${document.cookie}`.split(`; ${t}=`);return e.length===2?e.pop().split(";").shift():null}function d(t="/",o=0){setTimeout(()=>{window.location.href=t},o)}function h(t=1e3){setTimeout(()=>{window.location.reload()},t)}function R(t="/admin/sign-in",o="sidebar-logout-btn"){let e=document.getElementById(o);e?e.onclick=()=>L(t):console.error("Logout button not found")}function L(t="/sign-in"){window.localStorage.removeItem("auth"),d(`${t}`)}function g(t=m.ADMIN){if(t===m.ADMIN){let o=document.getElementById("admin-nav"),e=document.getElementById("super-admin-nav");o&&(o.style.display="flex"),e&&e.remove()}else if(t===m.SUPER_ADMIN){let o=document.getElementById("admin-nav"),e=document.getElementById("super-admin-nav");e&&(e.style.display="flex"),o&&o.remove()}}function S(){let t=document.getElementById("loading-screen");t&&(t.style.display="none")}var I=Webflow||[];var u="/admin/sign-in";var O="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/super_admin/all_gyms",U="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/super_admin/all_gyms/add_gym",D="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/super_admin/all_gyms/upload/image";window.onload=function(){return p(this,null,function*(){R(u,"sidebar-logout-btn");let t=x();if(t){let e=yield N(O,"GET",!1,t);if(e.isFetchOk!==void 0&&!e.isFetchOk){console.error(e.message);return}let o=e,{team_role:n}=o,a=f(o,["team_role"]);n&&(n===m.SUPER_ADMIN||n===m.ADMIN)?(g(n),C(a)):d(`${u}?reason=UNAUTHORIZED_USER`)}else d(`${u}?reason=NOT_SIGNED_IN`)})};function C(t){return p(this,null,function*(){let{gyms:o}=t;k(),T(o),S()})}function T(t){let o=document.getElementById("gym-container"),e=o.querySelector("#gym-item");t.forEach(n=>{var s,l,i,_;let a=e.cloneNode(!0);a.setAttribute("id",""),a.setAttribute("href",`/admin/gym/g?gymCode=${n.id}`),n.map_icon&&(a.querySelector("#gym-map").style.backgroundImage=`url(${n.map_icon.url})`),a.querySelector("#gym-code").innerText=n.code,a.querySelector("#gym-name").innerText=n.location,a.querySelector("#gym-coach").innerText=n.partner,a.querySelector("#gym-active-sessions").innerText=(l=(s=n==null?void 0:n.sessions)==null?void 0:s.length)!=null?l:0;let r=0;n.finances.forEach(c=>{r+=Number(c.gross_revenue)+Number(c.additional_revenue)}),n.finances.length>0?r=r/n.finances.length:r=null,a.querySelector("#gym-revenue").innerText=r!=null?r:"NaN",a.querySelector("#gym-active-users").innerText=n.users.filter(c=>c.membership_status!=="INACTIVE"&&c.membership_status!=="TRIAL").length||0,a.querySelector("#gym-users").innerText=(_=(i=n==null?void 0:n.users)==null?void 0:i.length)!=null?_:0,o.prepend(a)}),e.remove()}function M(t,o,e){return p(this,null,function*(){let n=document.getElementById("pfp_input"),a=n.files[0];if(a!==void 0){if(a.size>2097152){alert("File too big. Max size is 2MB");return}if(a.type!=="image/jpg"&&a.type!=="image/jpeg"&&a.type!=="image/png"){alert("Incorrect file type. Acceptable types: .png, .jpg, .jpeg");return}let r=new FormData;r.append("content",a),r.append("gym_id",e);let s=yield N(D,"POST",r,t,!0,!1);if(s.isFetchOk!==void 0&&!s.isFetchOk){console.error(s.message),o.siblings(".w-form-done").hide().siblings(".w-form-fail").show().text("Uh oh, failed to upload image!");return}return n.value="",s}return!0})}function k(){let t=document.getElementById("pfp_input"),o=document.getElementById("pfp_preview"),e=document.getElementById("preview-icon-container");t.addEventListener("change",function(n){n.target&&n.target.files.length>0&&n.target.files[0]?(e.style.display="flex",o.src=URL.createObjectURL(n.target.files[0])):e.style.display="none"})}var B=I||[];B.push(function(){$(document).off("submit"),$("form").on("change",function(){let t=$(this),o=t[0][0].value,e=t[0][1].value,n=t[0][2].value,a=t[0][3].value,r=t[0][4].value,s=t[0][5].value,l=t[0][6].value,i=t[0][7].value;o!==""&&e!==""&&n!==""&&a!==""&&r!==""&&s!==""&&l!==""&&i!==""&&(t[0][8].disabled=!1,t[0][8].classList.remove("disabled"))}),$("form").on("submit",function(t){return p(this,null,function*(){t.preventDefault();let o=document.getElementById("sessions-select-btn");o.disabled=!0,o.classList.add("disabled"),o.value="SUBMITTING...";let e=$(this),n=x();if(n){let a=e[0][0].value,r=e[0][1].value,s=e[0][2].value,l=e[0][3].value,i=e[0][4].value,_=e[0][5].value,c=e[0][6].value,y=e[0][7].value;if(a!==""&&r!==""&&s!==""&&l!==""&&i!==""&&_!==""&&c!==""&&y!==""){let A=yield N(U,"POST",{location:a,code:r,address:s,capacity:l,partner_name:i,partner_email:_,partner_contact:c},n);if(A.isFetchOk!==void 0&&!A.isFetchOk){console.error(A.message),e.siblings(".w-form-done").hide().siblings(".w-form-fail").show().text("There was an error trying to add your session. Please refresh your browser and try again."),o.disabled=!1,o.classList.remove("disabled"),o.value="ADD NEW GYM";return}e.hide().siblings(".w-form-done").show().siblings(".w-form-fail").hide(),yield M(n,e,A.id),h()}else a.trim()===""?e[0][0].style.borderColor="red":e[0][1].style.borderColor="black",r.trim()===""?e[0][1].style.borderColor="red":e[0][2].style.borderColor="black",s.trim()===""?e[0][2].style.borderColor="red":e[0][3].style.borderColor="black",l.trim()===""?e[0][3].style.borderColor="red":e[0][4].style.borderColor="black",i.trim()==="Duration"?e[0][4].style.borderColor="red":e[0][5].style.borderColor="black",_.trim()===""?e[0][5].style.borderColor="red":e[0][6].style.borderColor="black",c.trim()===""?e[0][6].style.borderColor="red":e[0][6].style.borderColor="black",e.siblings(".w-form-done").hide().siblings(".w-form-fail").show().text("Please fill out all fields"),o.disabled=!1,o.classList.remove("disabled"),o.value="ADD NEW GYM"}else d(`${u}?reason=NOT_SIGNED_IN`)})})});
