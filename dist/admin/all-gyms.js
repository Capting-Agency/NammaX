var f=Object.getOwnPropertySymbols;var w=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable;var h=(t,o)=>{var e={};for(var n in t)w.call(t,n)&&o.indexOf(n)<0&&(e[n]=t[n]);if(t!=null&&f)for(var n of f(t))o.indexOf(n)<0&&C.call(t,n)&&(e[n]=t[n]);return e};var d=(t,o,e)=>new Promise((n,a)=>{var s=i=>{try{l(e.next(i))}catch(_){a(_)}},r=i=>{try{l(e.throw(i))}catch(_){a(_)}},l=i=>i.done?n(i.value):Promise.resolve(i.value).then(s,r);l((e=e.apply(t,o)).next())});var c={ADMIN:"ADMIN",SUPER_ADMIN:"SUPER_ADMIN",COACH:"COACH"};function x(t,o="GET",e=!1,n=!1,a=!1,s=!0){try{let r={"Content-Type":"application/json"};a&&(r={}),n&&(r.Authorization=`Bearer ${n}`);let l={method:o,headers:r};return e&&(s?l.body=JSON.stringify(e):l.body=e),fetch(t,l).then(i=>i.ok?i.json():i.json().then(_=>(Promise.reject(_.message),{isFetchOk:!1,status:i.status,message:_.message,payload:_&&_.payload?_.payload:null}))).then(i=>i).catch(i=>(console.error("Error in fetch",i),i))}catch(r){return console.error("Error!: "+r),r}}function E(t="nammax_auth"){let e=`; ${document.cookie}`.split(`; ${t}=`);return e.length===2?e.pop().split(";").shift():null}function u(t="/",o=2e3){setTimeout(()=>{window.location.href=t},o)}function g(t=1e3){setTimeout(()=>{window.location.reload()},t)}function R(t="/admin/sign-in",o="sidebar-logout-btn"){let e=document.getElementById(o);e?e.onclick=()=>b(t):console.error("Logout button not found")}function b(t="/sign-in"){window.localStorage.removeItem("auth"),u(`${t}`)}function O(t=0){return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(Number(t)).replace(/^(\D+)/,"$1 ")}function S(t=c.ADMIN){if(t===c.ADMIN){let o=document.getElementById("admin-nav"),e=document.getElementById("super-admin-nav");o&&(o.style.display="flex"),e&&e.remove()}else if(t===c.SUPER_ADMIN){let o=document.getElementById("admin-nav"),e=document.getElementById("super-admin-nav");e&&(e.style.display="flex"),o&&o.remove()}}function I(){let t=document.getElementById("loading-screen");t?t.remove():console.log("did not find loading screen")}var D=Webflow||[];var A="/admin/sign-in";var U="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/super_admin/all_gyms",y="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/super_admin/all_gyms/add_gym",L="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/super_admin/all_gyms/upload/image";window.onload=function(){return d(this,null,function*(){R(A,"sidebar-logout-btn");let t=E();if(t){let e=yield x(U,"GET",!1,t);if(e.isFetchOk!==void 0&&!e.isFetchOk){console.error(e.message);return}let o=e,{team_role:n}=o,a=h(o,["team_role"]);n&&(n===c.SUPER_ADMIN||n===c.ADMIN)?(S(n),T(a)):u(`${A}?reason=UNAUTHORIZED_USER`)}else u(`${A}?reason=NOT_SIGNED_IN`)})};function T(t){return d(this,null,function*(){let{gyms:o}=t;B(),M(o),I()})}function M(t){let o=document.getElementById("gym-container"),e=o.querySelector("#gym-item");t.forEach(n=>{var r,l,i,_,m;let a=e.cloneNode(!0);a.setAttribute("id",""),a.setAttribute("href",`/admin/gym/g?gymCode=${n.id}`),n.map_icon&&(a.querySelector("#gym-map").style.backgroundImage=`url(${n.map_icon.url})`),a.querySelector("#gym-code").innerText=n.code,a.querySelector("#gym-name").innerText=n.location,a.querySelector("#gym-coach").innerText=n.partner,a.querySelector("#gym-active-sessions").innerText=(l=(r=n==null?void 0:n.sessions)==null?void 0:r.length)!=null?l:0;let s=0;n.finances.forEach(p=>{s+=Number(p.gross_revenue)+Number(p.additional_revenue)}),n.finances.length>0?s=s/n.finances.length:s=null,a.querySelector("#gym-revenue").innerText=(i=O(Math.round(s)||0))!=null?i:"NaN",a.querySelector("#gym-active-users").innerText=n.users.filter(p=>p.membership_status!=="INACTIVE").length||0,a.querySelector("#gym-users").innerText=(m=(_=n==null?void 0:n.users)==null?void 0:_.length)!=null?m:0,o.prepend(a)}),e.remove()}function k(t,o,e){return d(this,null,function*(){let n=document.getElementById("pfp_input"),a=n.files[0];if(a!==void 0){if(a.size>2097152){alert("File too big. Max size is 2MB");return}if(a.type!=="image/jpg"&&a.type!=="image/jpeg"&&a.type!=="image/png"){alert("Incorrect file type. Acceptable types: .png, .jpg, .jpeg");return}let s=new FormData;s.append("content",a),s.append("gym_id",e);let r=yield x(L,"POST",s,t,!0,!1);if(r.isFetchOk!==void 0&&!r.isFetchOk){console.error(r.message),o.siblings(".w-form-done").hide().siblings(".w-form-fail").show().text("Uh oh, failed to upload image!");return}return n.value="",r}return!0})}function B(){let t=document.getElementById("pfp_input"),o=document.getElementById("pfp_preview"),e=document.getElementById("preview-icon-container");t.addEventListener("change",function(n){n.target&&n.target.files.length>0&&n.target.files[0]?(e.style.display="flex",o.src=URL.createObjectURL(n.target.files[0])):e.style.display="none"})}var v=D||[];v.push(function(){$(document).off("submit"),$("form").on("change",function(){let t=$(this),o=t[0][0].value,e=t[0][1].value,n=t[0][2].value,a=t[0][3].value,s=t[0][4].value,r=t[0][5].value,l=t[0][6].value,i=t[0][7].value;o!==""&&e!==""&&n!==""&&a!==""&&s!==""&&r!==""&&l!==""&&i!==""&&(t[0][8].disabled=!1,t[0][8].classList.remove("disabled"))}),$("form").on("submit",function(t){return d(this,null,function*(){t.preventDefault();let o=document.getElementById("sessions-select-btn");o.disabled=!0,o.classList.add("disabled"),o.value="SUBMITTING...";let e=$(this),n=E();if(n){let a=e[0][0].value,s=e[0][1].value,r=e[0][2].value,l=e[0][3].value,i=e[0][4].value,_=e[0][5].value,m=e[0][6].value,p=e[0][7].value;if(a!==""&&s!==""&&r!==""&&l!==""&&i!==""&&_!==""&&m!==""&&p!==""){let N=yield x(y,"POST",{location:a,code:s,address:r,capacity:l,partner_name:i,partner_email:_,partner_contact:m},n);if(N.isFetchOk!==void 0&&!N.isFetchOk){console.error(N.message),e.siblings(".w-form-done").hide().siblings(".w-form-fail").show().text("There was an error trying to add your session. Please refresh your browser and try again."),o.disabled=!1,o.classList.remove("disabled"),o.value="ADD NEW GYM";return}e.hide().siblings(".w-form-done").show().siblings(".w-form-fail").hide(),yield k(n,e,N.id),g()}else a.trim()===""?e[0][0].style.borderColor="red":e[0][1].style.borderColor="black",s.trim()===""?e[0][1].style.borderColor="red":e[0][2].style.borderColor="black",r.trim()===""?e[0][2].style.borderColor="red":e[0][3].style.borderColor="black",l.trim()===""?e[0][3].style.borderColor="red":e[0][4].style.borderColor="black",i.trim()==="Duration"?e[0][4].style.borderColor="red":e[0][5].style.borderColor="black",_.trim()===""?e[0][5].style.borderColor="red":e[0][6].style.borderColor="black",m.trim()===""?e[0][6].style.borderColor="red":e[0][6].style.borderColor="black",e.siblings(".w-form-done").hide().siblings(".w-form-fail").show().text("Please fill out all fields"),o.disabled=!1,o.classList.remove("disabled"),o.value="ADD NEW GYM"}else u(`${A}?reason=NOT_SIGNED_IN`)})})});
