var h=(n,e,t)=>new Promise((s,r)=>{var _=o=>{try{l(t.next(o))}catch(i){r(i)}},a=o=>{try{l(t.throw(o))}catch(i){r(i)}},l=o=>o.done?s(o.value):Promise.resolve(o.value).then(_,a);l((t=t.apply(n,e)).next())});var u={ADMIN:"ADMIN",SUPER_ADMIN:"SUPER_ADMIN",COACH:"COACH"};function E(n,e="GET",t=!1,s=!1,r=!1,_=!0){try{let a={"Content-Type":"application/json"};r&&(a={}),s&&(a.Authorization=`Bearer ${s}`);let l={method:e,headers:a};return t&&(_?l.body=JSON.stringify(t):l.body=t),fetch(n,l).then(o=>o.ok?o.json():o.json().then(i=>(Promise.reject(i.message),{isFetchOk:!1,status:o.status,message:i.message,payload:i&&i.payload?i.payload:null}))).then(o=>o).catch(o=>(console.error("Error in fetch",o),o))}catch(a){return console.error("Error!: "+a),a}}function T(n="nammax_auth"){let t=`; ${document.cookie}`.split(`; ${n}=`);return t.length===2?t.pop().split(";").shift():null}function R(n="/",e=0){setTimeout(()=>{window.location.href=n},e)}function C(n,e=null){if(n!=null){var t,s=n.options.length-1;for(t=s;t>=0;t--)t!==e&&n.remove(t)}}function L(n="/admin/sign-in",e="sidebar-logout-btn"){let t=document.getElementById(e);t?t.onclick=()=>F(n):console.error("Logout button not found")}function F(n="/sign-in"){window.localStorage.removeItem("auth"),R(`${n}`)}function k(n=u.ADMIN){if(n===u.ADMIN){let e=document.getElementById("admin-nav"),t=document.getElementById("super-admin-nav");e&&(e.style.display="flex"),t&&t.remove()}else if(n===u.SUPER_ADMIN){let e=document.getElementById("admin-nav"),t=document.getElementById("super-admin-nav");t&&(t.style.display="flex"),e&&e.remove()}}function B({mode:n="API",clientObjRefName:e="name",data:t,token:s,API:r,extraXanoInputObj:_=[],searchContainerElId:a=""},l,o=null,i=null){let c,p,A;if(a.length>0){let d=document.getElementById(a);c=d.querySelector("#search-input"),c.setAttribute("placeholder","Search"),p=d.querySelector("#search-btn"),A=d.querySelector("#search-reset-btn")}else c=document.getElementById("search-input"),c.setAttribute("placeholder","Search"),p=document.getElementById("search-btn"),A=document.getElementById("search-reset-btn");A.onclick=()=>{c.value="",M(A,{mode:n,clientObjRefName:e,data:t,searchquery:"",token:s,API:r,extraXanoInputObj:_},l,o,i)},p.onclick=()=>{let d=c.value;M(A,{mode:n,clientObjRefName:e,data:t,searchquery:d,token:s,API:r,extraXanoInputObj:_},l,o,i)}}function M(p,A,d,w,se){return h(this,arguments,function*(n,{mode:e,clientObjRefName:t,data:s,searchquery:r,token:_,API:a,extraXanoInputObj:l=[]},o,i,c){if(r.length===0)n.style.display="none",i?o(s,i):o(s);else try{if(e==="API"){let N={search_query:`${r}:*`};l.length>0&&l.map(H=>{for(let[P,G]of Object.entries(H))N[P]=G});let x=yield E(a+"query","POST",N,_);if(x.isFetchOk!==void 0&&!x.isFetchOk)throw console.error(x.message),Error("API call failed");n.style.display="flex",i?o(x,i):o(x)}else{let N=s.filter(x=>x[t].toLowerCase().includes(r.toLowerCase()));n.style.display="flex",i?o(N,i):o(N)}}catch(N){c?c():console.error(N)}})}var y="/admin/sign-in";var v="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/super_admin/all_teams",D="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/super_admin/all_teams/add_team";var g,O,U,I,m,S,b,f=[];$(document).ready(function(){m=document.querySelector("#team-gym-select"),g=document.querySelector("#team-name-input"),O=document.querySelector("#team-email-input"),I=document.querySelector("#team-password-input"),U=document.querySelector("#team-phone-input"),S=document.querySelector("#team-role-select"),b=document.querySelector("#team-add-member-btn"),m.disabled=!0,g.disabled=!0,O.disabled=!0,I.disabled=!0,U.disabled=!0,S.disabled=!0,b.disabled=!0});window.onload=function(){return h(this,null,function*(){L(y,"sidebar-logout-btn");let n=T();if(n){let e=yield E(v,"GET",!1,n);if(e.isFetchOk!==void 0&&!e.isFetchOk){console.error(e.message),e.payload&&e.payload.role===u.ADMIN&&e.payload.gyms&&e.payload.gyms.length>0?R(`/admin/gym/g?gymCode=${e.payload.gyms[0].gym_id}`):R(`${y}?reason=UNAUTHORIZED_USER`);return}k(u.SUPER_ADMIN),W(e,n)}else R(`${y}?reason=NOT_SIGNED_IN`)})};function W(n,e){return h(this,null,function*(){m.disabled=!1,X(n),q(e),B({mode:"client",data:n,clientObjRefName:"name"},X)})}function X(n){let e=document.getElementById("table-container"),t=e.querySelector("#table-item");function s(r){let _=e.querySelectorAll(".adb-user.w-inline-block");_.forEach((a,l)=>{l!==_.length-1&&a.remove()}),r.forEach((a,l)=>{let o=t.cloneNode(!0);o.setAttribute("id",""),o.setAttribute("href",`/admin/team?teamId=${a.id}`);let i=o.querySelectorAll(".colcontent");l%2===0&&(o.style.backgroundColor="#00edf4"),a.profile_picture&&(i[0].style.backgroundImage=`url(${a.profile_picture.url})`),i[1].innerText=a.name,i[2].innerText=a.role,i[4].innerText=a.email,i[5].innerText=a.phone_number;let c="";a.gyms.forEach((p,A)=>{var d,w;c+=p.code,A<a.gyms.length-1&&(c+=", "),i[6].innerText=(w=(d=p==null?void 0:p.users)==null?void 0:d.length)!=null?w:0}),i[3].innerText=c,i[7].innerText=a.status,o.style.display="flex",e.prepend(o)})}s(n),t.style.display="none"}function q(n){$("form :input").attr("autocomplete","off");function e(){return h(this,null,function*(){let t=yield E(D,"GET",!1,n);if(t.isFetchOk!==void 0&&!t.isFetchOk){console.error(t.message);return}Y(t),m.removeEventListener("focus",e)})}m.addEventListener("focus",e)}function Y(n){C(m),n.forEach(e=>{let t=document.createElement("option");t.setAttribute("value",e.id),t.innerText=e.code+" - "+e.location,m.appendChild(t)}),$(m).attr("multiple","multiple"),$(m).multiselect({onInitialized:function(e){f=[e[0].selectedOptions[0].value]},onChange:function(){var e=$(".multiselect-option.dropdown-item.active"),t=[];$(e).each(function(){t.push($(this).find(".form-check-input").val())}),f=t}}),$(m).siblings(".btn-group").addClass("adb-session-dd").children(".multiselect.dropdown-toggle").css("height","100%"),C(S),Object.keys(u).forEach(e=>{let t=document.createElement("option");t.setAttribute("value",e.replace(" ","_")),t.innerText=e,S.appendChild(t)}),g.disabled=!1,O.disabled=!1,I.disabled=!1,U.disabled=!1,S.disabled=!1}var K=K||[];K.push(function(){$(document).off("submit"),$("form").on("change",function(){let n=g.value,e=O.value,t=I.value;f.length>0&&n!==""&&e!==""&&t!==""&&(b.disabled=!1,b.classList.remove("disabled"))}),$("form").on("submit",function(n){return h(this,null,function*(){n.preventDefault();let e=$(this),t=g.value,s=O.value,r=I.value,_=U.value,a=S.value,l=T();if(l)if(f.length>0&&t!==""&&s!==""&&r!==""){let o={gyms:[...f.map(c=>({gym_id:parseInt(c)}))],name:t,email:s,password:r,phone_number:_.trim()===""?null:_,role:a},i=yield E(D,"POST",o,l);if(i.isFetchOk!==void 0&&!i.isFetchOk){console.error(i.message);return}window.location.reload()}else f.length===0?e[0][0].style.borderColor="red":e[0][0].style.borderColor="black",t.trim()===""?e[0][1].style.borderColor="red":e[0][1].style.borderColor="black",s.trim()===""?e[0][2].style.borderColor="red":e[0][2].style.borderColor="black",r.trim()===""?e[0][3].style.borderColor="red":e[0][2].style.borderColor="black",e.siblings(".w-form-done").hide().siblings(".w-form-fail").show().text("Please fill out all (required) fields")})})});
//# sourceMappingURL=all-teams.js.map
