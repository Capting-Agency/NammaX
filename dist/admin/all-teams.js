var h=(n,e,t)=>new Promise((l,r)=>{var _=o=>{try{s(t.next(o))}catch(i){r(i)}},a=o=>{try{s(t.throw(o))}catch(i){r(i)}},s=o=>o.done?l(o.value):Promise.resolve(o.value).then(_,a);s((t=t.apply(n,e)).next())});var u={ADMIN:"ADMIN",SUPER_ADMIN:"SUPER_ADMIN",COACH:"COACH"};function E(n,e="GET",t=!1,l=!1,r=!1,_=!0){try{let a={"Content-Type":"application/json"};r&&(a={}),l&&(a.Authorization=`Bearer ${l}`);let s={method:e,headers:a};return t&&(_?s.body=JSON.stringify(t):s.body=t),fetch(n,s).then(o=>o.ok?o.json():o.json().then(i=>(Promise.reject(i.message),{isFetchOk:!1,status:o.status,message:i.message,payload:i&&i.payload?i.payload:null}))).then(o=>o).catch(o=>(console.error("Error in fetch",o),o))}catch(a){return console.error("Error!: "+a),a}}function D(n="nammax_auth"){let t=`; ${document.cookie}`.split(`; ${n}=`);return t.length===2?t.pop().split(";").shift():null}function f(n="/",e=0){setTimeout(()=>{window.location.href=n},e)}function w(n=1e3){setTimeout(()=>{window.location.reload()},n)}function T(n,e=null){if(n!=null){var t,l=n.options.length-1;for(t=l;t>=0;t--)t!==e&&n.remove(t)}}function k(n="/admin/sign-in",e="sidebar-logout-btn"){let t=document.getElementById(e);t?t.onclick=()=>W(n):console.error("Logout button not found")}function W(n="/sign-in"){window.localStorage.removeItem("auth"),f(`${n}`)}function M(n=u.ADMIN){if(n===u.ADMIN){let e=document.getElementById("admin-nav"),t=document.getElementById("super-admin-nav");e&&(e.style.display="flex"),t&&t.remove()}else if(n===u.SUPER_ADMIN){let e=document.getElementById("admin-nav"),t=document.getElementById("super-admin-nav");t&&(t.style.display="flex"),e&&e.remove()}}function v({mode:n="API",clientObjRefName:e="name",data:t,token:l,API:r,extraXanoInputObj:_=[],searchContainerElId:a=""},s,o=null,i=null){let c,p,A;if(a.length>0){let d=document.getElementById(a);c=d.querySelector("#search-input"),c.setAttribute("placeholder","Search"),p=d.querySelector("#search-btn"),A=d.querySelector("#search-reset-btn")}else c=document.getElementById("search-input"),c.setAttribute("placeholder","Search"),p=document.getElementById("search-btn"),A=document.getElementById("search-reset-btn");A.onclick=()=>{c.value="",B(A,{mode:n,clientObjRefName:e,data:t,searchquery:"",token:l,API:r,extraXanoInputObj:_},s,o,i)},p.onclick=()=>{let d=c.value;B(A,{mode:n,clientObjRefName:e,data:t,searchquery:d,token:l,API:r,extraXanoInputObj:_},s,o,i)}}function B(p,A,d,C,me){return h(this,arguments,function*(n,{mode:e,clientObjRefName:t,data:l,searchquery:r,token:_,API:a,extraXanoInputObj:s=[]},o,i,c){if(r.length===0)n.style.display="none",i?o(l,i):o(l);else try{if(e==="API"){let N={search_query:`${r}:*`};s.length>0&&s.map(P=>{for(let[F,G]of Object.entries(P))N[F]=G});let x=yield E(a+"query","POST",N,_);if(x.isFetchOk!==void 0&&!x.isFetchOk)throw console.error(x.message),Error("API call failed");n.style.display="flex",i?o(x,i):o(x)}else{let N=l.filter(x=>x[t].toLowerCase().includes(r.toLowerCase()));n.style.display="flex",i?o(N,i):o(N)}}catch(N){c?c():console.error(N)}})}var X=Webflow||[];var g="/admin/sign-in";var K="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/super_admin/all_teams",L="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/super_admin/all_teams/add_team";var I,y,b,U,m,O,S,R=[];$(document).ready(function(){m=document.querySelector("#team-gym-select"),I=document.querySelector("#team-name-input"),y=document.querySelector("#team-email-input"),U=document.querySelector("#team-password-input"),b=document.querySelector("#team-phone-input"),O=document.querySelector("#team-role-select"),S=document.querySelector("#team-add-member-btn"),m.disabled=!0,I.disabled=!0,y.disabled=!0,U.disabled=!0,b.disabled=!0,O.disabled=!0,S.disabled=!0});window.onload=function(){return h(this,null,function*(){k(g,"sidebar-logout-btn");let n=D();if(n){let e=yield E(K,"GET",!1,n);if(e.isFetchOk!==void 0&&!e.isFetchOk){console.error(e.message),e.payload&&e.payload.role===u.ADMIN&&e.payload.gyms&&e.payload.gyms.length>0?f(`/admin/gym/g?gymCode=${e.payload.gyms[0].gym_id}`):f(`${g}?reason=UNAUTHORIZED_USER`);return}M(u.SUPER_ADMIN),q(e,n)}else f(`${g}?reason=NOT_SIGNED_IN`)})};function q(n,e){return h(this,null,function*(){m.disabled=!1,H(n),Y(e),v({mode:"client",data:n,clientObjRefName:"name"},H)})}function H(n){let e=document.getElementById("table-container"),t=e.querySelector("#table-item");function l(r){let _=e.querySelectorAll(".adb-user.w-inline-block");_.forEach((a,s)=>{s!==_.length-1&&a.remove()}),r.forEach((a,s)=>{let o=t.cloneNode(!0);o.setAttribute("id",""),o.setAttribute("href",`/admin/team?teamId=${a.id}`);let i=o.querySelectorAll(".colcontent");s%2===0&&(o.style.backgroundColor="#00edf4"),a.profile_picture&&(i[0].style.backgroundImage=`url(${a.profile_picture.url})`),i[1].innerText=a.name,i[2].innerText=a.role,i[4].innerText=a.email,i[5].innerText=a.phone_number;let c="";a.gyms.forEach((p,A)=>{var d,C;c+=p.code,A<a.gyms.length-1&&(c+=", "),i[6].innerText=(C=(d=p==null?void 0:p.users)==null?void 0:d.length)!=null?C:0}),i[3].innerText=c,i[7].innerText=a.status,o.style.display="flex",e.prepend(o)})}l(n),t.style.display="none"}function Y(n){$("form :input").attr("autocomplete","off");function e(){return h(this,null,function*(){let t=yield E(L,"GET",!1,n);if(t.isFetchOk!==void 0&&!t.isFetchOk){console.error(t.message);return}j(t),m.removeEventListener("focus",e)})}m.addEventListener("focus",e)}function j(n){T(m),n.forEach(e=>{let t=document.createElement("option");t.setAttribute("value",e.id),t.innerText=e.code+" - "+e.location,m.appendChild(t)}),$(m).attr("multiple","multiple"),$(m).multiselect({onInitialized:function(e){R=[e[0].selectedOptions[0].value]},onChange:function(){var e=$(".multiselect-option.dropdown-item.active"),t=[];$(e).each(function(){t.push($(this).find(".form-check-input").val())}),R=t}}),$(m).siblings(".btn-group").addClass("adb-session-dd").children(".multiselect.dropdown-toggle").css("height","100%"),T(O),Object.keys(u).forEach(e=>{let t=document.createElement("option");t.setAttribute("value",e.replace(" ","_")),t.innerText=e,O.appendChild(t)}),I.disabled=!1,y.disabled=!1,U.disabled=!1,b.disabled=!1,O.disabled=!1}var z=X||[];z.push(function(){$(document).off("submit"),$("form").on("change",function(){let n=I.value,e=y.value,t=U.value;R.length>0&&n!==""&&e!==""&&t!==""&&(S.disabled=!1,S.classList.remove("disabled"))}),$("form").on("submit",function(n){return h(this,null,function*(){n.preventDefault();let e=$(this),t=I.value,l=y.value,r=U.value,_=b.value,a=O.value,s=D();if(s)if(R.length>0&&t!==""&&l!==""&&r!==""){let o={gyms:[...R.map(c=>({gym_id:parseInt(c)}))],name:t,email:l,password:r,phone_number:_.trim()===""?null:_,role:a},i=yield E(L,"POST",o,s);if(i.isFetchOk!==void 0&&!i.isFetchOk){console.error(i.message),S.disabled=!1,S.classList.remove("disabled");return}w()}else R.length===0?e[0][0].style.borderColor="red":e[0][0].style.borderColor="black",t.trim()===""?e[0][1].style.borderColor="red":e[0][1].style.borderColor="black",l.trim()===""?e[0][2].style.borderColor="red":e[0][2].style.borderColor="black",r.trim()===""?e[0][3].style.borderColor="red":e[0][2].style.borderColor="black",e.siblings(".w-form-done").hide().siblings(".w-form-fail").show().text("Please fill out all (required) fields");else f(`${g}?reason=NOT_SIGNED_IN`)})})});
