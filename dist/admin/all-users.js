var d=(t,n,e)=>new Promise((r,_)=>{var c=o=>{try{a(e.next(o))}catch(i){_(i)}},l=o=>{try{a(e.throw(o))}catch(i){_(i)}},a=o=>o.done?r(o.value):Promise.resolve(o.value).then(c,l);a((e=e.apply(t,n)).next())});var m={ADMIN:"ADMIN",SUPER_ADMIN:"SUPER_ADMIN",COACH:"COACH"};function E(t,n="GET",e=!1,r=!1,_=!1,c=!0){try{let l={"Content-Type":"application/json"};_&&(l={}),r&&(l.Authorization=`Bearer ${r}`);let a={method:n,headers:l};return e&&(c?a.body=JSON.stringify(e):a.body=e),fetch(t,a).then(o=>o.ok?o.json():o.json().then(i=>(Promise.reject(i.message),{isFetchOk:!1,status:o.status,message:i.message,payload:i&&i.payload?i.payload:null}))).then(o=>o).catch(o=>(console.error("Error in fetch",o),o))}catch(l){return console.error("Error!: "+l),l}}function S(t="nammax_auth"){let e=`; ${document.cookie}`.split(`; ${t}=`);return e.length===2?e.pop().split(";").shift():null}function u(t="/",n=2e3){setTimeout(()=>{window.location.href=t},n)}function y(t=null){if(t==null)return"NaN";let n=t.split("-"),e=Date.now()-new Date(parseInt(n[2]),parseInt(n[1])-1,parseInt(n[0])).getTime(),r=new Date(e);return Math.abs(r.getUTCFullYear()-1970)}function D(t="/admin/sign-in",n="sidebar-logout-btn"){let e=document.getElementById(n);e?e.onclick=()=>X(t):console.error("Logout button not found")}function X(t="/sign-in"){window.localStorage.removeItem("auth"),u(`${t}`)}function L(t=m.ADMIN){if(t===m.ADMIN){let n=document.getElementById("admin-nav"),e=document.getElementById("super-admin-nav");n&&(n.style.display="flex"),e&&e.remove()}else if(t===m.SUPER_ADMIN){let n=document.getElementById("admin-nav"),e=document.getElementById("super-admin-nav");e&&(e.style.display="flex"),n&&n.remove()}}function C(){let t=document.getElementById("loading-screen");t?t.remove():console.log("did not find loading screen")}function w({mode:t="API",clientObjRefName:n="name",data:e,token:r,API:_,extraXanoInputObj:c=[],searchContainerElId:l=""},a,o=null,i=null){let s,f,N;if(l.length>0){let x=document.getElementById(l);s=x.querySelector("#search-input"),s.setAttribute("placeholder","Search"),f=x.querySelector("#search-btn"),N=x.querySelector("#search-reset-btn")}else s=document.getElementById("search-input"),s.setAttribute("placeholder","Search"),f=document.getElementById("search-btn"),N=document.getElementById("search-reset-btn");N.onclick=()=>{s.value="",T(N,{mode:t,clientObjRefName:n,data:e,searchquery:"",token:r,API:_,extraXanoInputObj:c},a,o,i)},f.onclick=()=>{let x=s.value;T(N,{mode:t,clientObjRefName:n,data:e,searchquery:x,token:r,API:_,extraXanoInputObj:c},a,o,i)}}function T(f,N,x,tt,et){return d(this,arguments,function*(t,{mode:n,clientObjRefName:e,data:r,searchquery:_,token:c,API:l,extraXanoInputObj:a=[]},o,i,s){if(_.length===0)t.style.display="none",i?o(r,i):o(r);else try{if(n==="API"){let p={search_query:`${_}:*`};a.length>0&&a.map(B=>{for(let[k,b]of Object.entries(B))p[k]=b});let A=yield E(l+"query","POST",p,c);if(A.isFetchOk!==void 0&&!A.isFetchOk)throw console.error(A.message),Error("API call failed");t.style.display="flex",i?o(A,i):o(A)}else{let p=r.filter(A=>A[e].toLowerCase().includes(_.toLowerCase()));t.style.display="flex",i?o(p,i):o(p)}}catch(p){s?s():console.error(p)}})}var R="/admin/sign-in";var g="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/super_admin/all_users";var M="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/super_admin/dashboard/search/";var I=null,O=0,h=[];window.onload=function(){return d(this,null,function*(){D(R,"sidebar-logout-btn");let t=S();if(t){let n=yield E(g+"/1","GET",!1,t);if(n.isFetchOk!==void 0&&!n.isFetchOk){console.error(n.message),n.payload&&n.payload.role===m.ADMIN&&n.payload.gyms&&n.payload.gyms.length>0?u(`/admin/gym/g?gymCode=${n.payload.gyms[0].gym_id}`):u(`${R}?reason=UNAUTHORIZED_USER`);return}L(m.SUPER_ADMIN),v(n,t)}else u(`${R}?reason=NOT_SIGNED_IN`)})};function v(t,n){return d(this,null,function*(){U(t),w({data:t,token:n,API:M},U),C()})}function U(t,n=!1){let e=document.getElementById("table-container"),r=e.querySelector("#table-item");function _(c){I=c.nextPage;let l=e.querySelectorAll(".adb-user.w-inline-block");l.forEach((a,o)=>{o!==l.length-1&&a.remove()}),h.items.forEach((a,o)=>{let i=r.cloneNode(!0);i.setAttribute("id",""),i.setAttribute("href",`/admin/user?userId=${a.id}`);let s=i.querySelectorAll(".colcontent");o%2===0&&(i.style.backgroundColor="#00edf4"),a.profile_picture&&(s[0].style.backgroundImage=`url(${a.profile_picture.url})`),s[1].innerText=a.name,s[2].innerText=a.code,s[3].innerText="NaN",s[4].innerText=a.gender.charAt(0),s[5].innerText=y(a.date_of_birth),s[6].innerText="NaN",i.style.display="flex",e.prepend(i)})}n?(h.items.push(...t.items),h.nextPage=t.nextPage):h=t,_(h),r.style.display="none"}var K=new IntersectionObserver(t=>{t[0].intersectionRatio<=0||(O>0&&I?H(I):O<1&&O++)});K.observe(document.querySelector(".loadmore"));function H(t){return d(this,null,function*(){let n=S();if(n){let e=yield E(g+`/${t}`,"GET",!1,n);if(e.isFetchOk!==void 0&&!e.isFetchOk){console.error(e.message),e.payload&&e.payload.role===m.ADMIN&&e.payload.gyms&&e.payload.gyms.length>0?u(`/admin/gym/g?gymCode=${e.payload.gyms[0].gym_id}`):console.log("error fetching paginated");return}U(e,!0)}})}
