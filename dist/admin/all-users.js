var d=(n,e,t)=>new Promise((r,_)=>{var c=o=>{try{a(t.next(o))}catch(i){_(i)}},l=o=>{try{a(t.throw(o))}catch(i){_(i)}},a=o=>o.done?r(o.value):Promise.resolve(o.value).then(c,l);a((t=t.apply(n,e)).next())});var m={ADMIN:"ADMIN",SUPER_ADMIN:"SUPER_ADMIN",COACH:"COACH"};function E(n,e="GET",t=!1,r=!1,_=!1,c=!0){try{let l={"Content-Type":"application/json"};_&&(l={}),r&&(l.Authorization=`Bearer ${r}`);let a={method:e,headers:l};return t&&(c?a.body=JSON.stringify(t):a.body=t),fetch(n,a).then(o=>o.ok?o.json():o.json().then(i=>(Promise.reject(i.message),{isFetchOk:!1,status:o.status,message:i.message,payload:i&&i.payload?i.payload:null}))).then(o=>o).catch(o=>(console.error("Error in fetch",o),o))}catch(l){return console.error("Error!: "+l),l}}function S(n="nammax_auth"){let t=`; ${document.cookie}`.split(`; ${n}=`);return t.length===2?t.pop().split(";").shift():null}function u(n="/",e=0){setTimeout(()=>{window.location.href=n},e)}function y(n=null){if(n==null)return"NaN";let e=n.split("-"),t=Date.now()-new Date(parseInt(e[2]),parseInt(e[1])-1,parseInt(e[0])).getTime(),r=new Date(t);return Math.abs(r.getUTCFullYear()-1970)}function D(n="/admin/sign-in",e="sidebar-logout-btn"){let t=document.getElementById(e);t?t.onclick=()=>b(n):console.error("Logout button not found")}function b(n="/sign-in"){window.localStorage.removeItem("auth"),u(`${n}`)}function L(n=m.ADMIN){if(n===m.ADMIN){let e=document.getElementById("admin-nav"),t=document.getElementById("super-admin-nav");e&&(e.style.display="flex"),t&&t.remove()}else if(n===m.SUPER_ADMIN){let e=document.getElementById("admin-nav"),t=document.getElementById("super-admin-nav");t&&(t.style.display="flex"),e&&e.remove()}}function T({mode:n="API",clientObjRefName:e="name",data:t,token:r,API:_,extraXanoInputObj:c=[],searchContainerElId:l=""},a,o=null,i=null){let s,f,N;if(l.length>0){let x=document.getElementById(l);s=x.querySelector("#search-input"),s.setAttribute("placeholder","Search"),f=x.querySelector("#search-btn"),N=x.querySelector("#search-reset-btn")}else s=document.getElementById("search-input"),s.setAttribute("placeholder","Search"),f=document.getElementById("search-btn"),N=document.getElementById("search-reset-btn");N.onclick=()=>{s.value="",C(N,{mode:n,clientObjRefName:e,data:t,searchquery:"",token:r,API:_,extraXanoInputObj:c},a,o,i)},f.onclick=()=>{let x=s.value;C(N,{mode:n,clientObjRefName:e,data:t,searchquery:x,token:r,API:_,extraXanoInputObj:c},a,o,i)}}function C(f,N,x,Z,tt){return d(this,arguments,function*(n,{mode:e,clientObjRefName:t,data:r,searchquery:_,token:c,API:l,extraXanoInputObj:a=[]},o,i,s){if(_.length===0)n.style.display="none",i?o(r,i):o(r);else try{if(e==="API"){let p={search_query:`${_}:*`};a.length>0&&a.map(M=>{for(let[B,k]of Object.entries(M))p[B]=k});let A=yield E(l+"query","POST",p,c);if(A.isFetchOk!==void 0&&!A.isFetchOk)throw console.error(A.message),Error("API call failed");n.style.display="flex",i?o(A,i):o(A)}else{let p=r.filter(A=>A[t].toLowerCase().includes(_.toLowerCase()));n.style.display="flex",i?o(p,i):o(p)}}catch(p){s?s():console.error(p)}})}var R="/admin/sign-in";var g="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/super_admin/all_users";var w="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/super_admin/dashboard/search/";var I=null,O=0,h=[];window.onload=function(){return d(this,null,function*(){D(R,"sidebar-logout-btn");let n=S();if(n){let e=yield E(g+"/1","GET",!1,n);if(e.isFetchOk!==void 0&&!e.isFetchOk){console.error(e.message),e.payload&&e.payload.role===m.ADMIN&&e.payload.gyms&&e.payload.gyms.length>0?u(`/admin/gym/g?gymCode=${e.payload.gyms[0].gym_id}`):u(`${R}?reason=UNAUTHORIZED_USER`);return}L(m.SUPER_ADMIN),X(e,n)}else u(`${R}?reason=NOT_SIGNED_IN`)})};function X(n,e){return d(this,null,function*(){U(n),T({data:n,token:e,API:w},U)})}function U(n,e=!1){let t=document.getElementById("table-container"),r=t.querySelector("#table-item");function _(c){I=c.nextPage;let l=t.querySelectorAll(".adb-user.w-inline-block");l.forEach((a,o)=>{o!==l.length-1&&a.remove()}),h.items.forEach((a,o)=>{let i=r.cloneNode(!0);i.setAttribute("id",""),i.setAttribute("href",`/admin/user?userId=${a.id}`);let s=i.querySelectorAll(".colcontent");o%2===0&&(i.style.backgroundColor="#00edf4"),a.profile_picture&&(s[0].style.backgroundImage=`url(${a.profile_picture.url})`),s[1].innerText=a.name,s[2].innerText=a.code,s[3].innerText="NaN",s[4].innerText=a.gender.charAt(0),s[5].innerText=y(a.date_of_birth),s[6].innerText="NaN",i.style.display="flex",t.prepend(i)})}e?(h.items.push(...n.items),h.nextPage=n.nextPage):h=n,_(h),r.style.display="none"}var K=new IntersectionObserver(n=>{n[0].intersectionRatio<=0||(O>0&&I?v(I):O<1&&O++)});K.observe(document.querySelector(".loadmore"));function v(n){return d(this,null,function*(){let e=S();if(e){let t=yield E(g+`/${n}`,"GET",!1,e);if(t.isFetchOk!==void 0&&!t.isFetchOk){console.error(t.message),t.payload&&t.payload.role===m.ADMIN&&t.payload.gyms&&t.payload.gyms.length>0?u(`/admin/gym/g?gymCode=${t.payload.gyms[0].gym_id}`):console.log("error fetching paginated");return}U(t,!0)}})}
