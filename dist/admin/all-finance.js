var C=Object.defineProperty,b=Object.defineProperties;var B=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var g=(e,a,t)=>a in e?C(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,A=(e,a)=>{for(var t in a||={})M.call(a,t)&&g(e,t,a[t]);if(R)for(var t of R(a))X.call(a,t)&&g(e,t,a[t]);return e},f=(e,a)=>b(e,B(a));var O=(e,a,t)=>new Promise((x,p)=>{var s=o=>{try{_(t.next(o))}catch(n){p(n)}},r=o=>{try{_(t.throw(o))}catch(n){p(n)}},_=o=>o.done?x(o.value):Promise.resolve(o.value).then(s,r);_((t=t.apply(e,a)).next())});var N=["January","February","March","April","May","June","July","August","September","October","November","December"],c={ADMIN:"ADMIN",SUPER_ADMIN:"SUPER_ADMIN",COACH:"COACH"};function S(e,a="GET",t=!1,x=!1,p=!1,s=!0){try{let r={"Content-Type":"application/json"};p&&(r={}),x&&(r.Authorization=`Bearer ${x}`);let _={method:a,headers:r};return t&&(s?_.body=JSON.stringify(t):_.body=t),fetch(e,_).then(o=>o.ok?o.json():o.json().then(n=>(Promise.reject(n.message),{isFetchOk:!1,status:o.status,message:n.message,payload:n&&n.payload?n.payload:null}))).then(o=>o).catch(o=>(console.error("Error in fetch",o),o))}catch(r){return console.error("Error!: "+r),r}}function I(e="nammax_auth"){let t=`; ${document.cookie}`.split(`; ${e}=`);return t.length===2?t.pop().split(";").shift():null}function u(e="/",a=2e3){setTimeout(()=>{window.location.href=e},a)}function D(e="/admin/sign-in",a="sidebar-logout-btn"){let t=document.getElementById(a);t?t.onclick=()=>j(e):console.error("Logout button not found")}function j(e="/sign-in"){window.localStorage.removeItem("auth"),u(`${e}`)}function m(e=0){return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(Number(e)).replace(/^(\D+)/,"$1 ")}function U(e=c.ADMIN){if(e===c.ADMIN){let a=document.getElementById("admin-nav"),t=document.getElementById("super-admin-nav");a&&(a.style.display="flex"),t&&t.remove()}else if(e===c.SUPER_ADMIN){let a=document.getElementById("admin-nav"),t=document.getElementById("super-admin-nav");t&&(t.style.display="flex"),a&&a.remove()}}function T(){let e=document.getElementById("loading-screen");e?e.remove():console.error("did not find loading screen")}var E="/admin/sign-in";var y="https://xoxo-jnzf-s0on.m2.xano.io/api:Kml2N_BA/super_admin/all_finance";var z="https://www.nammacrossfit.com",L=z;var P=`${L}/sign-up-2`;var $=`${L}/user/dashboard`;(()=>{let e;window.onload=function(){return O(this,null,function*(){D("/admin/sign-in","sidebar-logout-btn");let s=I();if(s){let r=yield S(y,"GET",!1,s);if(r.isFetchOk!==void 0&&!r.isFetchOk){console.error(r.message),r.payload&&r.payload.role===c.ADMIN&&r.payload.gyms&&r.payload.gyms.length>0?u(`/admin/gym/g?gymCode=${r.payload.gyms[0].gym_id}`):u(`${E}?reason=UNAUTHORIZED_USER`);return}U(c.SUPER_ADMIN),a(r)}else u(`${E}?reason=NOT_SIGNED_IN`)})};function a(s){let{finance:r,external_finance:_}=s,o={};r.forEach(l=>{let i=l.month+","+l.year;o[i]===void 0?o[i]=l:o[i]=f(A({},o[i]),{external_additional_revenue:0,external_additional_expenses:0,gross_revenue:l.fixed_expense})});let n=A({},o);_.forEach(l=>{let i=l.month+","+l.year;n[i]!==void 0?n[i]=f(A({},n[i]),{external_additional_revenue:Number(l.credit||0)+Number(n[i].external_additional_revenue||0),external_additional_expenses:Number(l.debit||0)+Number(n[i].external_additional_expenses||0)}):n[i]=l});let d=Object.keys(n).sort((l,i)=>i.created_at-l.created_at);x(n),t(n,d),p(n,d),T()}function t(s,r){let _=document.getElementById("financial-data-container"),o=_.querySelector("#financial-data-item");r.forEach(n=>{let[d,l]=n.split(","),i=o.cloneNode(!0);i.setAttribute("id",""),i.setAttribute("href","/admin/all-financial-month?month="+d+"&year="+l),i.querySelector("#financial-data-month ").innerText=N[d-1],i.querySelector("#financial-data-year ").innerText=l,i.querySelector("#financial-data-revenue").innerText=m(Number(s[n].fixed_expense||0)+Number(s[n].external_additional_revenue||0)),i.querySelector("#financial-data-expenses").innerText=m(Number(s[n].external_additional_expenses||0));let h=Number(s[n].fixed_expense||0)+Number(s[n].external_additional_revenue||0)-Number(s[n].external_additional_expenses||0);i.querySelector("#financial-data-profit").innerText=m(h||0),h<0?(i.querySelector("#financial-indicator").classList.add("is-loss"),i.querySelector("#financial-data-profit").style.color="#ff634e"):i.querySelector("#financial-indicator").classList.add("is-profitable"),_.prepend(i)}),o.remove()}function x(s){let r=new Date().getMonth()+1,_=new Date().getFullYear();if(e=s[r+","+_],e===void 0&&(e=null),!e)document.getElementById("gym-financial-month").innerText="This months",document.getElementById("gym-financial-year").innerText="data not found",document.getElementById("financial-expenses").innerText="No data found",document.getElementById("financial-revenue").innerText="No data found",document.getElementById("financial-profit").innerText="No data found";else{document.getElementById("gym-statistics-month-year").innerText=`${N[e.month-1]}  ${e.year}`||"-",document.getElementById("financial-expenses").innerText=m(Number(e.external_additional_expenses||0)),document.getElementById("financial-revenue").innerText=m(Number(e.fixed_expense||0)+Number(e.external_additional_revenue||0));let o=Number(e.fixed_expense||0)+Number(e.external_additional_revenue||0)-Number(e.external_additional_expenses||0);document.querySelector("#financial-profit").innerText=m(o||0)}}function p(s,r){let _=document.getElementById("finance-chart").getContext("2d"),o=[...r.map(n=>N[n.split(",")[0]-1])];new Chart(_,{type:"bar",data:{labels:o,datasets:[{label:"Profit",data:[...r.map(n=>Number(s[n].fixed_expense)+Number(s[n].external_additional_revenue)-Number(s[n].external_additional_expenses)<=0?0:Number(s[n].fixed_expense)+Number(s[n].external_additional_revenue)-Number(s[n].external_additional_expenses))],backgroundColor:["#E0FFC1"]},{label:"Expenses",data:[...r.map(n=>Number(s[n].fixed_expense)+Number(s[n].external_additional_revenue)-Number(s[n].external_additional_expenses)<=0?-Number(s[n].external_additional_expenses):0)],backgroundColor:["#ff0000"]}]},options:{scales:{x:{grid:{display:!1},stacked:!0},y:{grid:{display:!1},stacked:!0}}}})}})();
