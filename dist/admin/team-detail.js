var D=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var T=(t,o)=>{var e={};for(var n in t)W.call(t,n)&&o.indexOf(n)<0&&(e[n]=t[n]);if(t!=null&&D)for(var n of D(t))o.indexOf(n)<0&&Y.call(t,n)&&(e[n]=t[n]);return e};var x=(t,o,e)=>new Promise((n,a)=>{var r=i=>{try{l(e.next(i))}catch(s){a(s)}},c=i=>{try{l(e.throw(i))}catch(s){a(s)}},l=i=>i.done?n(i.value):Promise.resolve(i.value).then(r,c);l((e=e.apply(t,o)).next())});var u={ADMIN:"ADMIN",SUPER_ADMIN:"SUPER_ADMIN",COACH:"COACH"};function E(t,o="GET",e=!1,n=!1,a=!1,r=!0){try{let c={"Content-Type":"application/json"};a&&(c={}),n&&(c.Authorization=`Bearer ${n}`);let l={method:o,headers:c};return e&&(r?l.body=JSON.stringify(e):l.body=e),fetch(t,l).then(i=>i.ok?i.json():i.json().then(s=>(Promise.reject(s.message),{isFetchOk:!1,status:i.status,message:s.message,payload:s&&s.payload?s.payload:null}))).then(i=>i).catch(i=>(console.error("Error in fetch",i),i))}catch(c){return console.error("Error!: "+c),c}}function S(t="nammax_auth"){let e=`; ${document.cookie}`.split(`; ${t}=`);return e.length===2?e.pop().split(";").shift():null}function h(t="/",o=0){setTimeout(()=>{window.location.href=t},o)}function L(t=null,o=!1){if(t==null)return"NaN";var e=new Date(t),n=e.getHours(),a=n>=12?"PM":"AM";if(n=n%12||12,o){var r=e.getMinutes();return r=r<10?`0${r}`:r,`${n}:${r} ${a}`}else return`${n} ${a}`}function C(t=null){if(t==null)return"NaN";let o=new Date(t);return`${o.getDate()}/${o.getMonth()+1}/${o.getFullYear()}`}function w(t,o=null){if(t!=null){var e,n=t.options.length-1;for(e=n;e>=0;e--)e!==o&&t.remove(e)}}function M(t="/admin/sign-in",o="sidebar-logout-btn"){let e=document.getElementById(o);e?e.onclick=()=>q(t):console.error("Logout button not found")}function q(t="/sign-in"){window.localStorage.removeItem("auth"),h(`${t}`)}function b(t=u.ADMIN){if(t===u.ADMIN){let o=document.getElementById("admin-nav"),e=document.getElementById("super-admin-nav");o&&(o.style.display="flex"),e&&e.remove()}else if(t===u.SUPER_ADMIN){let o=document.getElementById("admin-nav"),e=document.getElementById("super-admin-nav");e&&(e.style.display="flex"),o&&o.remove()}}function B(){let t=document.getElementById("loading-screen");t&&(t.style.display="none")}function X({mode:t="API",clientObjRefName:o="name",data:e,token:n,API:a,extraXanoInputObj:r=[],searchContainerElId:c=""},l,i=null,s=null){let _,m,p;if(c.length>0){let d=document.getElementById(c);_=d.querySelector("#search-input"),_.setAttribute("placeholder","Search"),m=d.querySelector("#search-btn"),p=d.querySelector("#search-reset-btn")}else _=document.getElementById("search-input"),_.setAttribute("placeholder","Search"),m=document.getElementById("search-btn"),p=document.getElementById("search-reset-btn");p.onclick=()=>{_.value="",k(p,{mode:t,clientObjRefName:o,data:e,searchquery:"",token:n,API:a,extraXanoInputObj:r},l,i,s)},m.onclick=()=>{let d=_.value;k(p,{mode:t,clientObjRefName:o,data:e,searchquery:d,token:n,API:a,extraXanoInputObj:r},l,i,s)}}function k(m,p,d,ut,At){return x(this,arguments,function*(t,{mode:o,clientObjRefName:e,data:n,searchquery:a,token:r,API:c,extraXanoInputObj:l=[]},i,s,_){if(a.length===0)t.style.display="none",s?i(n,s):i(n);else try{if(o==="API"){let A={search_query:`${a}:*`};l.length>0&&l.map(P=>{for(let[G,F]of Object.entries(P))A[G]=F});let N=yield E(c+"query","POST",A,r);if(N.isFetchOk!==void 0&&!N.isFetchOk)throw console.error(N.message),Error("API call failed");t.style.display="flex",s?i(N,s):i(N)}else{let A=n.filter(N=>N[e].toLowerCase().includes(a.toLowerCase()));t.style.display="flex",s?i(A,s):i(A)}}catch(A){_?_():console.error(A)}})}var v=Webflow||[];var R="/admin/sign-in";var I="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/admin/team_detail/",K="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/admin/team_detail/search/";var g,H,y=null,O=0,f=[];window.onload=function(){return x(this,null,function*(){M(R,"sidebar-logout-btn");var t=new URL(document.location.href);if(g=t.searchParams.get("teamId")||null,!g){console.error("No team id found");return}let o=S();if(o){let n=yield E(I+g+"/1","GET",!1,o);if(n.isFetchOk!==void 0&&!n.isFetchOk){console.error(n.message);return}let e=n,{team_role:a}=e,r=T(e,["team_role"]);a&&(a===u.SUPER_ADMIN||a===u.ADMIN)?(b(a),j(r,o)):h(`${R}?reason=UNAUTHORIZED_USER`)}else h(`${R}?reason=NOT_SIGNED_IN`)})};function j(t,o){return x(this,null,function*(){let{sessions:e,team:n}=t;if(n.gyms.length>0&&n.gyms[0].gym_id)H=n.gyms[0].gym_id;else{console.error("No gym id found");return}z(n),U(e,n.name),X({data:e,token:o,API:K,extraXanoInputObj:[{team_id:n.id}]},U,n.name),B()})}function z(t){var n;$("#team-detail-name").text(t.name),$("#team-detail-email").text(t.email),$("#team-detail-gender").text("NaN"),$("#team-detail-number").text(t.contact_number),$("#team-detail-dob").text("NaN");let o=document.getElementById("team-detail-gym");if(w(o),t.gyms.length===0){var e=document.createElement("option");e.value="No gyms",e.innerText="No gyms",o.appendChild(e)}else(n=t==null?void 0:t.gyms)==null||n.forEach(a=>{var r=document.createElement("option");r.value=a.id,r.innerText=a.location,o.appendChild(r)})}function U(t,o,e=!1){let n=document.getElementById("table-container"),a=n.querySelector("#table-item");function r(c){y=c.nextPage;let l=n.querySelectorAll(".adb-user.w-inline-block");l.forEach((i,s)=>{s!==l.length-1&&i.remove()}),f.items.forEach((i,s)=>{var p,d;let _=a.cloneNode(!0);_.setAttribute("id",""),_.setAttribute("href",`/admin/session?sessionId=${i.id}`);let m=_.querySelectorAll(".colcontent");s%2===0&&(_.style.backgroundColor="#00edf4"),m[1].innerText=i.session_name,m[2].innerText=o,m[3].innerText=i.code,m[4].innerText=C(i.time),m[5].innerText=L(i.time,!0),m[6].innerText=(d=(p=i==null?void 0:i.users)==null?void 0:p.length)!=null?d:0,m[7].innerText=i.status,_.style.display="flex",n.prepend(_)})}e?(f.items.push(...t.items),f.nextPage=t.nextPage):f=t,r(f),a.style.display="none"}var J=new IntersectionObserver(t=>{t[0].intersectionRatio<=0||(O>0&&y?Q(y):O<1&&O++)});J.observe(document.querySelector(".loadmore"));function Q(t){return x(this,null,function*(){let o=S();if(o){let e=yield E(I+g+`/${t}`,"GET",!1,o);if(e.isFetchOk!==void 0&&!e.isFetchOk){console.error(e.message),e.payload&&e.payload.role===u.ADMIN&&e.payload.gyms&&e.payload.gyms.length>0?h(`/admin/gym/g?gymCode=${e.payload.gyms[0].gym_id}`):console.log("error fetching paginated");return}let{sessions:n,team:a}=e;U(n,a.name,!0)}})}var V=v||[];V.push(function(){$(document).off("submit"),$("form").on("submit",function(t){return x(this,null,function*(){t.preventDefault(),$(this).attr("id")==="team-detail-form-block"&&console.log(H)})})});
