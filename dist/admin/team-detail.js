var T=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var L=(e,n)=>{var t={};for(var s in e)W.call(e,s)&&n.indexOf(s)<0&&(t[s]=e[s]);if(e!=null&&T)for(var s of T(e))n.indexOf(s)<0&&Y.call(e,s)&&(t[s]=e[s]);return t};var x=(e,n,t)=>new Promise((s,a)=>{var i=o=>{try{r(t.next(o))}catch(c){a(c)}},l=o=>{try{r(t.throw(o))}catch(c){a(c)}},r=o=>o.done?s(o.value):Promise.resolve(o.value).then(i,l);r((t=t.apply(e,n)).next())});var p={ADMIN:"ADMIN",SUPER_ADMIN:"SUPER_ADMIN",COACH:"COACH"};function f(e,n="GET",t=!1,s=!1,a=!1,i=!0){try{let l={"Content-Type":"application/json"};a&&(l={}),s&&(l.Authorization=`Bearer ${s}`);let r={method:n,headers:l};return t&&(i?r.body=JSON.stringify(t):r.body=t),fetch(e,r).then(o=>o.ok?o.json():o.json().then(c=>(Promise.reject(c.message),{isFetchOk:!1,status:o.status,message:c.message,payload:c&&c.payload?c.payload:null}))).then(o=>o).catch(o=>(console.error("Error in fetch",o),o))}catch(l){return console.error("Error!: "+l),l}}function S(e="nammax_auth"){let t=`; ${document.cookie}`.split(`; ${e}=`);return t.length===2?t.pop().split(";").shift():null}function h(e="/",n=2e3){setTimeout(()=>{window.location.href=e},n)}function C(e=1e3){setTimeout(()=>{window.location.reload()},e)}function M(e=null,n=!1,t=!1,s=!1){if(e==null)return"NaN";let a=new Date,i=new Date(e),l=i.getHours(),r="";if(s||(r=l>=12?"PM":"AM",l=l%12||12),n){let o=i.getMinutes();return o=o<10?`0${o}`:o,t?`${a.getDate()===i.getDate()?"Today At":a.getDate()+1===i.getDate()?"Tomorrow At":a.getDate()+2===i.getDate()?"Day After Tomorrow At":E(e)} ${l}:${o} ${r}`:`${l}:${o} ${r}`}else return t?`${a.getDate()===i.getDate()?"Today At":a.getDate()+1===i.getDate()?"Tomorrow At":a.getDate()+2===i.getDate()?"Day After Tomorrow At":E(e)} ${l} ${r}`:`${E(e)} ${l} ${r}`}function E(e=null){if(e==null)return"NaN";let n=new Date(e);return`${n.getDate()}/${n.getMonth()+1}/${n.getFullYear()}`}function b(e,n=null){if(e!=null){var t,s=e.options.length-1;for(t=s;t>=0;t--)t!==n&&e.remove(t)}}function B(e="/admin/sign-in",n="sidebar-logout-btn"){let t=document.getElementById(n);t?t.onclick=()=>q(e):console.error("Logout button not found")}function q(e="/sign-in"){window.localStorage.removeItem("auth"),h(`${e}`)}function v(e=p.ADMIN){if(e===p.ADMIN){let n=document.getElementById("admin-nav"),t=document.getElementById("super-admin-nav");n&&(n.style.display="flex"),t&&t.remove()}else if(e===p.SUPER_ADMIN){let n=document.getElementById("admin-nav"),t=document.getElementById("super-admin-nav");t&&(t.style.display="flex"),n&&n.remove()}}function X(){let e=document.getElementById("loading-screen");e?e.remove():console.log("did not find loading screen")}function j({mode:e="API",clientObjRefName:n="name",data:t,token:s,API:a,extraXanoInputObj:i=[],searchContainerElId:l=""},r,o=null,c=null){let _,m,u;if(l.length>0){let d=document.getElementById(l);_=d.querySelector("#search-input"),_.setAttribute("placeholder","Search"),m=d.querySelector("#search-btn"),u=d.querySelector("#search-reset-btn")}else _=document.getElementById("search-input"),_.setAttribute("placeholder","Search"),m=document.getElementById("search-btn"),u=document.getElementById("search-reset-btn");u.onclick=()=>{_.value="",w(u,{mode:e,clientObjRefName:n,data:t,searchquery:"",token:s,API:a,extraXanoInputObj:i},r,o,c)},m.onclick=()=>{let d=_.value;w(u,{mode:e,clientObjRefName:n,data:t,searchquery:d,token:s,API:a,extraXanoInputObj:i},r,o,c)}}function w(m,u,d,Ae,Ne){return x(this,arguments,function*(e,{mode:n,clientObjRefName:t,data:s,searchquery:a,token:i,API:l,extraXanoInputObj:r=[]},o,c,_){if(a.length===0)e.style.display="none",c?o(s,c):o(s);else try{if(n==="API"){let A={search_query:`${a}:*`};r.length>0&&r.map(G=>{for(let[F,k]of Object.entries(G))A[F]=k});let N=yield f(l+"query","POST",A,i);if(N.isFetchOk!==void 0&&!N.isFetchOk)throw console.error(N.message),Error("API call failed");e.style.display="flex",c?o(N,c):o(N)}else{let A=s.filter(N=>N[t].toLowerCase().includes(a.toLowerCase()));e.style.display="flex",c?o(A,c):o(A)}}catch(A){_?_():console.error(A)}})}var z=Webflow||[];var O="/admin/sign-in";var I="https://xoxo-jnzf-s0on.m2.xano.io/api:Kml2N_BA/admin/team_detail/",K="https://xoxo-jnzf-s0on.m2.xano.io/api:Kml2N_BA/admin/team_details/update_details",P="https://xoxo-jnzf-s0on.m2.xano.io/api:Kml2N_BA/admin/team_detail/search/";var R,H,D=null,y=0,g=[];window.onload=function(){return x(this,null,function*(){B(O,"sidebar-logout-btn");var e=new URL(document.location.href);if(R=e.searchParams.get("teamId")||null,!R){console.error("No team id found");return}let n=S();if(n){let s=yield f(I+R+"/1","GET",!1,n);if(s.isFetchOk!==void 0&&!s.isFetchOk){console.error(s.message);return}let t=s,{team_role:a}=t,i=L(t,["team_role"]);a&&(a===p.SUPER_ADMIN||a===p.ADMIN)?(v(a),J(i,n,a)):h(`${O}?reason=UNAUTHORIZED_USER`)}else h(`${O}?reason=NOT_SIGNED_IN`)})};function J(e,n,t){return x(this,null,function*(){let{sessions:s,team:a}=e;if(a.gyms.length>0&&a.gyms[0].gym_id)H=a.gyms[0].gym_id;else{console.error("No gym id found");return}let i=new Date,l=s.items.filter(r=>new Date(r.time).getMonth()===i.getMonth()&&new Date(r.time).getFullYear()===i.getFullYear());V(a,l,t,n),U(s,a.name),j({data:s,token:n,API:P,extraXanoInputObj:[{team_id:a.id}]},U,a.name),X()})}function V(e,n,t,s){var l;e.profile_picture&&$("#team-detail-pfp").css("background-image",`url(${e.profile_picture.url})`),$("#team-detail-name").text(e.name),$("#team-detail-email").text(e.email),$("#team-detail-number").text(e.phone_number),$("#total-monthly-sessions").text(n.length),t===p.ADMIN?($("#monthly-salary-container").remove(),$("#team-password-container").remove(),$("#team-detail-update-btn").remove()):t===p.SUPER_ADMIN&&($("#monthly-salary").val((e==null?void 0:e.salary)||"0"),$("#team-password-container").removeClass("hide"),$("#team-detail-update-btn").removeClass("hide"),$("#team-detail-update-btn").click(()=>x(this,null,function*(){if($("#team-detail-update-btn").prop("disabled",!0),$("#team-detail-update-btn").prop("value","Updating"),$("#monthly-salary").val()&&$("#monthly-salary").val().trim()!==""){let r={team_id:R,salary:$("#monthly-salary").val()||0,password:$("#team-password").val()||null},o=yield f(K,"POST",r,s);if(o.isFetchOk!==void 0&&!o.isFetchOk){console.error(o.message),$("#team-detail-update-btn").prop("disabled",!1),$("#team-detail-update-btn").prop("value","Failed to Update");return}C()}})));let a=document.getElementById("team-detail-gym");if(b(a),e.gyms.length===0){var i=document.createElement("option");i.value="No gyms",i.innerText="No gyms",a.appendChild(i)}else(l=e==null?void 0:e.gyms)==null||l.forEach(r=>{var o=document.createElement("option");o.value=r.id,o.innerText=r.location,a.appendChild(o)})}function U(e,n,t=!1){let s=document.getElementById("table-container"),a=s.querySelector("#table-item");function i(l){D=l.nextPage;let r=s.querySelectorAll(".adb-user.w-inline-block");r.forEach((o,c)=>{c!==r.length-1&&o.remove()}),g.items.forEach((o,c)=>{var u,d;let _=a.cloneNode(!0);_.setAttribute("id",""),_.setAttribute("href",`/admin/session?sessionId=${o.id}`);let m=_.querySelectorAll(".colcontent");c%2===0&&(_.style.backgroundColor="#00edf4"),m[1].innerText=o.session_name,m[2].innerText=n,m[3].innerText=o.code,m[4].innerText=E(o.time),m[5].innerText=M(o.time,!0),m[6].innerText=(d=(u=o==null?void 0:o.users)==null?void 0:u.length)!=null?d:0,m[7].innerText=o.status,_.style.display="flex",s.prepend(_)})}t?(g.items.push(...e.items),g.nextPage=e.nextPage):g=e,i(g),a.style.display="none"}var Q=new IntersectionObserver(e=>{e[0].intersectionRatio<=0||(y>0&&D?Z(D):y<1&&y++)});Q.observe(document.querySelector(".loadmore"));function Z(e){return x(this,null,function*(){let n=S();if(n){let t=yield f(I+R+`/${e}`,"GET",!1,n);if(t.isFetchOk!==void 0&&!t.isFetchOk){console.error(t.message),t.payload&&t.payload.role===p.ADMIN&&t.payload.gyms&&t.payload.gyms.length>0?h(`/admin/gym/g?gymCode=${t.payload.gyms[0].gym_id}`):console.log("error fetching paginated");return}let{sessions:s,team:a}=t;U(s,a.name,!0)}})}var ee=z||[];ee.push(function(){$(document).off("submit"),$("form").on("submit",function(e){return x(this,null,function*(){e.preventDefault(),$(this).attr("id")==="team-detail-form-block"&&console.log(H)})})});
