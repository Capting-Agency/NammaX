var N=(t,e,n)=>new Promise((s,l)=>{var _=o=>{try{i(n.next(o))}catch(a){l(a)}},c=o=>{try{i(n.throw(o))}catch(a){l(a)}},i=o=>o.done?s(o.value):Promise.resolve(o.value).then(_,c);i((n=n.apply(t,e)).next())});var p={ADMIN:"ADMIN",SUPER_ADMIN:"SUPER_ADMIN",COACH:"COACH"};function h(t,e="GET",n=!1,s=!1,l=!1,_=!0){try{let c={"Content-Type":"application/json"};l&&(c={}),s&&(c.Authorization=`Bearer ${s}`);let i={method:e,headers:c};return n&&(_?i.body=JSON.stringify(n):i.body=n),fetch(t,i).then(o=>o.ok?o.json():o.json().then(a=>(Promise.reject(a.message),{isFetchOk:!1,status:o.status,message:a.message,payload:a&&a.payload?a.payload:null}))).then(o=>o).catch(o=>(console.error("Error in fetch",o),o))}catch(c){return console.error("Error!: "+c),c}}function f(t="nammax_auth"){let n=`; ${document.cookie}`.split(`; ${t}=`);return n.length===2?n.pop().split(";").shift():null}function x(t="/",e=2e3){setTimeout(()=>{window.location.href=t},e)}function y(t=null,e=!1){if(t==null)return"NaN";var n=new Date(t),s=n.getHours(),l=s>=12?"PM":"AM";if(s=s%12||12,e){var _=n.getMinutes();return _=_<10?`0${_}`:_,`${s}:${_} ${l}`}else return`${s} ${l}`}function D(t=null){if(t==null)return"NaN";let e=new Date(t);return`${e.getDate()}/${e.getMonth()+1}/${e.getFullYear()}`}function L(t="/admin/sign-in",e="sidebar-logout-btn"){let n=document.getElementById(e);n?n.onclick=()=>v(t):console.error("Logout button not found")}function v(t="/sign-in"){window.localStorage.removeItem("auth"),x(`${t}`)}function T(t=p.ADMIN){if(t===p.ADMIN){let e=document.getElementById("admin-nav"),n=document.getElementById("super-admin-nav");e&&(e.style.display="flex"),n&&n.remove()}else if(t===p.SUPER_ADMIN){let e=document.getElementById("admin-nav"),n=document.getElementById("super-admin-nav");n&&(n.style.display="flex"),e&&e.remove()}}function C(){let t=document.getElementById("loading-screen");t?t.remove():console.log("did not find loading screen")}function M({mode:t="API",clientObjRefName:e="name",data:n,token:s,API:l,extraXanoInputObj:_=[],searchContainerElId:c=""},i,o=null,a=null){let r,u,m;if(c.length>0){let E=document.getElementById(c);r=E.querySelector("#search-input"),r.setAttribute("placeholder","Search"),u=E.querySelector("#search-btn"),m=E.querySelector("#search-reset-btn")}else r=document.getElementById("search-input"),r.setAttribute("placeholder","Search"),u=document.getElementById("search-btn"),m=document.getElementById("search-reset-btn");m.onclick=()=>{r.value="",w(m,{mode:t,clientObjRefName:e,data:n,searchquery:"",token:s,API:l,extraXanoInputObj:_},i,o,a)},u.onclick=()=>{let E=r.value;w(m,{mode:t,clientObjRefName:e,data:n,searchquery:E,token:s,API:l,extraXanoInputObj:_},i,o,a)}}function w(u,m,E,et,nt){return N(this,arguments,function*(t,{mode:e,clientObjRefName:n,data:s,searchquery:l,token:_,API:c,extraXanoInputObj:i=[]},o,a,r){if(l.length===0)t.style.display="none",a?o(s,a):o(s);else try{if(e==="API"){let A={search_query:`${l}:*`};i.length>0&&i.map(k=>{for(let[b,X]of Object.entries(k))A[b]=X});let d=yield h(c+"query","POST",A,_);if(d.isFetchOk!==void 0&&!d.isFetchOk)throw console.error(d.message),Error("API call failed");t.style.display="flex",a?o(d,a):o(d)}else{let A=s.filter(d=>d[n].toLowerCase().includes(l.toLowerCase()));t.style.display="flex",a?o(A,a):o(A)}}catch(A){r?r():console.error(A)}})}var R="/admin/sign-in";var g="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/super_admin/all_sessions",B="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/super_admin/all_sessions/search/";var I=null,O=0,S=[];window.onload=function(){return N(this,null,function*(){L(R,"sidebar-logout-btn");let t=f();if(t){let e=yield h(g+"/1","GET",!1,t);if(e.isFetchOk!==void 0&&!e.isFetchOk){console.error(e.message),e.payload&&e.payload.role===p.ADMIN&&e.payload.gyms&&e.payload.gyms.length>0?x(`/admin/gym/g?gymCode=${e.payload.gyms[0].gym_id}`):x(`${R}?reason=UNAUTHORIZED_USER`);return}T(p.SUPER_ADMIN),K(e,t)}else x(`${R}?reason=NOT_SIGNED_IN`)})};function K(t,e){return N(this,null,function*(){U(t),M({data:t,token:e,API:B},U),C()})}function U(t,e=!1){let n=document.getElementById("table-container"),s=n.querySelector("#table-item");function l(_){I=_.nextPage;let c=n.querySelectorAll(".adb-user.w-inline-block");c.forEach((i,o)=>{o!==c.length-1&&i.remove()}),S.items.forEach((i,o)=>{var u,m;let a=s.cloneNode(!0);a.setAttribute("id",""),a.setAttribute("href",`/admin/session?sessionId=${i.id}`);let r=a.querySelectorAll(".colcontent");o%2===0&&(a.style.backgroundColor="#00edf4"),r[1].innerText=i.session_name,r[2].innerText=i.name,r[3].innerText=i.code,r[4].innerText=D(i.time),r[5].innerText=y(i.time,!0),r[6].innerText=(m=(u=i==null?void 0:i.users)==null?void 0:u.length)!=null?m:0,r[7].innerText=i.status,a.style.display="flex",n.prepend(a)})}e?(S.items.push(...t.items),S.nextPage=t.nextPage):S=t,l(S),s.style.display="none"}var H=new IntersectionObserver(t=>{t[0].intersectionRatio<=0||(O>0&&I?P(I):O<1&&O++)});H.observe(document.querySelector(".loadmore"));function P(t){return N(this,null,function*(){let e=f();if(e){let n=yield h(g+`/${t}`,"GET",!1,e);if(n.isFetchOk!==void 0&&!n.isFetchOk){console.error(n.message),n.payload&&n.payload.role===p.ADMIN&&n.payload.gyms&&n.payload.gyms.length>0?x(`/admin/gym/g?gymCode=${n.payload.gyms[0].gym_id}`):console.log("error fetching paginated");return}U(n,!0)}})}
