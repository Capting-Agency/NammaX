var N=(t,e,n)=>new Promise((c,r)=>{var l=o=>{try{i(n.next(o))}catch(a){r(a)}},s=o=>{try{i(n.throw(o))}catch(a){r(a)}},i=o=>o.done?c(o.value):Promise.resolve(o.value).then(l,s);i((n=n.apply(t,e)).next())});var p={ADMIN:"ADMIN",SUPER_ADMIN:"SUPER_ADMIN",COACH:"COACH"};function h(t,e="GET",n=!1,c=!1,r=!1,l=!0){try{let s={"Content-Type":"application/json"};r&&(s={}),c&&(s.Authorization=`Bearer ${c}`);let i={method:e,headers:s};return n&&(l?i.body=JSON.stringify(n):i.body=n),fetch(t,i).then(o=>o.ok?o.json():o.json().then(a=>(Promise.reject(a.message),{isFetchOk:!1,status:o.status,message:a.message,payload:a&&a.payload?a.payload:null}))).then(o=>o).catch(o=>(console.error("Error in fetch",o),o))}catch(s){return console.error("Error!: "+s),s}}function R(t="nammax_auth"){let n=`; ${document.cookie}`.split(`; ${t}=`);return n.length===2?n.pop().split(";").shift():null}function x(t="/",e=2e3){setTimeout(()=>{window.location.href=t},e)}function U(t=null,e=!1,n=!1,c=!1){if(t==null)return"NaN";let r=new Date,l=new Date(t),s=l.getHours(),i="";if(c||(i=s>=12?"PM":"AM",s=s%12||12),e){let o=l.getMinutes();return o=o<10?`0${o}`:o,n?`${r.getDate()===l.getDate()?"Today":r.getDate()+1===l.getDate()?"Tomorrow":r.getDate()+2===l.getDate()?"Day After Tomorrow":""} ${s}:${o} ${i}`:`${s}:${o} ${i}`}else return n?`${r.getDate()===l.getDate()?"Today":r.getDate()+1===l.getDate()?"Tomorrow":r.getDate()+2===l.getDate()?"Day After Tomorrow":""} ${s} ${i}`:`${s} ${i}`}function y(t=null){if(t==null)return"NaN";let e=new Date(t);return`${e.getDate()}/${e.getMonth()+1}/${e.getFullYear()}`}function T(t="/admin/sign-in",e="sidebar-logout-btn"){let n=document.getElementById(e);n?n.onclick=()=>K(t):console.error("Logout button not found")}function K(t="/sign-in"){window.localStorage.removeItem("auth"),x(`${t}`)}function L(t=p.ADMIN){if(t===p.ADMIN){let e=document.getElementById("admin-nav"),n=document.getElementById("super-admin-nav");e&&(e.style.display="flex"),n&&n.remove()}else if(t===p.SUPER_ADMIN){let e=document.getElementById("admin-nav"),n=document.getElementById("super-admin-nav");n&&(n.style.display="flex"),e&&e.remove()}}function C(){let t=document.getElementById("loading-screen");t?t.remove():console.log("did not find loading screen")}function M({mode:t="API",clientObjRefName:e="name",data:n,token:c,API:r,extraXanoInputObj:l=[],searchContainerElId:s=""},i,o=null,a=null){let _,d,m;if(s.length>0){let E=document.getElementById(s);_=E.querySelector("#search-input"),_.setAttribute("placeholder","Search"),d=E.querySelector("#search-btn"),m=E.querySelector("#search-reset-btn")}else _=document.getElementById("search-input"),_.setAttribute("placeholder","Search"),d=document.getElementById("search-btn"),m=document.getElementById("search-reset-btn");m.onclick=()=>{_.value="",w(m,{mode:t,clientObjRefName:e,data:n,searchquery:"",token:c,API:r,extraXanoInputObj:l},i,o,a)},d.onclick=()=>{let E=_.value;w(m,{mode:t,clientObjRefName:e,data:n,searchquery:E,token:c,API:r,extraXanoInputObj:l},i,o,a)}}function w(d,m,E,et,nt){return N(this,arguments,function*(t,{mode:e,clientObjRefName:n,data:c,searchquery:r,token:l,API:s,extraXanoInputObj:i=[]},o,a,_){if(r.length===0)t.style.display="none",a?o(c,a):o(c);else try{if(e==="API"){let u={search_query:`${r}:*`};i.length>0&&i.map(k=>{for(let[b,X]of Object.entries(k))u[b]=X});let A=yield h(s+"query","POST",u,l);if(A.isFetchOk!==void 0&&!A.isFetchOk)throw console.error(A.message),Error("API call failed");t.style.display="flex",a?o(A,a):o(A)}else{let u=c.filter(A=>A[n].toLowerCase().includes(r.toLowerCase()));t.style.display="flex",a?o(u,a):o(u)}}catch(u){_?_():console.error(u)}})}var g="/admin/sign-in";var S="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/super_admin/all_sessions",B="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/super_admin/all_sessions/search/";var I=null,O=0,f=[];window.onload=function(){return N(this,null,function*(){T(g,"sidebar-logout-btn");let t=R();if(t){let e=yield h(S+"/1","GET",!1,t);if(e.isFetchOk!==void 0&&!e.isFetchOk){console.error(e.message),e.payload&&e.payload.role===p.ADMIN&&e.payload.gyms&&e.payload.gyms.length>0?x(`/admin/gym/g?gymCode=${e.payload.gyms[0].gym_id}`):x(`${g}?reason=UNAUTHORIZED_USER`);return}L(p.SUPER_ADMIN),H(e,t)}else x(`${g}?reason=NOT_SIGNED_IN`)})};function H(t,e){return N(this,null,function*(){D(t),M({data:t,token:e,API:B},D),C()})}function D(t,e=!1){let n=document.getElementById("table-container"),c=n.querySelector("#table-item");function r(l){I=l.nextPage;let s=n.querySelectorAll(".adb-user.w-inline-block");s.forEach((i,o)=>{o!==s.length-1&&i.remove()}),f.items.forEach((i,o)=>{var d,m;let a=c.cloneNode(!0);a.setAttribute("id",""),a.setAttribute("href",`/admin/session?sessionId=${i.id}`);let _=a.querySelectorAll(".colcontent");o%2===0&&(a.style.backgroundColor="#00edf4"),_[1].innerText=i.session_name,_[2].innerText=i.name,_[3].innerText=i.code,_[4].innerText=y(i.time),_[5].innerText=U(i.time,!0),_[6].innerText=(m=(d=i==null?void 0:i.users)==null?void 0:d.length)!=null?m:0,_[7].innerText=i.status,a.style.display="flex",n.prepend(a)})}e?(f.items.push(...t.items),f.nextPage=t.nextPage):f=t,r(f),c.style.display="none"}var v=new IntersectionObserver(t=>{t[0].intersectionRatio<=0||(O>0&&I?P(I):O<1&&O++)});v.observe(document.querySelector(".loadmore"));function P(t){return N(this,null,function*(){let e=R();if(e){let n=yield h(S+`/${t}`,"GET",!1,e);if(n.isFetchOk!==void 0&&!n.isFetchOk){console.error(n.message),n.payload&&n.payload.role===p.ADMIN&&n.payload.gyms&&n.payload.gyms.length>0?x(`/admin/gym/g?gymCode=${n.payload.gyms[0].gym_id}`):console.log("error fetching paginated");return}D(n,!0)}})}
