var f=(e,o,n)=>new Promise((l,i)=>{var _=t=>{try{a(n.next(t))}catch(r){i(r)}},s=t=>{try{a(n.throw(t))}catch(r){i(r)}},a=t=>t.done?l(t.value):Promise.resolve(t.value).then(_,s);a((n=n.apply(e,o)).next())});var A={ADMIN:"ADMIN",SUPER_ADMIN:"SUPER_ADMIN",COACH:"COACH"};function g(e,o="GET",n=!1,l=!1,i=!1,_=!0){try{let s={"Content-Type":"application/json"};i&&(s={}),l&&(s.Authorization=`Bearer ${l}`);let a={method:o,headers:s};return n&&(_?a.body=JSON.stringify(n):a.body=n),fetch(e,a).then(t=>t.ok?t.json():t.json().then(r=>(Promise.reject(r.message),{isFetchOk:!1,status:t.status,message:r.message,payload:r&&r.payload?r.payload:null}))).then(t=>t).catch(t=>(console.error("Error in fetch",t),t))}catch(s){return console.error("Error!: "+s),s}}function S(e="nammax_auth"){let n=`; ${document.cookie}`.split(`; ${e}=`);return n.length===2?n.pop().split(";").shift():null}function E(e="/",o=2e3){setTimeout(()=>{window.location.href=e},o)}function y(e=null,o=!1,n=!1,l=!1){if(e==null)return"NaN";let i=new Date,_=new Date(e),s=_.getHours(),a="";if(l||(a=s>=12?"PM":"AM",s=s%12||12),o){let t=_.getMinutes();return t=t<10?`0${t}`:t,n?`${i.getDate()===_.getDate()?"Today At":i.getDate()+1===_.getDate()?"Tomorrow At":i.getDate()+2===_.getDate()?"Day After Tomorrow At":h(e)} ${s}:${t} ${a}`:`${s}:${t} ${a}`}else return n?`${i.getDate()===_.getDate()?"Today At":i.getDate()+1===_.getDate()?"Tomorrow At":i.getDate()+2===_.getDate()?"Day After Tomorrow At":h(e)} ${s} ${a}`:`${h(e)} ${s} ${a}`}function h(e=null){if(e==null)return"NaN";let o=new Date(e);return`${o.getDate()}/${o.getMonth()+1}/${o.getFullYear()}`}function L(e="/admin/sign-in",o="sidebar-logout-btn"){let n=document.getElementById(o);n?n.onclick=()=>K(e):console.error("Logout button not found")}function K(e="/sign-in"){window.localStorage.removeItem("auth"),E(`${e}`)}function T(e=A.ADMIN){if(e===A.ADMIN){let o=document.getElementById("admin-nav"),n=document.getElementById("super-admin-nav");o&&(o.style.display="flex"),n&&n.remove()}else if(e===A.SUPER_ADMIN){let o=document.getElementById("admin-nav"),n=document.getElementById("super-admin-nav");n&&(n.style.display="flex"),o&&o.remove()}}function C(){let e=document.getElementById("loading-screen");e?e.remove():console.log("did not find loading screen")}function B({mode:e="API",clientObjRefName:o="name",data:n,token:l,API:i,extraXanoInputObj:_=[],searchContainerElId:s=""},a,t=null,r=null){let c,m,p;if(s.length>0){let x=document.getElementById(s);c=x.querySelector("#search-input"),c.setAttribute("placeholder","Search"),m=x.querySelector("#search-btn"),p=x.querySelector("#search-reset-btn")}else c=document.getElementById("search-input"),c.setAttribute("placeholder","Search"),m=document.getElementById("search-btn"),p=document.getElementById("search-reset-btn");p.onclick=()=>{c.value="",M(p,{mode:e,clientObjRefName:o,data:n,searchquery:"",token:l,API:i,extraXanoInputObj:_},a,t,r)},m.onclick=()=>{let x=c.value;M(p,{mode:e,clientObjRefName:o,data:n,searchquery:x,token:l,API:i,extraXanoInputObj:_},a,t,r)}}function M(m,p,x,te,oe){return f(this,arguments,function*(e,{mode:o,clientObjRefName:n,data:l,searchquery:i,token:_,API:s,extraXanoInputObj:a=[]},t,r,c){if(i.length===0)e.style.display="none",r?t(l,r):t(l);else try{if(o==="API"){let u={search_query:`${i}:*`};a.length>0&&a.map(X=>{for(let[j,z]of Object.entries(X))u[j]=z});let d=yield g(s+"query","POST",u,_);if(d.isFetchOk!==void 0&&!d.isFetchOk)throw console.error(d.message),Error("API call failed");e.style.display="flex",r?t(d,r):t(d)}else{let u=l.filter(d=>d[n].toLowerCase().includes(i.toLowerCase()));e.style.display="flex",r?t(u,r):t(u)}}catch(u){c?c():console.error(u)}})}var R="/admin/sign-in";var O="https://xoxo-jnzf-s0on.m2.xano.io/api:Kml2N_BA/super_admin/all_sessions",b="https://xoxo-jnzf-s0on.m2.xano.io/api:Kml2N_BA/super_admin/all_sessions/search/";var D=null,I=0,N=[];window.onload=function(){return f(this,null,function*(){L(R,"sidebar-logout-btn");let e=S();if(e){let o=yield g(O+"/1","GET",!1,e);if(o.isFetchOk!==void 0&&!o.isFetchOk){console.error(o.message),o.payload&&o.payload.role===A.ADMIN&&o.payload.gyms&&o.payload.gyms.length>0?E(`/admin/gym/g?gymCode=${o.payload.gyms[0].gym_id}`):E(`${R}?reason=UNAUTHORIZED_USER`);return}T(A.SUPER_ADMIN),w(o,e)}else E(`${R}?reason=NOT_SIGNED_IN`)})};function w(e,o){return f(this,null,function*(){U(e),B({data:e,token:o,API:b},U),C()})}function U(e,o=!1){let n=document.getElementById("table-container"),l=n.querySelector("#table-item");function i(_){D=_.nextPage;let s=n.querySelectorAll(".adb-user.w-inline-block");s.forEach((t,r)=>{r!==s.length-1&&t.remove()});let a=N==null?void 0:N.items;a==null||a.forEach((t,r)=>{var p,x;let c=l.cloneNode(!0);c.setAttribute("id",""),c.setAttribute("href",`/admin/session?sessionId=${t.id}`);let m=c.querySelectorAll(".colcontent");r%2===0&&(c.style.backgroundColor="#00edf4"),m[1].innerText=t.session_name,m[2].innerText=t.name||"NaN",m[3].innerText=t.code,m[4].innerText=h(t.time),m[5].innerText=y(t.time,!0),m[6].innerText=(x=(p=t==null?void 0:t.users)==null?void 0:p.length)!=null?x:0,m[7].innerText=t.status,c.style.display="flex",n.prepend(c)})}o?(N.items.push(...e.items),N.nextPage=e.nextPage):N=e,i(N),l.style.display="none"}var v=new IntersectionObserver(e=>{e[0].intersectionRatio<=0||(I>0&&D?H(D):I<1&&I++)});v.observe(document.querySelector(".loadmore"));function H(e){return f(this,null,function*(){let o=S();if(o){let n=yield g(O+`/${e}`,"GET",!1,o);if(n.isFetchOk!==void 0&&!n.isFetchOk){console.error(n.message),n.payload&&n.payload.role===A.ADMIN&&n.payload.gyms&&n.payload.gyms.length>0?E(`/admin/gym/g?gymCode=${n.payload.gyms[0].gym_id}`):console.log("error fetching paginated");return}U(n,!0)}})}
