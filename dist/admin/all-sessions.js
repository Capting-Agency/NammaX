var x=(e,t,o)=>new Promise((s,_)=>{var r=n=>{try{l(o.next(n))}catch(i){_(i)}},a=n=>{try{l(o.throw(n))}catch(i){_(i)}},l=n=>n.done?s(n.value):Promise.resolve(n.value).then(r,a);l((o=o.apply(e,t)).next())});var A={ADMIN:"ADMIN",SUPER_ADMIN:"SUPER_ADMIN",COACH:"COACH"};function h(e,t="GET",o=!1,s=!1,_=!1,r=!0){try{let a={"Content-Type":"application/json"};_&&(a={}),s&&(a.Authorization=`Bearer ${s}`);let l={method:t,headers:a};return o&&(r?l.body=JSON.stringify(o):l.body=o),fetch(e,l).then(n=>n.ok?n.json():n.json().then(i=>(Promise.reject(i.message),{isFetchOk:!1,status:n.status,message:i.message,payload:i&&i.payload?i.payload:null}))).then(n=>n).catch(n=>(console.error("Error in fetch",n),n))}catch(a){return console.error("Error!: "+a),a}}function S(e="nammax_auth"){let o=`; ${document.cookie}`.split(`; ${e}=`);return o.length===2?o.pop().split(";").shift():null}function E(e="/",t=0){setTimeout(()=>{window.location.href=e},t)}function f(e=null,t=!1){if(e==null)return"NaN";var o=new Date(e),s=o.getHours(),_=s>=12?"PM":"AM";if(s=s%12||12,t){var r=o.getMinutes();return r=r<10?`0${r}`:r,`${s}:${r} ${_}`}else return`${s} ${_}`}function I(e=null){if(e==null)return"NaN";let t=new Date(e);return`${t.getDate()}/${t.getMonth()+1}/${t.getFullYear()}`}function O(e="/admin/sign-in",t="sidebar-logout-btn"){let o=document.getElementById(t);o?o.onclick=()=>B(e):console.error("Logout button not found")}function B(e="/sign-in"){window.localStorage.removeItem("auth"),E(`${e}`)}function g(e=A.ADMIN){if(e===A.ADMIN){let t=document.getElementById("admin-nav"),o=document.getElementById("super-admin-nav");t&&(t.style.display="flex"),o&&o.remove()}else if(e===A.SUPER_ADMIN){let t=document.getElementById("admin-nav"),o=document.getElementById("super-admin-nav");o&&(o.style.display="flex"),t&&t.remove()}}function y({mode:e="API",clientObjRefName:t="name",data:o,token:s,API:_,extraXanoInputObj:r=[],searchContainerElId:a=""},l,n=null,i=null){let c,u,d;if(a.length>0){let N=document.getElementById(a);c=N.querySelector("#search-input"),c.setAttribute("placeholder","Search"),u=N.querySelector("#search-btn"),d=N.querySelector("#search-reset-btn")}else c=document.getElementById("search-input"),c.setAttribute("placeholder","Search"),u=document.getElementById("search-btn"),d=document.getElementById("search-reset-btn");d.onclick=()=>{c.value="",U(d,{mode:e,clientObjRefName:t,data:o,searchquery:"",token:s,API:_,extraXanoInputObj:r},l,n,i)},u.onclick=()=>{let N=c.value;U(d,{mode:e,clientObjRefName:t,data:o,searchquery:N,token:s,API:_,extraXanoInputObj:r},l,n,i)}}function U(u,d,N,z,J){return x(this,arguments,function*(e,{mode:t,clientObjRefName:o,data:s,searchquery:_,token:r,API:a,extraXanoInputObj:l=[]},n,i,c){if(_.length===0)e.style.display="none",i?n(s,i):n(s);else try{if(t==="API"){let m={search_query:`${_}:*`};l.length>0&&l.map(C=>{for(let[w,M]of Object.entries(C))m[w]=M});let p=yield h(a+"query","POST",m,r);if(p.isFetchOk!==void 0&&!p.isFetchOk)throw console.error(p.message),Error("API call failed");e.style.display="flex",i?n(p,i):n(p)}else{let m=s.filter(p=>p[o].toLowerCase().includes(_.toLowerCase()));e.style.display="flex",i?n(m,i):n(m)}}catch(m){c?c():console.error(m)}})}var R="/admin/sign-in";var D="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/super_admin/all_sessions",L="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/super_admin/all_sessions/search/";window.onload=function(){return x(this,null,function*(){O(R,"sidebar-logout-btn");let e=S();if(e){let t=yield h(D,"GET",!1,e);if(t.isFetchOk!==void 0&&!t.isFetchOk){console.error(t.message),t.payload&&t.payload.role===A.ADMIN&&t.payload.gyms&&t.payload.gyms.length>0?E(`/admin/gym/g?gymCode=${t.payload.gyms[0].gym_id}`):E(`${R}?reason=UNAUTHORIZED_USER`);return}g(A.SUPER_ADMIN),k(t,e)}else E(`${R}?reason=NOT_SIGNED_IN`)})};function k(e,t){return x(this,null,function*(){T(e),y({data:e,token:t,API:L},T)})}function T(e){let t=document.getElementById("table-container"),o=t.querySelector("#table-item");function s(_){let r=t.querySelectorAll(".adb-user.w-inline-block");r.forEach((a,l)=>{l!==r.length-1&&a.remove()}),_.forEach((a,l)=>{var c,u;let n=o.cloneNode(!0);n.setAttribute("id",""),n.setAttribute("href",`/admin/session?sessionId=${a.id}`);let i=n.querySelectorAll(".colcontent");l%2===0&&(n.style.backgroundColor="#00edf4"),i[1].innerText=a.session_name,i[2].innerText=a.name,i[3].innerText=a.code,i[4].innerText=I(a.time),i[5].innerText=f(a.time,!0),i[6].innerText=(u=(c=a==null?void 0:a.users)==null?void 0:c.length)!=null?u:0,i[7].innerText=a.status,n.style.display="flex",t.prepend(n)})}s(e),o.style.display="none"}
