var ee=Object.getOwnPropertySymbols;var Ee=Object.prototype.hasOwnProperty,he=Object.prototype.propertyIsEnumerable;var te=(t,o)=>{var e={};for(var n in t)Ee.call(t,n)&&o.indexOf(n)<0&&(e[n]=t[n]);if(t!=null&&ee)for(var n of ee(t))o.indexOf(n)<0&&he.call(t,n)&&(e[n]=t[n]);return e};var E=(t,o,e)=>new Promise((n,a)=>{var r=s=>{try{i(e.next(s))}catch(l){a(l)}},c=s=>{try{i(e.throw(s))}catch(l){a(l)}},i=s=>s.done?n(s.value):Promise.resolve(s.value).then(r,c);i((e=e.apply(t,o)).next())});var I={ADMIN:"ADMIN",SUPER_ADMIN:"SUPER_ADMIN",COACH:"COACH"};function h(t,o="GET",e=!1,n=!1,a=!1,r=!0){try{let c={"Content-Type":"application/json"};a&&(c={}),n&&(c.Authorization=`Bearer ${n}`);let i={method:o,headers:c};return e&&(r?i.body=JSON.stringify(e):i.body=e),fetch(t,i).then(s=>s.ok?s.json():s.json().then(l=>(Promise.reject(l.message),{isFetchOk:!1,status:s.status,message:l.message,payload:l&&l.payload?l.payload:null}))).then(s=>s).catch(s=>(console.error("Error in fetch",s),s))}catch(c){return console.error("Error!: "+c),c}}function M(t="nammax_auth"){let e=`; ${document.cookie}`.split(`; ${t}=`);return e.length===2?e.pop().split(";").shift():null}function T(t="/",o=2e3){setTimeout(()=>{window.location.href=t},o)}function w(t=1e3){setTimeout(()=>{window.location.reload()},t)}function G(t=null,o=!1,e=!1,n=!1){if(t==null)return"NaN";let a=new Date,r=new Date(t),c=r.getHours(),i="";if(n||(i=c>=12?"PM":"AM",c=c%12||12),o){let s=r.getMinutes();return s=s<10?`0${s}`:s,e?`${a.getDate()===r.getDate()?"Today At":a.getDate()+1===r.getDate()?"Tomorrow At":a.getDate()+2===r.getDate()?"Day After Tomorrow At":B(t)} ${c}:${s} ${i}`:`${c}:${s} ${i}`}else return e?`${a.getDate()===r.getDate()?"Today At":a.getDate()+1===r.getDate()?"Tomorrow At":a.getDate()+2===r.getDate()?"Day After Tomorrow At":B(t)} ${c} ${i}`:`${B(t)} ${c} ${i}`}function B(t=null){if(t==null)return"NaN";let o=new Date(t);return`${o.getDate()}/${o.getMonth()+1}/${o.getFullYear()}`}function oe(t=null){if(t==null)return"NaN";t=t*60;let o=`${t/60^0}`.slice(-2),e=("0"+t%60).slice(-2);return o!="0"?e!="00"?`${o} HR ${e} M`:o+" HR":e+" Mins"}function b(t,o=null){if(t!=null){var e,n=t.options.length-1;for(e=n;e>=0;e--)e!==o&&t.remove(e)}}function ne(t="/admin/sign-in",o="sidebar-logout-btn"){let e=document.getElementById(o);e?e.onclick=()=>ge(t):console.error("Logout button not found")}function ge(t="/sign-in"){window.localStorage.removeItem("auth"),T(`${t}`)}function se(t=I.ADMIN){if(t===I.ADMIN){let o=document.getElementById("admin-nav"),e=document.getElementById("super-admin-nav");o&&(o.style.display="flex"),e&&e.remove()}else if(t===I.SUPER_ADMIN){let o=document.getElementById("admin-nav"),e=document.getElementById("super-admin-nav");e&&(e.style.display="flex"),o&&o.remove()}}function ae(t){if(!t)return console.error("url does not cotnain gym id");let o=document.getElementById("navbar-home"),e=document.getElementById("navbar-finance"),n=document.getElementById("navbar-users"),a=document.getElementById("navbar-sessions");o&&o.setAttribute("href",`/admin/gym/g?gymCode=${t}`),e&&e.setAttribute("href",`/admin/gym/finance?gymCode=${t}`),n&&n.setAttribute("href",`/admin/gym/users?gymCode=${t}`),a&&a.setAttribute("href",`/admin/gym/sessions?gymCode=${t}`)}function re(t){if(!t)return console.error("gym data not found");let o=document.getElementById("gym-code-location"),e=document.getElementById("header-address"),n=document.getElementById("header-partner"),a=document.getElementById("header-contact"),r=document.getElementById("header-email");o&&(o.innerText=`${t.code} \u2022 ${t.location}`),e&&(e.innerText=t.address),n&&(n.innerText=t.partner),a&&(a.innerText=t.contact),r&&(r.innerText=t.partner_email)}function ie(){let t=document.getElementById("loading-screen");t?t.remove():console.log("did not find loading screen")}function le({single:t=!0,baseElement:o="",TriggerBtn:e="jsModalOpen",_modalWindow:n="jsModal"},a){if(t){var r=o.querySelector("#"+e);r.onclick=function(){var s=document.getElementById(n);a&&a(),s.classList?s.classList.add("open"):s.className+=" open"}}else for(var c=document.getElementsByClassName(e),i=0;i<c.length;i++)c[i].onclick=function(){var s=this.getAttribute("href").substr(1),l=document.getElementById(s);l.classList?l.classList.add("open"):l.className+=" open"}}function ce({TriggerBtn:t="jsModalClose",_modalWindow:o="jsModal"},e){var n=document.getElementById(t),a=document.getElementById(o);n.onclick=function(){a.classList?a.classList.remove("open"):a.className=a.className.replace(new RegExp("(^|\\b)"+"open".split(" ").join("|")+"(\\b|$)","gi")," ")},e&&e()}function me({mode:t="API",clientObjRefName:o="name",data:e,token:n,API:a,extraXanoInputObj:r=[],searchContainerElId:c=""},i,s=null,l=null){let d,p,_;if(c.length>0){let m=document.getElementById(c);d=m.querySelector("#search-input"),d.setAttribute("placeholder","Search"),p=m.querySelector("#search-btn"),_=m.querySelector("#search-reset-btn")}else d=document.getElementById("search-input"),d.setAttribute("placeholder","Search"),p=document.getElementById("search-btn"),_=document.getElementById("search-reset-btn");_.onclick=()=>{d.value="",de(_,{mode:t,clientObjRefName:o,data:e,searchquery:"",token:n,API:a,extraXanoInputObj:r},i,s,l)},p.onclick=()=>{let m=d.value;de(_,{mode:t,clientObjRefName:o,data:e,searchquery:m,token:n,API:a,extraXanoInputObj:r},i,s,l)}}function de(p,_,m,u,f){return E(this,arguments,function*(t,{mode:o,clientObjRefName:e,data:n,searchquery:a,token:r,API:c,extraXanoInputObj:i=[]},s,l,d){if(a.length===0)t.style.display="none",l?s(n,l):s(n);else try{if(o==="API"){let x={search_query:`${a}:*`};i.length>0&&i.map(L=>{for(let[C,O]of Object.entries(L))x[C]=O});let A=yield h(c+"query","POST",x,r);if(A.isFetchOk!==void 0&&!A.isFetchOk)throw console.error(A.message),Error("API call failed");t.style.display="flex",l?s(A,l):s(A)}else{let x=n.filter(A=>A[e].toLowerCase().includes(a.toLowerCase()));t.style.display="flex",l?s(x,l):s(x)}}catch(x){d?d():console.error(x)}})}var ue=Webflow||[];var z="/admin/sign-in";var W="https://xoxo-jnzf-s0on.m2.xano.io/api:Kml2N_BA/admin/sessions/",k="https://xoxo-jnzf-s0on.m2.xano.io/api:Kml2N_BA/admin/sessions/add_session/",pe="https://xoxo-jnzf-s0on.m2.xano.io/api:Kml2N_BA/admin/session/add_recurring_session",_e="https://xoxo-jnzf-s0on.m2.xano.io/api:Kml2N_BA/admin/session/delete_recurring_session";var fe="https://xoxo-jnzf-s0on.m2.xano.io/api:Kml2N_BA/admin/sessions/search/";var ye="https://nammax.webflow.io",Se="https://www.nammacrossfit.com",Re=[ye,Se],xe=Re[1];var ze=`${xe}/sign-up-2`;var ke=`${xe}/user/dashboard`;var R,y,S,Y,j,P,H,X,D,Ae,J=null,q=0,U=[];window.onload=function(){return E(this,null,function*(){ne("/admin/sign-in","sidebar-logout-btn");var t=new URL(document.location.href);if(R=t.searchParams.get("gymCode")||null,R)ae(R);else{console.error("No gym id found");return}let o=M();if(o){let n=yield h(W+R+"/1/s","GET",!1,o);if(n.isFetchOk!==void 0&&!n.isFetchOk){console.error(n.message);return}let e=n,{team_role:a}=e,r=te(e,["team_role"]);a===I.SUPER_ADMIN||a===I.ADMIN?(se(a),Oe(r,o)):T(`${z}?reason=UNAUTHORIZED_USER`)}else T(`${z}?reason=NOT_SIGNED_IN`)})};$(document).ready(function(){y=document.getElementById("add-manual-session-form-block"),S=y.querySelector("#sessions-select-gym"),Y=y.querySelector("#session-name-input"),j=y.querySelector("#sessions-select-coach"),P=y.querySelector("#datepicker-input"),H=y.querySelector("#timepicker-input"),X=y.querySelector("#sessions-select-duration"),D=y.querySelector("#session-select-capacity"),Ae=y.querySelector("#sessions-select-btn"),S.disabled=!0,Y.disabled=!0,j.disabled=!0,P.disabled=!0,H.disabled=!0,X.disabled=!0,D.disabled=!0,Ae.disabled=!0,$(P).datepicker({startDate:new Date,format:"dd/mm/yyyy",language:"en",multidate:!0,orientation:"bottom auto"}),$(H).timepicker({timeFormat:"h:mm p",interval:15,defaultTime:"7",minTime:"7",maxTime:"11:45pm"})});function Oe(t,o){return E(this,null,function*(){let{manual_type_sessions:e,recurring_type_sessions:n,recurring_sessions:a,gym:r,nextPage:c}=t;S.disabled=!1,r&&re(r),V([...e,...n],r.code,c),Ie(a,o),be(o),me({data:e,token:o,API:fe,extraXanoInputObj:[{gym_id:R}]},V,r.code),ie()})}function V(t,o,e,n=!1){let a=document.getElementById("table-container"),r=a.querySelector("#table-item");function c(i){J=e;let s=a.querySelectorAll(".adb-user.w-inline-block");s.forEach((d,p)=>{p!==s.length-1&&d.remove()}),U.sort((d,p)=>d.time-p.time).forEach((d,p)=>{var u,f;let _=r.cloneNode(!0);_.setAttribute("id",""),_.setAttribute("href",`/admin/session?sessionId=${d.id}`);let m=_.querySelectorAll(".colcontent");p%2===0&&(_.style.backgroundColor="#00edf4"),m[1].innerText=d.session_name,m[2].innerText=d.name||"To Be Decided",m[3].innerText=o,m[4].innerText=B(d.time),m[5].innerText=G(d.time,!0),m[6].innerText=(f=(u=d==null?void 0:d.users)==null?void 0:u.length)!=null?f:0,m[7].innerText=d.status,_.style.display="flex",a.prepend(_)})}n?(U.push(...t),U.nextPage=e):(U=t,U.nextPage=e),c(U),r.style.display="none"}function Ie(t,o){let n=document.getElementById("recursive-table-container").querySelectorAll(".recursive-table-columns");function a(r){let c;n.forEach((i,s)=>{let l=s+1,d=i.querySelector("#recursive-table-wrapper"),p=d.querySelector("#recursive-table-item");r.sort((m,u)=>u.time-m.time).forEach(m=>{if(m.weekday==l){let u=p.cloneNode(!0);u.setAttribute("id","");let f=u.querySelectorAll(".colcontent");f[0].innerText=m.session_name,f[1].innerText=G(m.time,!0),f[2].innerText=oe(m.duration),f[3].innerText=m.capacity;let x=u.querySelector(".delete-icon-w.off");u.onmouseover=()=>{x.style.display="flex"},u.onmouseout=()=>{x.style.display="none"};let A=u.querySelector(".delete-recurring-session");A.onclick=()=>E(this,null,function*(){document.querySelectorAll(".delete-recurring-session").forEach(K=>{K.disabled=!0});let C={recurring_id:m.id},O=yield h(_e,"POST",C,o);if(O.isFetchOk!==void 0&&!O.isFetchOk){console.error(O.message),$("#add-recurring-session-form-block").hide().siblings(".w-form-done").hide().siblings(".w-form-fail").show().text("Failed to delete recurring session"),w(1500);return}u.remove(),$("#add-recurring-session-form-block").hide().siblings(".w-form-fail").hide().siblings(".w-form-done").show().text("Successfully deleted recurring session"),w(1500)}),u.style.display="flex",d.prepend(u)}}),le({_modalWindow:"recursive-popout",TriggerBtn:"add-recursive-weekday-btn",baseElement:i},()=>{let m=document.getElementById("recursive-popout"),u=m.querySelector("#recursive-sessions-name-select"),f=m.querySelector("#recursive-sessions-duration-select"),x=m.querySelector("#recursive-sessions-capacity-select"),A=m.querySelector("#datepicker-input"),L=m.querySelector("#timepicker-input"),C=m.querySelector("#selected-day"),O=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];b(A),[O[l-1]].forEach(N=>{var g=document.createElement("option");g.value=l,g.innerText=N,g.selected=!0,A.appendChild(g)}),A.disabled=!0,C.innerText=O[l-1],L.style.color="#080808",$(L).timepicker({timeFormat:"HH:mm",interval:15,defaultTime:"7",minTime:"7",maxTime:"11:45pm",zindex:10}),b(f,0);let K=["15 mins","30 mins","45 mins","1 hour","1 hour and 15 mins","1 hour and 30 mins","1 hour and 45 mins","2 hours","2 hour and 15 mins","2 hour and 30 mins","2 hour and 45 mins","3 hours","3 hour and 15 mins","3 hour and 30 mins","3 hour and 45 mins"],Ne=["0.25","0.5","0.75","1","1.25","1.5","1.75","2","2.25","2.5","2.75","3","3.25","3.5","3.75"];K.forEach((N,g)=>{var v=document.createElement("option");v.value=Ne[g],v.innerText=N,f.appendChild(v)});function Q(){return E(this,null,function*(){let N;if(c?N=c:N=yield h(k+R,"GET",!1,o),N.isFetchOk!==void 0&&!N.isFetchOk){console.error(N.message);return}c=N;let{gyms:g,session_names:v}=N;b(u),v.forEach(Z=>{var F=document.createElement("option");F.value=Z.name,F.innerText=Z.name,u.appendChild(F)}),x.setAttribute("max",g[0].capacity),x.setAttribute("placeholder","Max capacity: "+g[0].capacity),u.removeEventListener("focus",Q)})}u.addEventListener("focus",Q)}),p.style.display="none"})}ce({_modalWindow:"recursive-popout",TriggerBtn:"close-recursive-session-popout-btn"}),a(t)}function be(t){$("form :input").attr("autocomplete","off");function o(){return E(this,null,function*(){let e=yield h(k+R,"GET",!1,t);if(e.isFetchOk!==void 0&&!e.isFetchOk){console.error(e.message);return}Y.disabled=!1,j.disabled=!1,P.disabled=!1,H.disabled=!1,X.disabled=!1,D.disabled=!1;let{gyms:n,coaches:a}=e;b(S),n.forEach((i,s)=>{var l=document.createElement("option");l.value=i.id,l.innerText=i.location,s===0&&(l.selected=!0),S.appendChild(l)}),b(j,0),a.forEach(i=>{var s=document.createElement("option");s.value=i.id,s.innerText=i.name,j.appendChild(s)}),b(X,0);let r=["15 mins","30 mins","45 mins","1 hour","1 hour and 15 mins","1 hour and 30 mins","1 hour and 45 mins","2 hours","2 hour and 15 mins","2 hour and 30 mins","2 hour and 45 mins","3 hours","3 hour and 15 mins","3 hour and 30 mins","3 hour and 45 mins"],c=["0.25","0.5","0.75","1","1.25","1.5","1.75","2","2.25","2.5","2.75","3","3.25","3.5","3.75"];r.forEach((i,s)=>{var l=document.createElement("option");l.value=c[s],l.innerText=i,X.appendChild(l)}),D.setAttribute("max",n[0].capacity),D.setAttribute("placeholder","Max capacity: "+n[0].capacity),S.addEventListener("change",()=>{n.some(i=>i.id===parseInt(S.value)?(D.setAttribute("max",i.capacity),D.setAttribute("placeholder","Max capacity: "+i.capacity),!0):!1)},!1),S.removeEventListener("focus",o)})}S.addEventListener("focus",o)}var De=new IntersectionObserver(t=>{t[0].intersectionRatio<=0||(q>0&&J?Te(J):q<1&&q++)});De.observe(document.querySelector(".loadmore"));function Te(t){return E(this,null,function*(){let o=M();if(o){let e=yield h(W+R+`/${t}/s`,"GET",!1,o);if(e.isFetchOk!==void 0&&!e.isFetchOk){console.error(e.message),e.payload&&e.payload.role===I.ADMIN&&e.payload.gyms&&e.payload.gyms.length>0?T(`/admin/gym/g?gymCode=${e.payload.gyms[0].gym_id}`):console.log("error fetching paginated");return}let{manual_type_sessions:n,recurring_type_sessions:a,gym:r,nextPage:c}=e;V([...n,...a],r.code,c,!0)}})}var Ue=ue||[];Ue.push(function(){$(document).off("submit"),$("form").on("change",function(){let t=$(this);if(t.attr("id")==="add-manual-session-form-block"){let o=t[0][0].value,e=t[0][1].value,n=t[0][3].value,a=t[0][5].value,r=t[0][6].value;o!==""&&e!==""&&e!=="Session Name"&&n!==""&&a!==""&&a!=="Duration"&&r.trim()!==""&&(t[0][7].disabled=!1,t[0][7].classList.remove("disabled"))}}),$("form").on("submit",function(t){return E(this,null,function*(){t.preventDefault();let o=$(this);if(o.attr("id")==="add-manual-session-form-block"){let e=document.getElementById("submit"),n;e&&(n=e.value,e.disabled=!0,e.classList.add("disabled"),e.value="ADDING SESSION");let a=M();if(a){let r=o[0][0].value,c=o[0][1].value,i=o[0][2].value,s=o[0][3].value,l=o[0][4].value,d=o[0][5].value,p=o[0][6].value;if(r!==""&&c!==""&&c!=="Session Name"&&s!==""&&l!==""&&d!==""&&d!=="Duration"&&p.trim()!==""){let _={};_.items=[...s.split(",").map(u=>{let f=u.split("/");return{gym_id:r,session_name:c,team_id:i==="Coach"?null:i,time:new Date(`${f[2]}/${f[1]}/${f[0]} ${l}`).getTime(),duration:d,capacity:p}})];let m=yield h(k+r,"POST",_,a);if(m.isFetchOk!==void 0&&!m.isFetchOk){console.error(m.message),o.siblings(".w-form-done").hide().siblings(".w-form-fail").show().text("There was an error trying to add your session. Please refresh your browser and try again."),e&&(e.value=n,e.disabled=!1,e.classList.remove("disabled"));return}o.hide().siblings(".w-form-done").show().siblings(".w-form-fail").hide(),w()}else c==="Session Name"?o[0][1].style.borderColor="red":o[0][1].style.borderColor="black",s.trim()===""?o[0][3].style.borderColor="red":o[0][3].style.borderColor="black",l.trim()===""?o[0][4].style.borderColor="red":o[0][4].style.borderColor="black",d==="Duration"?o[0][5].style.borderColor="red":o[0][5].style.borderColor="black",p.trim()===""?o[0][6].style.borderColor="red":o[0][6].style.borderColor="black",o.siblings(".w-form-done").hide().siblings(".w-form-fail").show().text("Please fill out all fields"),e&&(e.value=n,e.disabled=!1,e.classList.remove("disabled"))}}else if(o.attr("id")==="add-recurring-session-modal-form-block"){let e=document.getElementById("submit"),n;e&&(n=e.value,e.disabled=!0,e.classList.add("disabled"),e.value="ADDING SESSION");let a=M();if(a){let r=o[0][0].value,c=o[0][1].value,i=o[0][2].value,s=o[0][3].value,l=o[0][4].value;if(r!==""&&c!==""&&i!==""&&s!==""&&l!==""){let d={gym_id:R,session_name:r,weekday:parseInt(c),time:new Date().setHours(i.split(":")[0],i.split(":")[1],0,0),duration:s,capacity:l},p=yield h(pe,"POST",d,a);if(p.isFetchOk!==void 0&&!p.isFetchOk){console.error(p.message),o.siblings(".w-form-done").hide().siblings(".w-form-fail").show().text("There was an error trying to add your session. Please refresh your browser and try again."),e&&(e.value=n,e.disabled=!1,e.classList.remove("disabled"));return}o.hide().siblings(".w-form-done").show().siblings(".w-form-fail").hide(),w()}}else T(`${z}?reason=NOT_SIGNED_IN`)}})})});
