var Q=Object.getOwnPropertySymbols;var Ne=Object.prototype.hasOwnProperty,xe=Object.prototype.propertyIsEnumerable;var Z=(n,t)=>{var e={};for(var o in n)Ne.call(n,o)&&t.indexOf(o)<0&&(e[o]=n[o]);if(n!=null&&Q)for(var o of Q(n))t.indexOf(o)<0&&xe.call(n,o)&&(e[o]=n[o]);return e};var x=(n,t,e)=>new Promise((o,i)=>{var r=s=>{try{l(e.next(s))}catch(a){i(a)}},c=s=>{try{l(e.throw(s))}catch(a){i(a)}},l=s=>s.done?o(s.value):Promise.resolve(s.value).then(r,c);l((e=e.apply(n,t)).next())});var O={ADMIN:"ADMIN",SUPER_ADMIN:"SUPER_ADMIN",COACH:"COACH"};function h(n,t="GET",e=!1,o=!1,i=!1,r=!0){try{let c={"Content-Type":"application/json"};i&&(c={}),o&&(c.Authorization=`Bearer ${o}`);let l={method:t,headers:c};return e&&(r?l.body=JSON.stringify(e):l.body=e),fetch(n,l).then(s=>s.ok?s.json():s.json().then(a=>(Promise.reject(a.message),{isFetchOk:!1,status:s.status,message:a.message,payload:a&&a.payload?a.payload:null}))).then(s=>s).catch(s=>(console.error("Error in fetch",s),s))}catch(c){return console.error("Error!: "+c),c}}function v(n="nammax_auth"){let e=`; ${document.cookie}`.split(`; ${n}=`);return e.length===2?e.pop().split(";").shift():null}function D(n="/",t=2e3){setTimeout(()=>{window.location.href=n},t)}function k(n=1e3){setTimeout(()=>{window.location.reload()},n)}function G(n=null,t=!1,e=!1,o=!1){if(n==null)return"NaN";let i=new Date,r=new Date(n),c=r.getHours(),l="";if(o||(l=c>=12?"PM":"AM",c=c%12||12),t){let s=r.getMinutes();return s=s<10?`0${s}`:s,e?`${i.getDate()===r.getDate()?"Today":i.getDate()+1===r.getDate()?"Tomorrow":i.getDate()+2===r.getDate()?"Day After Tomorrow":""} ${c}:${s} ${l}`:`${c}:${s} ${l}`}else return e?`${i.getDate()===r.getDate()?"Today":i.getDate()+1===r.getDate()?"Tomorrow":i.getDate()+2===r.getDate()?"Day After Tomorrow":""} ${c} ${l}`:`${c} ${l}`}function ee(n=null){if(n==null)return"NaN";let t=new Date(n);return`${t.getDate()}/${t.getMonth()+1}/${t.getFullYear()}`}function te(n=null){if(n==null)return"NaN";n=n*60;let t=`${n/60^0}`.slice(-2),e=("0"+n%60).slice(-2);return t!="0"?e!="00"?`${t} HR ${e} M`:t+" HR":e+" Mins"}function I(n,t=null){if(n!=null){var e,o=n.options.length-1;for(e=o;e>=0;e--)e!==t&&n.remove(e)}}function ne(n="/admin/sign-in",t="sidebar-logout-btn"){let e=document.getElementById(t);e?e.onclick=()=>he(n):console.error("Logout button not found")}function he(n="/sign-in"){window.localStorage.removeItem("auth"),D(`${n}`)}function oe(n=O.ADMIN){if(n===O.ADMIN){let t=document.getElementById("admin-nav"),e=document.getElementById("super-admin-nav");t&&(t.style.display="flex"),e&&e.remove()}else if(n===O.SUPER_ADMIN){let t=document.getElementById("admin-nav"),e=document.getElementById("super-admin-nav");e&&(e.style.display="flex"),t&&t.remove()}}function se(n){if(!n)return console.error("url does not cotnain gym id");let t=document.getElementById("navbar-home"),e=document.getElementById("navbar-finance"),o=document.getElementById("navbar-users"),i=document.getElementById("navbar-sessions");t&&t.setAttribute("href",`/admin/gym/g?gymCode=${n}`),e&&e.setAttribute("href",`/admin/gym/finance?gymCode=${n}`),o&&o.setAttribute("href",`/admin/gym/users?gymCode=${n}`),i&&i.setAttribute("href",`/admin/gym/sessions?gymCode=${n}`)}function ie(n){if(!n)return console.error("gym data not found");let t=document.getElementById("gym-code-location"),e=document.getElementById("header-address"),o=document.getElementById("header-partner"),i=document.getElementById("header-contact"),r=document.getElementById("header-email");t&&(t.innerText=`${n.code} \u2022 ${n.location}`),e&&(e.innerText=n.address),o&&(o.innerText=n.partner),i&&(i.innerText=n.contact),r&&(r.innerText=n.partner_email)}function ae(){let n=document.getElementById("loading-screen");n?n.remove():console.log("did not find loading screen")}function re({single:n=!0,baseElement:t="",TriggerBtn:e="jsModalOpen",_modalWindow:o="jsModal"},i){if(n){var r=t.querySelector("#"+e);r.onclick=function(){var s=document.getElementById(o);i&&i(),s.classList?s.classList.add("open"):s.className+=" open"}}else for(var c=document.getElementsByClassName(e),l=0;l<c.length;l++)c[l].onclick=function(){var s=this.getAttribute("href").substr(1),a=document.getElementById(s);a.classList?a.classList.add("open"):a.className+=" open"}}function le({TriggerBtn:n="jsModalClose",_modalWindow:t="jsModal"},e){var o=document.getElementById(n),i=document.getElementById(t);o.onclick=function(){i.classList?i.classList.remove("open"):i.className=i.className.replace(new RegExp("(^|\\b)"+"open".split(" ").join("|")+"(\\b|$)","gi")," ")},e&&e()}function de({mode:n="API",clientObjRefName:t="name",data:e,token:o,API:i,extraXanoInputObj:r=[],searchContainerElId:c=""},l,s=null,a=null){let u,p,d;if(c.length>0){let m=document.getElementById(c);u=m.querySelector("#search-input"),u.setAttribute("placeholder","Search"),p=m.querySelector("#search-btn"),d=m.querySelector("#search-reset-btn")}else u=document.getElementById("search-input"),u.setAttribute("placeholder","Search"),p=document.getElementById("search-btn"),d=document.getElementById("search-reset-btn");d.onclick=()=>{u.value="",ce(d,{mode:n,clientObjRefName:t,data:e,searchquery:"",token:o,API:i,extraXanoInputObj:r},l,s,a)},p.onclick=()=>{let m=u.value;ce(d,{mode:n,clientObjRefName:t,data:e,searchquery:m,token:o,API:i,extraXanoInputObj:r},l,s,a)}}function ce(p,d,m,_,T){return x(this,arguments,function*(n,{mode:t,clientObjRefName:e,data:o,searchquery:i,token:r,API:c,extraXanoInputObj:l=[]},s,a,u){if(i.length===0)n.style.display="none",a?s(o,a):s(o);else try{if(t==="API"){let f={search_query:`${i}:*`};l.length>0&&l.map(U=>{for(let[R,L]of Object.entries(U))f[R]=L});let A=yield h(c+"query","POST",f,r);if(A.isFetchOk!==void 0&&!A.isFetchOk)throw console.error(A.message),Error("API call failed");n.style.display="flex",a?s(A,a):s(A)}else{let f=o.filter(A=>A[e].toLowerCase().includes(i.toLowerCase()));n.style.display="flex",a?s(f,a):s(f)}}catch(f){u?u():console.error(f)}})}var me=Webflow||[];var X="/admin/sign-in";var W="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/admin/sessions/",K="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/admin/sessions/add_session/",ue="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/admin/session/add_recurring_session",pe="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/admin/session/delete_recurring_session";var _e="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/admin/sessions/search/";var S,g,y,j,M,H,P,B,b,fe,Y=null,q=0,w=[];window.onload=function(){return x(this,null,function*(){ne("/admin/sign-in","sidebar-logout-btn");var n=new URL(document.location.href);if(S=n.searchParams.get("gymCode")||null,S)se(S);else{console.error("No gym id found");return}let t=v();if(t){let o=yield h(W+S+"/1/s","GET",!1,t);if(o.isFetchOk!==void 0&&!o.isFetchOk){console.error(o.message);return}let e=o,{team_role:i}=e,r=Z(e,["team_role"]);i===O.SUPER_ADMIN||i===O.ADMIN?(oe(i),Ee(r,t)):D(`${X}?reason=UNAUTHORIZED_USER`)}else D(`${X}?reason=NOT_SIGNED_IN`)})};$(document).ready(function(){g=document.getElementById("add-manual-session-form-block"),y=g.querySelector("#sessions-select-gym"),j=g.querySelector("#session-name-input"),M=g.querySelector("#sessions-select-coach"),H=g.querySelector("#datepicker-input"),P=g.querySelector("#timepicker-input"),B=g.querySelector("#sessions-select-duration"),b=g.querySelector("#session-select-capacity"),fe=g.querySelector("#sessions-select-btn"),y.disabled=!0,j.disabled=!0,M.disabled=!0,H.disabled=!0,P.disabled=!0,B.disabled=!0,b.disabled=!0,fe.disabled=!0,$(H).datepicker({startDate:new Date,format:"dd/mm/yyyy",language:"en",multidate:!0,orientation:"bottom auto"}),$(P).timepicker({timeFormat:"h:mm p",interval:15,defaultTime:"7",minTime:"7",maxTime:"11:45pm"})});function Ee(n,t){return x(this,null,function*(){let{manual_type_sessions:e,recurring_type_sessions:o,recurring_sessions:i,gym:r,nextPage:c}=n;y.disabled=!1,r&&ie(r),z([...e,...o],r.code,c),ge(i,t),ye(t),de({data:e,token:t,API:_e,extraXanoInputObj:[{gym_id:S}]},z,r.code),ae()})}function z(n,t,e,o=!1){let i=document.getElementById("table-container"),r=i.querySelector("#table-item");function c(l){Y=e;let s=i.querySelectorAll(".adb-user.w-inline-block");s.forEach((a,u)=>{u!==s.length-1&&a.remove()}),w.forEach((a,u)=>{var m,_;let p=r.cloneNode(!0);p.setAttribute("id",""),p.setAttribute("href",`/admin/session?sessionId=${a.id}`);let d=p.querySelectorAll(".colcontent");u%2===0&&(p.style.backgroundColor="#00edf4"),d[1].innerText=a.session_name,d[2].innerText=a.name||"To Be Decided",d[3].innerText=t,d[4].innerText=ee(a.time),d[5].innerText=G(a.time,!0),d[6].innerText=(_=(m=a==null?void 0:a.users)==null?void 0:m.length)!=null?_:0,d[7].innerText=a.status,p.style.display="flex",i.prepend(p)})}o?(w.push(...n),w.nextPage=e):(w=n,w.nextPage=e),c(w),r.style.display="none"}function ge(n,t){let o=document.getElementById("recursive-table-container").querySelectorAll(".recursive-table-columns");function i(r){let c;o.forEach((l,s)=>{let a=s+1,u=l.querySelector("#recursive-table-wrapper"),p=u.querySelector("#recursive-table-item");r.forEach(d=>{if(d.weekday==a){let m=p.cloneNode(!0);m.setAttribute("id","");let _=m.querySelectorAll(".colcontent");_[0].innerText=d.session_name,_[1].innerText=G(d.time,!0),_[2].innerText=te(d.duration),_[3].innerText=d.capacity;let T=m.querySelector(".delete-icon-w.off");m.onmouseover=()=>{T.style.display="flex"},m.onmouseout=()=>{T.style.display="none"};let f=m.querySelector(".delete-recurring-session");f.onclick=()=>x(this,null,function*(){document.querySelectorAll(".delete-recurring-session").forEach(L=>{L.disabled=!0});let U={recurring_id:d.id},R=yield h(pe,"POST",U,t);if(R.isFetchOk!==void 0&&!R.isFetchOk){console.error(R.message),$("#add-recurring-session-form-block").hide().siblings(".w-form-done").hide().siblings(".w-form-fail").show().text("Failed to delete recurring session"),k(1500);return}m.remove(),$("#add-recurring-session-form-block").hide().siblings(".w-form-fail").hide().siblings(".w-form-done").show().text("Successfully deleted recurring session"),k(1500)}),m.style.display="flex",u.prepend(m)}}),re({_modalWindow:"recursive-popout",TriggerBtn:"add-recursive-weekday-btn",baseElement:l},()=>{let d=document.getElementById("recursive-popout"),m=d.querySelector("#recursive-sessions-name-select"),_=d.querySelector("#recursive-sessions-duration-select"),T=d.querySelector("#recursive-sessions-capacity-select"),f=d.querySelector("#datepicker-input"),A=d.querySelector("#timepicker-input"),U=d.querySelector("#selected-day"),R=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];I(f),[R[a-1]].forEach(N=>{var E=document.createElement("option");E.value=a,E.innerText=N,E.selected=!0,f.appendChild(E)}),f.disabled=!0,U.innerText=R[a-1],A.style.color="#080808",$(A).timepicker({timeFormat:"HH:mm",interval:15,defaultTime:"7",minTime:"7",maxTime:"11:45pm",zindex:10}),I(_,0);let L=["15 mins","30 mins","45 mins","1 hour","1 hour and 15 mins","1 hour and 30 mins","1 hour and 45 mins","2 hours","2 hour and 15 mins","2 hour and 30 mins","2 hour and 45 mins","3 hours","3 hour and 15 mins","3 hour and 30 mins","3 hour and 45 mins"],Ae=["0.25","0.5","0.75","1","1.25","1.5","1.75","2","2.25","2.5","2.75","3","3.25","3.5","3.75"];L.forEach((N,E)=>{var C=document.createElement("option");C.value=Ae[E],C.innerText=N,_.appendChild(C)});function J(){return x(this,null,function*(){let N;if(c?N=c:N=yield h(K+S,"GET",!1,t),N.isFetchOk!==void 0&&!N.isFetchOk){console.error(N.message);return}c=N;let{gyms:E,session_names:C}=N;I(m),C.forEach(V=>{var F=document.createElement("option");F.value=V.name,F.innerText=V.name,m.appendChild(F)}),T.setAttribute("max",E[0].capacity),T.setAttribute("placeholder","Max capacity: "+E[0].capacity),m.removeEventListener("focus",J)})}m.addEventListener("focus",J)}),p.style.display="none"})}le({_modalWindow:"recursive-popout",TriggerBtn:"close-recursive-session-popout-btn"}),i(n)}function ye(n){$("form :input").attr("autocomplete","off");function t(){return x(this,null,function*(){let e=yield h(K+S,"GET",!1,n);if(e.isFetchOk!==void 0&&!e.isFetchOk){console.error(e.message);return}j.disabled=!1,M.disabled=!1,H.disabled=!1,P.disabled=!1,B.disabled=!1,b.disabled=!1;let{gyms:o,coaches:i}=e;I(y),o.forEach((l,s)=>{var a=document.createElement("option");a.value=l.id,a.innerText=l.location,s===0&&(a.selected=!0),y.appendChild(a)}),I(M,0),i.forEach(l=>{var s=document.createElement("option");s.value=l.id,s.innerText=l.name,M.appendChild(s)}),I(B,0);let r=["15 mins","30 mins","45 mins","1 hour","1 hour and 15 mins","1 hour and 30 mins","1 hour and 45 mins","2 hours","2 hour and 15 mins","2 hour and 30 mins","2 hour and 45 mins","3 hours","3 hour and 15 mins","3 hour and 30 mins","3 hour and 45 mins"],c=["0.25","0.5","0.75","1","1.25","1.5","1.75","2","2.25","2.5","2.75","3","3.25","3.5","3.75"];r.forEach((l,s)=>{var a=document.createElement("option");a.value=c[s],a.innerText=l,B.appendChild(a)}),b.setAttribute("max",o[0].capacity),b.setAttribute("placeholder","Max capacity: "+o[0].capacity),y.addEventListener("change",()=>{o.some(l=>l.id===parseInt(y.value)?(b.setAttribute("max",l.capacity),b.setAttribute("placeholder","Max capacity: "+l.capacity),!0):!1)},!1),y.removeEventListener("focus",t)})}y.addEventListener("focus",t)}var Se=new IntersectionObserver(n=>{n[0].intersectionRatio<=0||(q>0&&Y?Re(Y):q<1&&q++)});Se.observe(document.querySelector(".loadmore"));function Re(n){return x(this,null,function*(){let t=v();if(t){let e=yield h(W+S+`/${n}/s`,"GET",!1,t);if(e.isFetchOk!==void 0&&!e.isFetchOk){console.error(e.message),e.payload&&e.payload.role===O.ADMIN&&e.payload.gyms&&e.payload.gyms.length>0?D(`/admin/gym/g?gymCode=${e.payload.gyms[0].gym_id}`):console.log("error fetching paginated");return}let{manual_type_sessions:o,recurring_type_sessions:i,gym:r,nextPage:c}=e;z([...o,...i],r.code,c,!0)}})}var Oe=me||[];Oe.push(function(){$(document).off("submit"),$("form").on("change",function(){let n=$(this);if(n.attr("id")==="add-manual-session-form-block"){let t=n[0][0].value,e=n[0][1].value,o=n[0][3].value,i=n[0][5].value,r=n[0][6].value;t!==""&&e!==""&&e!=="Session Name"&&o!==""&&i!==""&&i!=="Duration"&&r.trim()!==""&&(n[0][7].disabled=!1,n[0][7].classList.remove("disabled"))}}),$("form").on("submit",function(n){return x(this,null,function*(){n.preventDefault();let t=$(this);if(t.attr("id")==="add-manual-session-form-block"){let e=document.getElementById("submit");e&&(e.disabled=!0,e.classList.add("disabled"));let o=v();if(o){let i=t[0][0].value,r=t[0][1].value,c=t[0][2].value,l=t[0][3].value,s=t[0][4].value,a=t[0][5].value,u=t[0][6].value;if(i!==""&&r!==""&&r!=="Session Name"&&l!==""&&s!==""&&a!==""&&a!=="Duration"&&u.trim()!==""){let p={};p.items=[...l.split(",").map(m=>{let _=m.split("/");return{gym_id:i,session_name:r,team_id:c==="Coach"?null:c,time:new Date(`${_[2]}/${_[1]}/${_[0]} ${s}`).getTime(),duration:a,capacity:u}})];let d=yield h(K+i,"POST",p,o);if(d.isFetchOk!==void 0&&!d.isFetchOk){console.error(d.message),t.siblings(".w-form-done").hide().siblings(".w-form-fail").show().text("There was an error trying to add your session. Please refresh your browser and try again."),e&&(e.disabled=!1,e.classList.remove("disabled"));return}t.hide().siblings(".w-form-done").show().siblings(".w-form-fail").hide(),k()}else r==="Session Name"?t[0][1].style.borderColor="red":t[0][1].style.borderColor="black",l.trim()===""?t[0][3].style.borderColor="red":t[0][3].style.borderColor="black",s.trim()===""?t[0][4].style.borderColor="red":t[0][4].style.borderColor="black",a==="Duration"?t[0][5].style.borderColor="red":t[0][5].style.borderColor="black",u.trim()===""?t[0][6].style.borderColor="red":t[0][6].style.borderColor="black",t.siblings(".w-form-done").hide().siblings(".w-form-fail").show().text("Please fill out all fields"),e&&(e.disabled=!1,e.classList.remove("disabled"))}}else if(t.attr("id")==="add-recurring-session-modal-form-block"){let e=document.getElementById("submit");e&&(e.disabled=!0,e.classList.add("disabled"));let o=v();if(o){let i=t[0][0].value,r=t[0][1].value,c=t[0][2].value,l=t[0][3].value,s=t[0][4].value;if(i!==""&&r!==""&&c!==""&&l!==""&&s!==""){let a={gym_id:S,session_name:i,weekday:parseInt(r),time:new Date().setHours(c.split(":")[0],c.split(":")[1],0,0),duration:l,capacity:s},u=yield h(ue,"POST",a,o);if(u.isFetchOk!==void 0&&!u.isFetchOk){console.error(u.message),t.siblings(".w-form-done").hide().siblings(".w-form-fail").show().text("There was an error trying to add your session. Please refresh your browser and try again."),e&&(e.disabled=!1,e.classList.remove("disabled"));return}t.hide().siblings(".w-form-done").show().siblings(".w-form-fail").hide(),k()}}else D(`${X}?reason=NOT_SIGNED_IN`)}})})});
