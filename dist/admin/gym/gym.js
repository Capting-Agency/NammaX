var D=Object.getOwnPropertySymbols;var Y=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var T=(t,o)=>{var n={};for(var a in t)Y.call(t,a)&&o.indexOf(a)<0&&(n[a]=t[a]);if(t!=null&&D)for(var a of D(t))o.indexOf(a)<0&&q.call(t,a)&&(n[a]=t[a]);return n};var h=(t,o,n)=>new Promise((a,l)=>{var p=e=>{try{r(n.next(e))}catch(i){l(i)}},c=e=>{try{r(n.throw(e))}catch(i){l(i)}},r=e=>e.done?a(e.value):Promise.resolve(e.value).then(p,c);r((n=n.apply(t,o)).next())});var y=["January","February","March","April","May","June","July","August","September","October","November","December"],E={ADMIN:"ADMIN",SUPER_ADMIN:"SUPER_ADMIN",COACH:"COACH"};function I(t,o="GET",n=!1,a=!1,l=!1,p=!0){try{let c={"Content-Type":"application/json"};l&&(c={}),a&&(c.Authorization=`Bearer ${a}`);let r={method:o,headers:c};return n&&(p?r.body=JSON.stringify(n):r.body=n),fetch(t,r).then(e=>e.ok?e.json():e.json().then(i=>(Promise.reject(i.message),{isFetchOk:!1,status:e.status,message:i.message,payload:i&&i.payload?i.payload:null}))).then(e=>e).catch(e=>(console.error("Error in fetch",e),e))}catch(c){return console.error("Error!: "+c),c}}function C(t="nammax_auth"){let n=`; ${document.cookie}`.split(`; ${t}=`);return n.length===2?n.pop().split(";").shift():null}function R(t="/",o=2e3){setTimeout(()=>{window.location.href=t},o)}function L(t=null,o=!1,n=!1,a=!1){if(t==null)return"NaN";let l=new Date,p=new Date(t),c=p.getHours(),r="";if(a||(r=c>=12?"PM":"AM",c=c%12||12),o){let e=p.getMinutes();return e=e<10?`0${e}`:e,n?`${l.getDate()===p.getDate()?"Today":l.getDate()+1===p.getDate()?"Tomorrow":l.getDate()+2===p.getDate()?"Day After Tomorrow":""} ${c}:${e} ${r}`:`${c}:${e} ${r}`}else return n?`${l.getDate()===p.getDate()?"Today":l.getDate()+1===p.getDate()?"Tomorrow":l.getDate()+2===p.getDate()?"Day After Tomorrow":""} ${c} ${r}`:`${c} ${r}`}function w(t=null){if(t==null)return"NaN";let o=new Date(t);return`${o.getDate()}/${o.getMonth()+1}/${o.getFullYear()}`}function B(t=null){if(t==null)return"NaN";let o=t.split("-"),n=Date.now()-new Date(parseInt(o[2]),parseInt(o[1])-1,parseInt(o[0])).getTime(),a=new Date(n);return Math.abs(a.getUTCFullYear()-1970)}function M(t,o=null){if(t!=null){var n,a=t.options.length-1;for(n=a;n>=0;n--)n!==o&&t.remove(n)}}function b(t="/admin/sign-in",o="sidebar-logout-btn"){let n=document.getElementById(o);n?n.onclick=()=>j(t):console.error("Logout button not found")}function j(t="/sign-in"){window.localStorage.removeItem("auth"),R(`${t}`)}function S(t=0){return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(Number(t)).replace(/^(\D+)/,"$1 ")}function k(t=E.ADMIN){if(t===E.ADMIN){let o=document.getElementById("admin-nav"),n=document.getElementById("super-admin-nav");o&&(o.style.display="flex"),n&&n.remove()}else if(t===E.SUPER_ADMIN){let o=document.getElementById("admin-nav"),n=document.getElementById("super-admin-nav");n&&(n.style.display="flex"),o&&o.remove()}}function X(t){if(!t)return console.error("url does not cotnain gym id");let o=document.getElementById("navbar-home"),n=document.getElementById("navbar-finance"),a=document.getElementById("navbar-users"),l=document.getElementById("navbar-sessions");o&&o.setAttribute("href",`/admin/gym/g?gymCode=${t}`),n&&n.setAttribute("href",`/admin/gym/finance?gymCode=${t}`),a&&a.setAttribute("href",`/admin/gym/users?gymCode=${t}`),l&&l.setAttribute("href",`/admin/gym/sessions?gymCode=${t}`)}function v(t){if(!t)return console.error("gym data not found");let o=document.getElementById("gym-code-location"),n=document.getElementById("header-address"),a=document.getElementById("header-partner"),l=document.getElementById("header-contact"),p=document.getElementById("header-email");o&&(o.innerText=`${t.code} \u2022 ${t.location}`),n&&(n.innerText=t.address),a&&(a.innerText=t.partner),l&&(l.innerText=t.contact),p&&(p.innerText=t.partner_email)}function K(){let t=document.getElementById("loading-screen");t?t.remove():console.log("did not find loading screen")}var O="/admin/sign-in",H="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/admin/gyms/";var P="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/admin/sessions/search/",G="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/admin/users/search/";function U({mode:t="API",clientObjRefName:o="name",data:n,token:a,API:l,extraXanoInputObj:p=[],searchContainerElId:c=""},r,e=null,i=null){let s,_,m;if(c.length>0){let d=document.getElementById(c);s=d.querySelector("#search-input"),s.setAttribute("placeholder","Search"),_=d.querySelector("#search-btn"),m=d.querySelector("#search-reset-btn")}else s=document.getElementById("search-input"),s.setAttribute("placeholder","Search"),_=document.getElementById("search-btn"),m=document.getElementById("search-reset-btn");m.onclick=()=>{s.value="",F(m,{mode:t,clientObjRefName:o,data:n,searchquery:"",token:a,API:l,extraXanoInputObj:p},r,e,i)},_.onclick=()=>{let d=s.value;F(m,{mode:t,clientObjRefName:o,data:n,searchquery:d,token:a,API:l,extraXanoInputObj:p},r,e,i)}}function F(_,m,d,u,N){return h(this,arguments,function*(t,{mode:o,clientObjRefName:n,data:a,searchquery:l,token:p,API:c,extraXanoInputObj:r=[]},e,i,s){if(l.length===0)t.style.display="none",i?e(a,i):e(a);else try{if(o==="API"){let A={search_query:`${l}:*`};r.length>0&&r.map(f=>{for(let[g,W]of Object.entries(f))A[g]=W});let x=yield I(c+"query","POST",A,p);if(x.isFetchOk!==void 0&&!x.isFetchOk)throw console.error(x.message),Error("API call failed");t.style.display="flex",i?e(x,i):e(x)}else{let A=a.filter(x=>x[n].toLowerCase().includes(l.toLowerCase()));t.style.display="flex",i?e(A,i):e(A)}}catch(A){s?s():console.error(A)}})}(()=>{let t,o;window.onload=function(){return h(this,null,function*(){b(O,"sidebar-logout-btn");var r=new URL(document.location.href);if(t=r.searchParams.get("gymCode")||null,t)X(t);else{console.error("No gym id found");return}let e=C();if(e){let s=yield I(H+t,"GET",!1,e);if(s.isFetchOk!==void 0&&!s.isFetchOk){console.error(s.message);return}let i=s,{team_role:_}=i,m=T(i,["team_role"]);_&&(_===E.SUPER_ADMIN||_===E.ADMIN)?(k(_),n(m,e)):R(`${O}?reason=UNAUTHORIZED_USER`)}else R(`${O}?reason=NOT_SIGNED_IN`)})};function n(r,e){return h(this,null,function*(){let{sessions:i,users:s,gym:_,finances:m,footfall:d}=r;_&&v(_);let u;o=m.some((A,x)=>{if(A.month===new Date().getMonth()+1)return u=x,!0})?m[u]:m[m.length-1],o===void 0&&(o=null),l(s,o,d),a(s,o,m,d),p(i.items,_.code),c(s.items),U({data:i,token:e,API:P,extraXanoInputObj:[{gym_id:t}]},p,_.code),U({data:s,token:e,API:G,searchContainerElId:"user-search-container",extraXanoInputObj:[{gym_id:t}]},c,_.code),K()})}function a(r,e,i,s){let _=document.getElementById("select-month");M(_),i.forEach((m,d)=>{var u=document.createElement("option");u.value=d,u.innerText=y[m.month-1]+", "+m.year,m.month===e.month&&(u.selected=!0),_.appendChild(u)}),_.onchange=m=>{e=i[m.target.value],e===void 0&&(e=null),l(r,e,s)}}function l(r=[],e=[],i=0){var s;e?(document.getElementById("gym-statistics-month-year").innerText=y[e.month-1]+" "+e.year,document.getElementById("financial-expenses").innerText=S(Number(e.additional_expenses)),document.getElementById("financial-revenue").innerText=S(Number(e.gross_revenue)+Number(e.additional_revenue)),document.getElementById("financial-profit").innerText=S(e.net_profit),document.getElementById("gym-statistics-total-members").innerText=(s=r==null?void 0:r.items)==null?void 0:s.length,$("#gym-statistics-completed-sessions").text(i||0),$("#gym-statistics-active-members").text(r.items.filter(_=>_.membership_status!=="INACTIVE"&&_.membership_status!=="TRIAL").length)):(document.getElementById("gym-statistics-month-year").innerText="This months data not found",document.getElementById("financial-expenses").innerText="No data found",document.getElementById("financial-revenue").innerText="No data found",document.getElementById("financial-profit").innerText="No data found")}function p(r,e){let i=document.getElementById("sessions-container"),s=i.querySelector("#table-item");function _(m){let d=i.querySelectorAll(".adb-user.w-inline-block");d.forEach((u,N)=>{N!==d.length-1&&u.remove()}),m.forEach((u,N)=>{var f,g;let A=s.cloneNode(!0);A.setAttribute("id",""),A.setAttribute("href",`/admin/session?sessionId=${u.id}`);let x=A.querySelectorAll(".colcontent");N%2===0&&(A.style.backgroundColor="#00edf4"),x[1].innerText=u.session_name,x[2].innerText=u.name||"-",x[3].innerText=e,x[4].innerText=w(u.time),x[5].innerText=L(u.time,!0),x[6].innerText=(g=(f=u==null?void 0:u.users)==null?void 0:f.length)!=null?g:0,x[7].innerText=u.status,A.style.display="flex",i.prepend(A)})}_(r),s.style.display="none"}function c(r){let e=document.getElementById("users-container"),i=e.querySelector("#table-item");function s(_){let m=e.querySelectorAll(".adb-user.w-inline-block");m.forEach((d,u)=>{u!==m.length-1&&d.remove()}),_.forEach((d,u)=>{let N=i.cloneNode(!0);N.setAttribute("id",""),N.setAttribute("href",`/admin/user?userId=${d.id}`),u%2===0&&(N.style.backgroundColor="#00edf4");let A=N.querySelectorAll(".colcontent");d.profile_picture&&(A[0].style.backgroundImage=`url(${d.profile_picture.url})`),A[1].innerText=d.name,A[2].innerText=d.membership_status||"INACTIVE",A[3].innerText=d.gender,A[4].innerText=B(d.date_of_birth),N.style.display="flex",e.prepend(N)})}s(r),i.style.display="none"}})();
