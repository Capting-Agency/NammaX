var T=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var D=(t,o)=>{var n={};for(var i in t)W.call(t,i)&&o.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&T)for(var i of T(t))o.indexOf(i)<0&&Y.call(t,i)&&(n[i]=t[i]);return n};var h=(t,o,n)=>new Promise((i,_)=>{var u=e=>{try{s(n.next(e))}catch(a){_(a)}},x=e=>{try{s(n.throw(e))}catch(a){_(a)}},s=e=>e.done?i(e.value):Promise.resolve(e.value).then(u,x);s((n=n.apply(t,o)).next())});var y=["January","February","March","April","May","June","July","August","September","October","November","December"],E={ADMIN:"ADMIN",SUPER_ADMIN:"SUPER_ADMIN",COACH:"COACH"};function R(t,o="GET",n=!1,i=!1,_=!1,u=!0){try{let x={"Content-Type":"application/json"};_&&(x={}),i&&(x.Authorization=`Bearer ${i}`);let s={method:o,headers:x};return n&&(u?s.body=JSON.stringify(n):s.body=n),fetch(t,s).then(e=>e.ok?e.json():e.json().then(a=>(Promise.reject(a.message),{isFetchOk:!1,status:e.status,message:a.message,payload:a&&a.payload?a.payload:null}))).then(e=>e).catch(e=>(console.error("Error in fetch",e),e))}catch(x){return console.error("Error!: "+x),x}}function C(t="nammax_auth"){let n=`; ${document.cookie}`.split(`; ${t}=`);return n.length===2?n.pop().split(";").shift():null}function S(t="/",o=0){setTimeout(()=>{window.location.href=t},o)}function L(t=null,o=!1){if(t==null)return"NaN";var n=new Date(t),i=n.getHours(),_=i>=12?"PM":"AM";if(i=i%12||12,o){var u=n.getMinutes();return u=u<10?`0${u}`:u,`${i}:${u} ${_}`}else return`${i} ${_}`}function w(t=null){if(t==null)return"NaN";let o=new Date(t);return`${o.getDate()}/${o.getMonth()+1}/${o.getFullYear()}`}function B(t=null){if(t==null)return"NaN";let o=t.split("-"),n=Date.now()-new Date(parseInt(o[2]),parseInt(o[1])-1,parseInt(o[0])).getTime(),i=new Date(n);return Math.abs(i.getUTCFullYear()-1970)}function b(t,o=null){if(t!=null){var n,i=t.options.length-1;for(n=i;n>=0;n--)n!==o&&t.remove(n)}}function M(t="/admin/sign-in",o="sidebar-logout-btn"){let n=document.getElementById(o);n?n.onclick=()=>q(t):console.error("Logout button not found")}function q(t="/sign-in"){window.localStorage.removeItem("auth"),S(`${t}`)}function g(t=0){return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(Number(t)).replace(/^(\D+)/,"$1 ")}function k(t=E.ADMIN){if(t===E.ADMIN){let o=document.getElementById("admin-nav"),n=document.getElementById("super-admin-nav");o&&(o.style.display="flex"),n&&n.remove()}else if(t===E.SUPER_ADMIN){let o=document.getElementById("admin-nav"),n=document.getElementById("super-admin-nav");n&&(n.style.display="flex"),o&&o.remove()}}function X(t){if(!t)return console.error("url does not cotnain gym id");let o=document.getElementById("navbar-home"),n=document.getElementById("navbar-finance"),i=document.getElementById("navbar-users"),_=document.getElementById("navbar-sessions");o&&o.setAttribute("href",`/admin/gym/g?gymCode=${t}`),n&&n.setAttribute("href",`/admin/gym/finance?gymCode=${t}`),i&&i.setAttribute("href",`/admin/gym/users?gymCode=${t}`),_&&_.setAttribute("href",`/admin/gym/sessions?gymCode=${t}`)}function v(t){if(!t)return console.error("gym data not found");let o=document.getElementById("gym-code-location"),n=document.getElementById("header-address"),i=document.getElementById("header-partner"),_=document.getElementById("header-contact"),u=document.getElementById("header-email");o&&(o.innerText=`${t.code} \u2022 ${t.location}`),n&&(n.innerText=t.address),i&&(i.innerText=t.partner),_&&(_.innerText=t.contact),u&&(u.innerText=t.partner_email)}var O="/admin/sign-in",K="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/admin/gyms/";var H="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/admin/sessions/search/",P="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/admin/users/search/";function U({mode:t="API",clientObjRefName:o="name",data:n,token:i,API:_,extraXanoInputObj:u=[],searchContainerElId:x=""},s,e=null,a=null){let r,p,l;if(x.length>0){let c=document.getElementById(x);r=c.querySelector("#search-input"),r.setAttribute("placeholder","Search"),p=c.querySelector("#search-btn"),l=c.querySelector("#search-reset-btn")}else r=document.getElementById("search-input"),r.setAttribute("placeholder","Search"),p=document.getElementById("search-btn"),l=document.getElementById("search-reset-btn");l.onclick=()=>{r.value="",G(l,{mode:t,clientObjRefName:o,data:n,searchquery:"",token:i,API:_,extraXanoInputObj:u},s,e,a)},p.onclick=()=>{let c=r.value;G(l,{mode:t,clientObjRefName:o,data:n,searchquery:c,token:i,API:_,extraXanoInputObj:u},s,e,a)}}function G(p,l,c,m,N){return h(this,arguments,function*(t,{mode:o,clientObjRefName:n,data:i,searchquery:_,token:u,API:x,extraXanoInputObj:s=[]},e,a,r){if(_.length===0)t.style.display="none",a?e(i,a):e(i);else try{if(o==="API"){let d={search_query:`${_}:*`};s.length>0&&s.map(f=>{for(let[I,F]of Object.entries(f))d[I]=F});let A=yield R(x+"query","POST",d,u);if(A.isFetchOk!==void 0&&!A.isFetchOk)throw console.error(A.message),Error("API call failed");t.style.display="flex",a?e(A,a):e(A)}else{let d=i.filter(A=>A[n].toLowerCase().includes(_.toLowerCase()));t.style.display="flex",a?e(d,a):e(d)}}catch(d){r?r():console.error(d)}})}(()=>{let t,o;window.onload=function(){return h(this,null,function*(){M(O,"sidebar-logout-btn");var s=new URL(document.location.href);if(t=s.searchParams.get("gymCode")||null,t)X(t);else{console.error("No gym id found");return}let e=C();if(e){let r=yield R(K+t,"GET",!1,e);if(r.isFetchOk!==void 0&&!r.isFetchOk){console.error(r.message);return}let a=r,{team_role:p}=a,l=D(a,["team_role"]);p&&(p===E.SUPER_ADMIN||p===E.ADMIN)?(k(p),n(l,e)):S(`${O}?reason=UNAUTHORIZED_USER`)}else S(`${O}?reason=NOT_SIGNED_IN`)})};function n(s,e){return h(this,null,function*(){let{sessions:a,users:r,gym:p,finances:l,footfall:c}=s;p&&v(p);let m;o=l.some((d,A)=>{if(d.month===new Date().getMonth()+1)return m=A,!0})?l[m]:l[l.length-1],o===void 0&&(o=null),_(r,o,c),i(r,o,l,c),u(a,p.code),x(r),U({data:a,token:e,API:H,extraXanoInputObj:[{gym_id:t}]},u,p.code),U({data:r,token:e,API:P,searchContainerElId:"user-search-container",extraXanoInputObj:[{gym_id:t}]},x,p.code)})}function i(s,e,a,r){let p=document.getElementById("select-month");b(p),a.forEach((l,c)=>{var m=document.createElement("option");m.value=c,m.innerText=y[l.month-1]+", "+l.year,l.month===e.month&&(m.selected=!0),p.appendChild(m)}),p.onchange=l=>{e=a[l.target.value],e===void 0&&(e=null),_(s,e,r)}}function _(s=[],e=[],a=0){e?(document.getElementById("gym-statistics-month-year").innerText=y[e.month-1]+" "+e.year,document.getElementById("financial-expenses").innerText=g(Number(e.additional_expenses)),document.getElementById("financial-revenue").innerText=g(Number(e.gross_revenue)+Number(e.additional_revenue)),document.getElementById("financial-profit").innerText=g(e.net_profit),document.getElementById("gym-statistics-total-members").innerText=s==null?void 0:s.length,$("#gym-statistics-completed-sessions").text(a||0),$("#gym-statistics-active-members").text(s.filter(r=>r.membership_status!=="INACTIVE"&&r.membership_status!=="TRIAL").length)):(document.getElementById("gym-statistics-month-year").innerText="This months data not found",document.getElementById("financial-expenses").innerText="No data found",document.getElementById("financial-revenue").innerText="No data found",document.getElementById("financial-profit").innerText="No data found")}function u(s,e){let a=document.getElementById("sessions-container"),r=a.querySelector("#table-item");function p(l){let c=a.querySelectorAll(".adb-user.w-inline-block");c.forEach((m,N)=>{N!==c.length-1&&m.remove()}),l.forEach((m,N)=>{var f,I;let d=r.cloneNode(!0);d.setAttribute("id",""),d.setAttribute("href",`/admin/session?sessionId=${m.id}`);let A=d.querySelectorAll(".colcontent");N%2===0&&(d.style.backgroundColor="#00edf4"),A[1].innerText=m.session_name,A[2].innerText=m.name||"Unknown",A[3].innerText=e,A[4].innerText=w(m.time),A[5].innerText=L(m.time,!0),A[6].innerText=(I=(f=m==null?void 0:m.users)==null?void 0:f.length)!=null?I:0,A[7].innerText=m.status,d.style.display="flex",a.prepend(d)})}p(s),r.style.display="none"}function x(s){let e=document.getElementById("users-container"),a=e.querySelector("#table-item");function r(p){let l=e.querySelectorAll(".adb-user.w-inline-block");l.forEach((c,m)=>{m!==l.length-1&&c.remove()}),p.forEach((c,m)=>{let N=a.cloneNode(!0);N.setAttribute("id",""),N.setAttribute("href",`/admin/user?userId=${c.id}`),m%2===0&&(N.style.backgroundColor="#00edf4");let d=N.querySelectorAll(".colcontent");c.profile_picture&&(d[0].style.backgroundImage=`url(${c.profile_picture.url})`),d[1].innerText=c.name,d[2].innerText=c.membership_status||"INACTIVE",d[3].innerText=c.gender,d[4].innerText=B(c.date_of_birth),N.style.display="flex",e.prepend(N)})}r(s),a.style.display="none"}})();
