var g=Object.getOwnPropertySymbols;var H=Object.prototype.hasOwnProperty,v=Object.prototype.propertyIsEnumerable;var O=(t,e)=>{var n={};for(var i in t)H.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&g)for(var i of g(t))e.indexOf(i)<0&&v.call(t,i)&&(n[i]=t[i]);return n};var N=(t,e,n)=>new Promise((i,r)=>{var _=o=>{try{l(n.next(o))}catch(a){r(a)}},s=o=>{try{l(n.throw(o))}catch(a){r(a)}},l=o=>o.done?i(o.value):Promise.resolve(o.value).then(_,s);l((n=n.apply(t,e)).next())});var I=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];var u={ADMIN:"ADMIN",SUPER_ADMIN:"SUPER_ADMIN",COACH:"COACH"};function x(t,e="GET",n=!1,i=!1,r=!1,_=!0){try{let s={"Content-Type":"application/json"};r&&(s={}),i&&(s.Authorization=`Bearer ${i}`);let l={method:e,headers:s};return n&&(_?l.body=JSON.stringify(n):l.body=n),fetch(t,l).then(o=>o.ok?o.json():o.json().then(a=>(Promise.reject(a.message),{isFetchOk:!1,status:o.status,message:a.message,payload:a&&a.payload?a.payload:null}))).then(o=>o).catch(o=>(console.error("Error in fetch",o),o))}catch(s){return console.error("Error!: "+s),s}}function D(t="nammax_auth"){let n=`; ${document.cookie}`.split(`; ${t}=`);return n.length===2?n.pop().split(";").shift():null}function E(t="/",e=2e3){setTimeout(()=>{window.location.href=t},e)}function h(t=null,e=!1,n=!1,i=!1){if(t==null)return"NaN";let r=new Date,_=new Date(t),s=_.getHours(),l="";if(i||(l=s>=12?"PM":"AM",s=s%12||12),e){let o=_.getMinutes();return o=o<10?`0${o}`:o,n?`${r.getDate()===_.getDate()?"Today":r.getDate()+1===_.getDate()?"Tomorrow":r.getDate()+2===_.getDate()?"Day After Tomorrow":""} ${s}:${o} ${l}`:`${s}:${o} ${l}`}else return n?`${r.getDate()===_.getDate()?"Today":r.getDate()+1===_.getDate()?"Tomorrow":r.getDate()+2===_.getDate()?"Day After Tomorrow":""} ${s} ${l}`:`${s} ${l}`}function U(t=null){if(t==null)return"NaN";let e=new Date(t);return`${e.getDate()}/${e.getMonth()+1}/${e.getFullYear()}`}function T(t=null){if(t==null)return"NaN";t=t*60;let e=`${t/60^0}`.slice(-2),n=("0"+t%60).slice(-2);return e!="0"?n!="00"?`${e} HR ${n} M`:e+" HR":n+" Mins"}function y(t="/admin/sign-in",e="sidebar-logout-btn"){let n=document.getElementById(e);n?n.onclick=()=>P(t):console.error("Logout button not found")}function P(t="/sign-in"){window.localStorage.removeItem("auth"),E(`${t}`)}function L(t=u.ADMIN){if(t===u.ADMIN){let e=document.getElementById("admin-nav"),n=document.getElementById("super-admin-nav");e&&(e.style.display="flex"),n&&n.remove()}else if(t===u.SUPER_ADMIN){let e=document.getElementById("admin-nav"),n=document.getElementById("super-admin-nav");n&&(n.style.display="flex"),e&&e.remove()}}function w(){let t=document.getElementById("loading-screen");t?t.remove():console.log("did not find loading screen")}function M({mode:t="API",clientObjRefName:e="name",data:n,token:i,API:r,extraXanoInputObj:_=[],searchContainerElId:s=""},l,o=null,a=null){let c,f,A;if(s.length>0){let d=document.getElementById(s);c=d.querySelector("#search-input"),c.setAttribute("placeholder","Search"),f=d.querySelector("#search-btn"),A=d.querySelector("#search-reset-btn")}else c=document.getElementById("search-input"),c.setAttribute("placeholder","Search"),f=document.getElementById("search-btn"),A=document.getElementById("search-reset-btn");A.onclick=()=>{c.value="",C(A,{mode:t,clientObjRefName:e,data:n,searchquery:"",token:i,API:r,extraXanoInputObj:_},l,o,a)},f.onclick=()=>{let d=c.value;C(A,{mode:t,clientObjRefName:e,data:n,searchquery:d,token:i,API:r,extraXanoInputObj:_},l,o,a)}}function C(f,A,d,it,st){return N(this,arguments,function*(t,{mode:e,clientObjRefName:n,data:i,searchquery:r,token:_,API:s,extraXanoInputObj:l=[]},o,a,c){if(r.length===0)t.style.display="none",a?o(i,a):o(i);else try{if(e==="API"){let m={search_query:`${r}:*`};l.length>0&&l.map(b=>{for(let[X,K]of Object.entries(b))m[X]=K});let p=yield x(s+"query","POST",m,_);if(p.isFetchOk!==void 0&&!p.isFetchOk)throw console.error(p.message),Error("API call failed");t.style.display="flex",a?o(p,a):o(p)}else{let m=i.filter(p=>p[n].toLowerCase().includes(r.toLowerCase()));t.style.display="flex",a?o(m,a):o(m)}}catch(m){c?c():console.error(m)}})}var R="/admin/sign-in";var B="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/admin/session_detail/";var S;window.onload=function(){return N(this,null,function*(){y("/admin/sign-in","sidebar-logout-btn");var t=new URL(document.location.href);if(S=t.searchParams.get("sessionId")||null,!S){console.error("No session id found");return}let e=D();if(e){let i=yield x(B+S,"GET",!1,e);if(i.isFetchOk!==void 0&&!i.isFetchOk){console.error(i.message);return}let n=i,{team_role:r}=n,_=O(n,["team_role"]);r&&(r===u.SUPER_ADMIN||r===u.ADMIN)?(L(r),G(_)):E(`${R}?reason=UNAUTHORIZED_USER`)}else E(`${R}?reason=NOT_SIGNED_IN`)})};function G(t){return N(this,null,function*(){let{sessions:e}=t;F(e),k(e.users),M({mode:"client",clientObjRefName:"name",data:e.users},k),w()})}function F(t){var n,i,r,_,s,l,o;$("#session-detail-name").text(t.session_name),$("#session-detail-coach").text(t.name),$("#session-detail-location").text(t.location),$("#session-detail-date").text(`${U(t.time)} (${I[new Date(t.time).getDay()]})`),$("#session-detail-duration").text(T(t.duration)),$("#session-detail-scheduled-time").text(h(t.time,!0)),$("#session-detail-start-time").text((n=h(t.start_time,!0))!=null?n:"NaN"),$("#session-detail-end-time").text((i=h(t.end_time,!0))!=null?i:"NaN");let e=(_=(r=t==null?void 0:t.users)==null?void 0:r.filter(a=>a.attended===!0).length)!=null?_:0;$("#session-detail-signed-up-users").text((l=(s=t==null?void 0:t.users)==null?void 0:s.length)!=null?l:"0"),$("#session-detail-missed-users").text(((o=t==null?void 0:t.users)==null?void 0:o.length)-e),$("#session-detail-attended-users").text(e),$("#session-comment").text(t.comments!==""?t.comments:"No comments")}function k(t){let e=document.getElementById("table-container"),n=e.querySelector("#table-item");function i(r){let _=e.querySelectorAll(".adb-user.w-inline-block");_.forEach((s,l)=>{l!==_.length-1&&s.remove()}),r==null||r.forEach((s,l)=>{let o=n.cloneNode(!0);o.setAttribute("id",""),o.setAttribute("href",`/admin/user?userId=${s.user_id}`);let a=o.querySelectorAll(".colcontent");l%2===0&&(o.style.backgroundColor="#00edf4"),s.profile_picture&&(a[0].style.backgroundImage=`url(${s.profile_picture.url})`),a[1].innerText=s.name,a[2].innerText=s.status,a[3].innerText="NaN",a[4].innerText="NaN",a[5].innerText="NaN",a[6].innerText=s.gender,o.style.display="flex",e.prepend(o)})}i(t),n.style.display="none"}
