var I=Object.getOwnPropertySymbols;var v=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var O=(t,e)=>{var n={};for(var o in t)v.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(t!=null&&I)for(var o of I(t))e.indexOf(o)<0&&H.call(t,o)&&(n[o]=t[o]);return n};var N=(t,e,n)=>new Promise((o,r)=>{var l=i=>{try{_(n.next(i))}catch(s){r(s)}},a=i=>{try{_(n.throw(i))}catch(s){r(s)}},_=i=>i.done?o(i.value):Promise.resolve(i.value).then(l,a);_((n=n.apply(t,e)).next())});var g=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];var u={ADMIN:"ADMIN",SUPER_ADMIN:"SUPER_ADMIN",COACH:"COACH"};function x(t,e="GET",n=!1,o=!1,r=!1,l=!0){try{let a={"Content-Type":"application/json"};r&&(a={}),o&&(a.Authorization=`Bearer ${o}`);let _={method:e,headers:a};return n&&(l?_.body=JSON.stringify(n):_.body=n),fetch(t,_).then(i=>i.ok?i.json():i.json().then(s=>(Promise.reject(s.message),{isFetchOk:!1,status:i.status,message:s.message,payload:s&&s.payload?s.payload:null}))).then(i=>i).catch(i=>(console.error("Error in fetch",i),i))}catch(a){return console.error("Error!: "+a),a}}function U(t="nammax_auth"){let n=`; ${document.cookie}`.split(`; ${t}=`);return n.length===2?n.pop().split(";").shift():null}function E(t="/",e=2e3){setTimeout(()=>{window.location.href=t},e)}function h(t=null,e=!1){if(t==null)return"NaN";var n=new Date(t),o=n.getHours(),r=o>=12?"PM":"AM";if(o=o%12||12,e){var l=n.getMinutes();return l=l<10?`0${l}`:l,`${o}:${l} ${r}`}else return`${o} ${r}`}function D(t=null){if(t==null)return"NaN";let e=new Date(t);return`${e.getDate()}/${e.getMonth()+1}/${e.getFullYear()}`}function L(t=null){if(t==null)return"NaN";t=t*60;let e=`${t/60^0}`.slice(-2),n=("0"+t%60).slice(-2);return e!="0"?n!="00"?`${e} HR ${n} M`:e+" HR":n+" Mins"}function y(t="/admin/sign-in",e="sidebar-logout-btn"){let n=document.getElementById(e);n?n.onclick=()=>P(t):console.error("Logout button not found")}function P(t="/sign-in"){window.localStorage.removeItem("auth"),E(`${t}`)}function T(t=u.ADMIN){if(t===u.ADMIN){let e=document.getElementById("admin-nav"),n=document.getElementById("super-admin-nav");e&&(e.style.display="flex"),n&&n.remove()}else if(t===u.SUPER_ADMIN){let e=document.getElementById("admin-nav"),n=document.getElementById("super-admin-nav");n&&(n.style.display="flex"),e&&e.remove()}}function w(){let t=document.getElementById("loading-screen");t?t.remove():console.log("did not find loading screen")}function M({mode:t="API",clientObjRefName:e="name",data:n,token:o,API:r,extraXanoInputObj:l=[],searchContainerElId:a=""},_,i=null,s=null){let c,f,A;if(a.length>0){let d=document.getElementById(a);c=d.querySelector("#search-input"),c.setAttribute("placeholder","Search"),f=d.querySelector("#search-btn"),A=d.querySelector("#search-reset-btn")}else c=document.getElementById("search-input"),c.setAttribute("placeholder","Search"),f=document.getElementById("search-btn"),A=document.getElementById("search-reset-btn");A.onclick=()=>{c.value="",C(A,{mode:t,clientObjRefName:e,data:n,searchquery:"",token:o,API:r,extraXanoInputObj:l},_,i,s)},f.onclick=()=>{let d=c.value;C(A,{mode:t,clientObjRefName:e,data:n,searchquery:d,token:o,API:r,extraXanoInputObj:l},_,i,s)}}function C(f,A,d,it,st){return N(this,arguments,function*(t,{mode:e,clientObjRefName:n,data:o,searchquery:r,token:l,API:a,extraXanoInputObj:_=[]},i,s,c){if(r.length===0)t.style.display="none",s?i(o,s):i(o);else try{if(e==="API"){let m={search_query:`${r}:*`};_.length>0&&_.map(b=>{for(let[X,K]of Object.entries(b))m[X]=K});let p=yield x(a+"query","POST",m,l);if(p.isFetchOk!==void 0&&!p.isFetchOk)throw console.error(p.message),Error("API call failed");t.style.display="flex",s?i(p,s):i(p)}else{let m=o.filter(p=>p[n].toLowerCase().includes(r.toLowerCase()));t.style.display="flex",s?i(m,s):i(m)}}catch(m){c?c():console.error(m)}})}var R="/admin/sign-in";var B="https://x8ki-letl-twmt.n7.xano.io/api:Kml2N_BA/admin/session_detail/";var S;window.onload=function(){return N(this,null,function*(){y("/admin/sign-in","sidebar-logout-btn");var t=new URL(document.location.href);if(S=t.searchParams.get("sessionId")||null,!S){console.error("No session id found");return}let e=U();if(e){let o=yield x(B+S,"GET",!1,e);if(o.isFetchOk!==void 0&&!o.isFetchOk){console.error(o.message);return}let n=o,{team_role:r}=n,l=O(n,["team_role"]);r&&(r===u.SUPER_ADMIN||r===u.ADMIN)?(T(r),G(l)):E(`${R}?reason=UNAUTHORIZED_USER`)}else E(`${R}?reason=NOT_SIGNED_IN`)})};function G(t){return N(this,null,function*(){let{sessions:e}=t;F(e),k(e.users),M({mode:"client",clientObjRefName:"name",data:e.users},k),w()})}function F(t){var n,o,r,l,a,_,i;$("#session-detail-name").text(t.session_name),$("#session-detail-coach").text(t.name),$("#session-detail-location").text(t.location),$("#session-detail-date").text(`${D(t.time)} (${g[new Date(t.time).getDay()]})`),$("#session-detail-duration").text(L(t.duration)),$("#session-detail-scheduled-time").text(h(t.time,!0)),$("#session-detail-start-time").text((n=h(t.start_time,!0))!=null?n:"NaN"),$("#session-detail-end-time").text((o=h(t.end_time,!0))!=null?o:"NaN");let e=(l=(r=t==null?void 0:t.users)==null?void 0:r.filter(s=>s.attended===!0).length)!=null?l:0;$("#session-detail-signed-up-users").text((_=(a=t==null?void 0:t.users)==null?void 0:a.length)!=null?_:"0"),$("#session-detail-missed-users").text(((i=t==null?void 0:t.users)==null?void 0:i.length)-e),$("#session-detail-attended-users").text(e),$("#session-comment").text(t.comments!==""?t.comments:"No comments")}function k(t){let e=document.getElementById("table-container"),n=e.querySelector("#table-item");function o(r){let l=e.querySelectorAll(".adb-user.w-inline-block");l.forEach((a,_)=>{_!==l.length-1&&a.remove()}),r==null||r.forEach((a,_)=>{let i=n.cloneNode(!0);i.setAttribute("id",""),i.setAttribute("href",`/admin/user?userId=${a.user_id}`);let s=i.querySelectorAll(".colcontent");_%2===0&&(i.style.backgroundColor="#00edf4"),a.profile_picture&&(s[0].style.backgroundImage=`url(${a.profile_picture.url})`),s[1].innerText=a.name,s[2].innerText=a.status,s[3].innerText="NaN",s[4].innerText="NaN",s[5].innerText="NaN",s[6].innerText=a.gender,i.style.display="flex",e.prepend(i)})}o(t),n.style.display="none"}
