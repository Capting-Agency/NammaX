var D=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var U=(e,t)=>{var o={};for(var s in e)G.call(e,s)&&t.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&D)for(var s of D(e))t.indexOf(s)<0&&W.call(e,s)&&(o[s]=e[s]);return o};var A=(e,t,o)=>new Promise((s,a)=>{var i=r=>{try{c(o.next(r))}catch(l){a(l)}},n=r=>{try{c(o.throw(r))}catch(l){a(l)}},c=r=>r.done?s(r.value):Promise.resolve(r.value).then(i,n);c((o=o.apply(e,t)).next())});var f={ADMIN:"ADMIN",SUPER_ADMIN:"SUPER_ADMIN",COACH:"COACH"};function h(e,t="GET",o=!1,s=!1,a=!1,i=!0){try{let n={"Content-Type":"application/json"};a&&(n={}),s&&(n.Authorization=`Bearer ${s}`);let c={method:t,headers:n};return o&&(i?c.body=JSON.stringify(o):c.body=o),fetch(e,c).then(r=>r.ok?r.json():r.json().then(l=>(Promise.reject(l.message),{isFetchOk:!1,status:r.status,message:l.message,payload:l&&l.payload?l.payload:null}))).then(r=>r).catch(r=>(console.error("Error in fetch",r),r))}catch(n){return console.error("Error!: "+n),n}}function R(e="nammax_auth"){let o=`; ${document.cookie}`.split(`; ${e}=`);return o.length===2?o.pop().split(";").shift():null}function O(e="/",t=2e3){setTimeout(()=>{window.location.href=e},t)}function T(e=null,t=!1,o=!1,s=!1){if(e==null)return"NaN";let a=new Date,i=new Date(e),n=i.getHours(),c="";if(s||(c=n>=12?"PM":"AM",n=n%12||12),t){let r=i.getMinutes();return r=r<10?`0${r}`:r,o?`${a.getDate()===i.getDate()?"Today":a.getDate()+1===i.getDate()?"Tomorrow":a.getDate()+2===i.getDate()?"Day After Tomorrow":N(e)} ${n}:${r} ${c}`:`${n}:${r} ${c}`}else return o?`${a.getDate()===i.getDate()?"Today":a.getDate()+1===i.getDate()?"Tomorrow":a.getDate()+2===i.getDate()?"Day After Tomorrow":N(e)} ${n} ${c}`:`${N(e)} ${n} ${c}`}function N(e=null){if(e==null)return"NaN";let t=new Date(e);return`${t.getDate()}/${t.getMonth()+1}/${t.getFullYear()}`}function b(e=null){if(e==null)return"NaN";let t=e.split("-"),o=Date.now()-new Date(parseInt(t[2]),parseInt(t[1])-1,parseInt(t[0])).getTime(),s=new Date(o);return Math.abs(s.getUTCFullYear()-1970)}function E(e,t=null){if(e!=null){var o,s=e.options.length-1;for(o=s;o>=0;o--)o!==t&&e.remove(o)}}function L(e="/admin/sign-in",t="sidebar-logout-btn"){let o=document.getElementById(t);o?o.onclick=()=>Y(e):console.error("Logout button not found")}function Y(e="/sign-in"){window.localStorage.removeItem("auth"),O(`${e}`)}function C(e=null,t=0){if(e==null)return"NaN";var o=e.getDate();return e.setMonth(e.getMonth()+ +t),e.getDate()!=o&&e.setDate(0),e}function B(e=new Date,t=0){let o=e;return o&&o.setDate(o.getDate()+t),o}function M(e=f.ADMIN){if(e===f.ADMIN){let t=document.getElementById("admin-nav"),o=document.getElementById("super-admin-nav");t&&(t.style.display="flex"),o&&o.remove()}else if(e===f.SUPER_ADMIN){let t=document.getElementById("admin-nav"),o=document.getElementById("super-admin-nav");o&&(o.style.display="flex"),t&&t.remove()}}function w(){let e=document.getElementById("loading-screen");e?e.remove():console.log("did not find loading screen")}function X({mode:e="API",clientObjRefName:t="name",data:o,token:s,API:a,extraXanoInputObj:i=[],searchContainerElId:n=""},c,r=null,l=null){let m,d,_;if(n.length>0){let u=document.getElementById(n);m=u.querySelector("#search-input"),m.setAttribute("placeholder","Search"),d=u.querySelector("#search-btn"),_=u.querySelector("#search-reset-btn")}else m=document.getElementById("search-input"),m.setAttribute("placeholder","Search"),d=document.getElementById("search-btn"),_=document.getElementById("search-reset-btn");_.onclick=()=>{m.value="",v(_,{mode:e,clientObjRefName:t,data:o,searchquery:"",token:s,API:a,extraXanoInputObj:i},c,r,l)},d.onclick=()=>{let u=m.value;v(_,{mode:e,clientObjRefName:t,data:o,searchquery:u,token:s,API:a,extraXanoInputObj:i},c,r,l)}}function v(d,_,u,S,xe){return A(this,arguments,function*(e,{mode:t,clientObjRefName:o,data:s,searchquery:a,token:i,API:n,extraXanoInputObj:c=[]},r,l,m){if(a.length===0)e.style.display="none",l?r(s,l):r(s);else try{if(t==="API"){let p={search_query:`${a}:*`};c.length>0&&c.map(H=>{for(let[k,F]of Object.entries(H))p[k]=F});let x=yield h(n+"query","POST",p,i);if(x.isFetchOk!==void 0&&!x.isFetchOk)throw console.error(x.message),Error("API call failed");e.style.display="flex",l?r(x,l):r(x)}else{let p=s.filter(x=>x[o].toLowerCase().includes(a.toLowerCase()));e.style.display="flex",l?r(p,l):r(p)}}catch(p){m?m():console.error(p)}})}var j=Webflow||[];var y="/admin/sign-in";var I="https://xoxo-jnzf-s0on.m2.xano.io/api:Kml2N_BA/admin/user_detail/",P="https://xoxo-jnzf-s0on.m2.xano.io/api:Kml2N_BA/admin/user_detail/payment/";var g,K;window.onload=function(){return A(this,null,function*(){L(y,"sidebar-logout-btn");var e=new URL(document.location.href);if(g=e.searchParams.get("userId")||null,!g){console.error("No user id found");return}let t=R();if(t){let s=yield h(I+g,"GET",!1,t);if(s.isFetchOk!==void 0&&!s.isFetchOk){console.error(s.message);return}let o=s,{team_role:a}=o,i=U(o,["team_role"]);a&&(a===f.SUPER_ADMIN||a===f.ADMIN)?(M(a),q(i)):O(`${y}?reason=UNAUTHORIZED_USER`)}else O(`${y}?reason=NOT_SIGNED_IN`)})};function q(e){return A(this,null,function*(){let{gyms:t,user:o,payment_ledger:s}=e;K=o.gym_id,J(o,t),z(o.session_ledger),Q(s),V(),X({mode:"client",clientObjRefName:"session_name",data:o.session_ledger},z),w()})}function J(e,t){e.profile_picture&&$("#user-detail-pfp").css("background-image",`url(${e.profile_picture.url})`),$("#user-detail-name").text(e.name),$("#user-detail-email").text(e.email),$("#user-detail-gender").text(e.gender),$("#user-detail-number").text(e.contact_number),$("#user-detail-weight").text(e.weight),$("#user-detail-height").text(e.height),$("#user-detail-dob").text(`${e.date_of_birth} (${b(e.date_of_birth)} Y/O)`);let o=document.getElementById("user-detail-gym");E(o),t.forEach(a=>{var i=document.createElement("option");i.value=a.id,i.innerText=a.location,a.id===e.gym_id&&(i.selected=!0),o.appendChild(i)}),new Date(e.membership_end_date).getTime()>new Date().getTime()?$("#user-detail-membership").text(`${e.membership_status} (${e.membership_end_date})`).css("background-color","#fff").css("color","#000"):$("#user-detail-membership").text("No Membership").css("background-color","#ff634e");let s=document.getElementById("user-detail-fitness-level");E(s),["Beginner","Amateur","Advanced","Hardcore"].forEach(a=>{var i=document.createElement("option");i.value=a,i.innerText=a,a===e.level&&(i.selected=!0),s.appendChild(i)})}function z(e){let t=document.getElementById("table-container"),o=t.querySelector("#table-item");function s(a){let i=t.querySelectorAll(".adb-user.w-inline-block");i.forEach((n,c)=>{c!==i.length-1&&n.remove()}),a.forEach((n,c)=>{var m;let r=o.cloneNode(!0);r.setAttribute("id",""),r.setAttribute("href",`/admin/session?sessionId=${n.sessions_id}`);let l=r.querySelectorAll(".colcontent");c%2===0&&(r.style.backgroundColor="#00edf4"),l[1].innerText=n.session_name,l[2].innerText=n.name,l[3].innerText=n.code,l[4].innerText=N(n.time),l[5].innerText=T(n.time,!0),l[6].innerText=((m=n==null?void 0:n.users)==null?void 0:m.length)||0,l[7].innerText=n.status,r.style.display="flex",t.prepend(r)})}s(e),o.style.display="none"}function Q(e){let t=document.getElementById("payment-container"),o=t.querySelector("#payment-item");function s(a){a.sort((n,c)=>n.time-c.time).forEach((n,c)=>{let r=o.cloneNode(!0);r.setAttribute("id","");let l=r.querySelectorAll(".colcontent");c%2===0&&(r.style.backgroundColor="#00edf4"),l[0].innerText=n.amount,l[1].innerText=n.mode_of_payment,l[2].innerText=n.membership_plan,l[3].innerText=N(n.time),l[4].innerText=n.transaction_id||"NaN",r.style.display="flex",t.prepend(r)})}s(e),o.style.display="none"}function V(){let e=document.getElementById("mode-of-payment-select"),t=document.getElementById("membership-plan-select"),o=document.getElementById("datepicker-input"),s=document.getElementById("num_of_tokens");E(e),["Cash","Card","Online"].forEach((a,i)=>{var n=document.createElement("option");n.value=a,n.innerText=a,i===0&&(n.selected=!0),e.appendChild(n)}),E(t),["1 day","7 days","21 days","1 month","3 months","6 months","1 year"].forEach((a,i)=>{var n=document.createElement("option");n.value=a,n.innerText=a,i===0&&(n.selected=!0),s.value=1,t.appendChild(n)}),t.onchange=a=>{a.target.value==="1 day"?s.value=1:a.target.value==="7 days"?s.value=7:a.target.value==="21 days"?s.value=21:a.target.value==="1 month"?s.value=30:a.target.value==="3 months"?s.value=90:a.target.value==="6 months"?s.value=180:a.target.value==="1 year"&&(s.value=360)},$(o).datepicker({format:"dd/mm/yyyy",language:"en",multidate:!1,orientation:"bottom auto"}).datepicker("setDate","now")}var Z=j||[];Z.push(function(){$(document).off("submit"),$("form").on("submit",function(e){return A(this,null,function*(){e.preventDefault();let t=$(this);if(t.attr("id")==="payment-form-block"){let o=R();if(o){let s=t[0][0].value,a=t[0][1].value,i=t[0][2].value,n=t[0][3].value,c=t[0][4].value,r=t[0][5].value;if(s!==""&&a!==""&&i!==""&&n!==""&&c!==""&&c!==0){let l,m=!1;switch(i){case"1 day":l=1,m=!0;break;case"7 days":l=7,m=!0;break;case"21 days":l=21,m=!0;break;case"1 month":l=1;break;case"3 months":l=3;break;case"6 months":l=6;break;case"1 year":l=12;break}let d=n.split("/"),_=new Date(`${d[2]}/${d[1]}/${d[0]} ${new Date().getHours()}:${new Date().getMinutes()}`),u={amount:s,transaction_id:r||null,mode_of_payment:a,membership_plan:i,membership_end_date:m?B(_,l):C(_,l),time:_.getTime(),num_of_tokens:Number(c)||1,gym_id:K},S=yield h(P+g,"POST",u,o);if(S.isFetchOk!==void 0&&!S.isFetchOk){console.error(S.message),t.siblings(".w-form-done").hide().siblings(".w-form-fail").show().text("There was an error trying to add your session. Please refresh your browser and try again.");return}t.siblings(".w-form-done").show().siblings(".w-form-fail").hide(),window.location.reload()}else console.error("Please fill in the required fields"),t.siblings(".w-form-done").hide().siblings(".w-form-fail").show().text("Please fill in the first four fields")}else console.error("No token found"),t.siblings(".w-form-done").hide().siblings(".w-form-fail").show().text("Please fill out all fields")}else if(t.attr("id")==="user-detail-form-block"){let o=R();if(o){let s=document.getElementById("user-detail-gym").value,a=document.getElementById("user-detail-fitness-level").value,i={gym_id:s,level:a},n=yield h(I+g,"POST",i,o);if(n.isFetchOk!==void 0&&!n.isFetchOk){console.error(n.message),t.siblings(".w-form-done").hide().siblings(".w-form-fail").show().text("There was an error trying to add your session. Please refresh your browser and try again.");return}t.hide().siblings(".w-form-done").show().siblings(".w-form-fail").hide(),window.location.reload()}else console.error("No token found"),t.siblings(".w-form-done").hide().siblings(".w-form-fail").show().text("Please fill out all fields")}})})});
